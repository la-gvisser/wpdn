* Decoder version: 5.0.1.1
* 6/22/2007
* registers:
*
* g[0x30] = port number of H.245 Control Channel (retrieved from the H.245 Address field of Q.931), see "void ipAddress;"

*********************************************************************
* PER utility subroutines
*********************************************************************

void PER_Align()
{
	BITO 0 41 0 0;
	
	if( l[1] > 0 )
	{
		INCR 1;
		MOVE 1 a;
	}
	
	TRTS;
}

void PER_ExtBit;
	BBIT 1 c 5  5; //Extension Bit
	*ADDG 1 a;  *track bits with g[a]
	TRTS;

//inputs:
//g[8] = the range of the sequence_of, use PER_SeqLen_Unconstrained if the range is unbounded
//outputs:
//g[8] = the number of items in the sequence_of
//this value does not include any lower_bound offset, the caller must handle that
void PER_SeqLen_Constrained()
{	
	PER_Constrained_Whole_Number;
	TRTS;
}

//outputs:
//g[8] = the number of items in the sequence_of
//this value does not include any lower_bound offset, the caller must handle that
void PER_SeqLen_Unconstrained()
{
	PER_LengthDeterminant;
	TRTS;
}
	
* SP: 09/19/2002 - for unbounded SEQUENCE OF (e.g SEQUENCE OF OCTET STRING for the Q.931 fastStart element)
* the lengh of the sequence can be zero, so in that case we should not add 1 to the length retrieved
void PER_ZeroBased_SetLen;
	PER_Align;
	DBYT  0 8 90 c2 Set Size:;
	TRTS;

void PER_SetLen;
	PER_Align;
	GBYT  0 8;
	ADDG  1 8;
	DGLB  0 8 90 c2 Set Size:;
	DBYT  0 1 5;
	TRTS;

void PER_SetLen2;
	GBYT  0 9;
	ADDG  1 9;
	DGLB  0 9 90 c2 Set Size:;
	DBYT  0 1 5;
	TRTS;

void PER_SetLen3;
	GBYT  0 13;
	ADDG  1 13;
	DGLB  0 13 90 c2 Set Size:;
	DBYT  0 1 5;
	TRTS;

void PER_SetLen_g15;
	GBYT  0 15;
	ADDG  1 15;
	DGLB  0 15 90 c2 Set Size:;
	DBYT  0 1 5;
	TRTS;

//inputs:
//g[8] = range of value (upper_bound - lower_bound + 1), value must be less than 65536
//outputs:
//g[8] = value read from bitstream (does not include lower_bound)
void PER_Constrained_Whole_Number()
{	
	if( g[8] <= 255 )
	{
		l[1] = 0;
		l[3] = 2;
		
		BBIT 1 41 5 5;
		
		while( g[8] > l[3] )
		{
			SHFL 1 41 5 5;
			BBIT 1 42 5 5;
			l[1] |= l[2];
			
			SHFL 1 43 5 5;
		}
		
		g[8] = l[1];
		TRTS;	
	}

	PER_Align;
		
	if( g[8] == 256 )
	{
		DBYT 0 8 5 5;
		TRTS;
	}
	
	if( g[8] <= 65536 )
	{
		DWRD 0 8 5 5;
		TRTS;
	}
	
	g[8] = 0;
}

//the generic version that should be able to handle any size integer
//inputs:
//g[8] = the range of the integer value (upper_bound - lower_bound + 1)
//if the value is unconstrained (no upper bound) set to 0
//outputs:
//g[8] = the value read from the bitstream
//if the value can't fit in g[8] it will be printed out and g[8] will be set to 0xffffffff
void PER_Integer()
{
	if( g[8] > 0 )
	{
		if( g[8] <= 65536 )
		{
			PER_Constrained_Whole_Number;
			TRTS;
		}
		
		//this is a bit confusing.
		//the number of octets used by the integer is stored in a bit string 
		//using the minimum number of bits necessary.
		//In order to figure out how many bits are used we count the number of byte shifts
		//needed to 0 out the range value in g[8]
		//The count now has the number of bits needed to represent the octet length
		//We then bitshift the count until it hits 0, reading one bit each time.
		l[1] = g[8];
		
		SHFR 8 41 5 5;	//the lower_bound of the octet_len is 1 so shift right 8 bits to account for that
		
		l[2] = 0;
		while( l[1] > 0 )
		{
			SHFR 8 41 5 5;
			l[2] += 1;
		}
		
		l[3] = 0;
		l[4] = 1;		
		//now shift right until l[2] is 0 reading one bit each time
		while( l[4] == 1 )
		{
			BBIT 1 41 5 5;
			SHFL 1 43 5 5;
			l[3] |= l[1];
			SHFR 1 42 5 5;
			
			if( l[2] == 0 )
			{
				l[4] = 0;
			}
		}
					
		//l[3] has the number of octets needed to represent the range
		PER_Align;
		
		//read the octets
		
		if( l[3] == 0 )
		{
			//one octet
			DBYT 0 8 5 5;
			TRTS;
		}
		
		if( l[3] == 1 )
		{
			//two octets
			DWRD 0 8 5 5;
			TRTS;
		}
		
		if( l[3] == 2 )
		{
			//three octets
			DBIT 18 8 5 5;
			TRTS;
		}
		
		if( l[3] == 3 )
		{
			//four octets
			DLNG 0 8 5 5;
			TRTS;
		}
		
		//if we make it here we can't fit the value in a register, dump it out
		g[8] = 0xffffffff;
		HEX# 0 43 90 c2 Integer Value:;
		TRTS;
	}
	
	//the unconstrained case
	PER_LengthDeterminant;
	
	if( g[8] == 1 )
	{
		//one octets
		DBYT 0 8 5 5;
		TRTS;
	}
	
	if( g[8] == 2 )
	{
		//two octets
		DWRD 0 8 5 5;
		TRTS;
	}
	
	if( g[8] == 3 )
	{
		//three octets
		DBIT 18 8 5 5;
		TRTS;
	}
	
	if( g[8] == 4 )
	{
		//four octets
		DLNG 0 8 5 5;
		TRTS;
	}
	
	if( g[8] < 128 )
	{
		HEX# 0 8 90 c2 Integer Value:;
		g[8] = 0xffffffff;
		TRTS;
	}
	
	DLNG 0 8 90 c2 Integer Length:;
	DUMP 0 8 90 c2 Integer Value:;
	g[8] = 0xffffffff;
	TRTS;
}

* ::=INTEGER (1..256)
//outputs:
//g[1] = value of the integer
void PER_Integer256()
{
	l[1] = g[8];
	g[8] = 256;	// 256 - 1 + 1
	PER_Integer;
	g[8] += 1;
	DGLB 0 8 90 0;
	
	g[1] = g[8];	//save the value in g[1]
	g[8] = l[1];	//restore the value in g[8]
	TRTS;
}

* ::=INTEGER (1..65535)

//outputs:
//g[1] = value of the integer
void PER_Integer65535()
{
	l[1] = g[8];
	g[8] = 65535;	// 65535 - 1 + 1
	PER_Integer;
	g[8] += 1;
	DGLB 0 8 90 0;
	
	g[1] = g[8];	//save the value in g[1]
	g[8] = l[1];	//restore the value in g[8]
	TRTS;
}
	
* integer from 3 bytes

void PER_Integer3;
	DWRD 0 1 5;
	DBYT 0 2 5;
	MULG 100 1;  * shift g1 by 1 byte
	ADDG 2 81;  * g1 = g2 + g1;
	DGLB 0 1 c0;
	
* SP: For large constrained INTEGER (e.g INTEGER(0..4294967295)), as specified by the ITU X.691 Recommendation
* (PER encoding) section 12.2.2 and 12.2.6, where the integer value is at most 4 bytes long i.e <= 4294967295 

* SP: TBD - Is there a decoder instruction that store an arbitrary number of bytes from the packet stream in a global?
* this would make this routine so much more generic.
void private_PER_LargeConstrainedInteger_g20;
	GBIT 2 21;	* Take the 1st 2 bits, this indicate the number of bytes the integer value takes
	INCR 1;		* the integer value to decode is octet-aligned, so we pass the 2 bits length-determinant + padding bits
	ADDG 1 21;	* the length-determinant is encoded as an offset to one, so we need to add 1
	
	SNEQ 1 21;
	SKIP 3;
		GBYT 0 20 5;	* the length-determinant is 1 i.e the integer value to retrieve is 1 byte long
		INCR 1;
		TRTS;
	
	SNEQ 2 21;
	SKIP 2;
		DWRD 0 20 5;	* the length-determinant is 2 i.e the integer value to retrieve is 2 bytes long
		TRTS;
		
	SNEQ 3 21;
	SKIP 2;
		DBIT 18 20 5; * the length-determinant is 3 i.e the integer value to retrieve is 3 bytes long
		TRTS;
	
	GLNG 0 20 5;	* the length-determinant is 4 i.e the integer value to retrieve is 4 bytes long
	INCR 2;
	TRTS;
	
* SP: For large constrained INTEGER when the lower bound is 0
void PER_LargeConstrainedInteger0_g20;
	private_PER_LargeConstrainedInteger_g20;
	DGLB 0 20 90 5;
	TRTS;
	
* SP: For large constrained INTEGER when the lower bound is 1
void PER_LargeConstrainedInteger1_g20;
	private_PER_LargeConstrainedInteger_g20;
	ADDG 1 20;
	DGLB 0 20 90 5;
	TRTS;
	
* ::=Boolean

void PER_Boolean;
	BBIT 1 1 90 42;
	ADDG 1 a;*track bits and offset for alignment;
	CBIT 0 1 90 14 True;
	CLSE 0 1 90 14 False;
	TRTS;

* ::=Null

void PER_Null;
	*SP: 09/25/2002 - According to the spec (X.691 PER encoding), NULL doesn't consume any bit/octet
	LABL 0 0 0 24 NULL;
	*DBYT 0 1 5 24 NULL;
	*SEQU 1 1;
	*SKIP 80000001;
	*INCR 1;
	TRTS;

void PER_Null_Ext;
	DBYT 0 2 5 24 NULL;

	
* ::=CHOICE

* SP: 09/20/2002 - This routine deal with choice selection in the extension root
* when the extension bit is turned on
* g13 (0xD) = selected choice index [out]
* g23 (0x17) = Extension length (in byte), 0 if the index is not in the extension root [out]
void PER_Choice_ext;
	BBIT 1 17 5; * put the next bit in g23
	ADDG 1 a;  *track bits
	
	SEQU 1 17;
	SKIP 4;
		* SP: here the Normally Small Non Negative Whole Number < 64 (g23 = 0), just grab the next 6 bits
		DBIT 6 D 90 c2 Ext Choice:;
		ADDG 6 a;  *track bits
	
		PER_Align;
	
		DBYT 1 17 5; * SP: length of extension (in bytes)
		TRTS;
	* SP: todo: the case where the index is >= 64

//only use this for unconstrained cases
//see ITU X.691 Section 10.9 for details
//outputs:
//g[8] = length determinant	
void PER_LengthDeterminant()
{
	PER_Align;
	
	GBYT 0 41 5 5;
	
	//length less than 128
	if( l[1] < 0x80 )
	{
		//one octet case
		g[8] = l[1];
		INCR 1;
		TRTS;
	}
	
	//length less than 16384
	if( l[1] < 0xC0 )
	{
		//two octet case
		DWRD 0 8 5 5;
		g[8] &= 0x3fff;	//mask out the top two bits
		TRTS;
	}
	
	//length more than 16383
	l[1] &= 0x07;
	l[1] *= 16384;
	g[8] = l[1];
	TRTS;
}




*********************************************************************
* This section contains decoders for H225 extensions and Q931 UUIEs
* Specification: ITU-T H.225 Version 3
*********************************************************************

*
* NOTE: gi= input globals
*       go= output globals
*       gc= changed globals
*       gu= used globals (should not be changed by called DCod's)
*
*       *gi= go= gc= gu=

void h225_H323_UserInformation;*gi=x go=x gc=a gu=b [root for all Q931 UUIEs]
    LABL    0   0    0  b7  H323 User Information;
	h225_H323_UserInformation2;
    LABL    0   0    0  b8;
	
void h225_H323_UserInformation2;
	MOVE    1   a;          		*track bits and offset for alignment;
	BBIT    1   0   5  5;			//Extension Bit
    BBIT    1   b   5  5;			//Options Bits
	ADDG    2   a;          		*track bits and offset for alignment;

    LABL    0   0   0 b7  H323 UU PDU;
    h225_H323_UU_PDU;
	LABL 0 0 0 b8;

    SEQU    1   b;
    SKIP    2;  
	PER_Align;
    TRTS;

    LABL    0   0   0 b7  User Data;
	BBIT    1   0   5  5;		//Extension Bit
	ADDG    1   a;				*track bits and offset for alignment;
	PER_Align;
    DBYT    0   0   90  c2  Protocol Discriminator:;
    DBYT    0   b   90  c2  User Info Length:;
    ADDG    1   b;				*lb=1;
    CHR#    0   b   90  c2  User Information:;
	LABL 0 0 0 b8;
    TRTS;


void h225_H323_UU_PDU;			*gi=x go=x gc=1,a gu=e,f
	BBIT    1   e   5  5;		//Extension Bit
    BBIT    1   f   5  5;		//Options Bits
	ADDG    2   a;          	*track bits and offset for alignment;
    LABL    0   0   0 b7  H323 Message Body;
    h225_h323_message_body;
	LABL 0 0 0 b8;

	TEQU    0  10    0   0  RETURN;
    SBIT    0   f;
    SKIP    80000003;
    LABL    0   0   90  c7  Non Standard Data;
    NonStandardParameter;
    LABL 0 0 00 c8;

    SBIT    0   e;
    SKIP    1;
    TRTS;						*no extensions;
    
    g[2] = 9;					// si: length
    PER2_Seq_ExtBitMask;
    
    //DBIT    7   e   5  5;		//   Ext Bitmask Length 
    //ADDG    7   a;				*track bits and offset for alignment;
    //TNEQ    3   e   0   0	h225_Unsupported;
    //BBIT    4   f   5  5;		//   Ext Bitmask
    //ADDG    4   a;				*track bits and offset for alignment;
	//PER_Align;

    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  H.450 Supp Service Data:;

    SBIT    1   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  H.245 Tunneling:;
	PER_Boolean;
	PER_Align;

    SBIT    2   c;
    SKIP    80000005;
    PER_ExtLen;		//the number of octets in this message
    LABL 0 0 0 b7 H.245 Controls;
    CEQU 0 1 0 14 0 items;
    h225_Seq_of_h245Control;
    LABL 0 0 0 b8;

    SBIT    3   c;
    SKIP    80000005;
    PER_ExtLen;
    PER_Align;
    LABL 0 0 0 b7 Non Standard Control;
    h225::seq_of_NonStandardParameter;
    LABL 0 0 0 b8;
    
	SBIT	4	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 CallLinkage:;
	
	SBIT	5	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 TunnelledSignallingMsg:;
	
	SBIT	6	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 ProvisionalRespToH245Tunnelling:;
	
	SBIT	7	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 StimulusControl:;
	
	SBIT	8	c;
	SKIP	80000005;
	PER_ExtLen;
	PER_Align;
	LABL 0 0 0 c7 Generic Data;
	h225::seq_of_GenericData;
	LABL 0 0 0 c8;
	
    TRTS;

void h225::seq_of_NonStandardParameter()
{
	PER_ExtLen;	//get the number of parameters
	l[1] = g[1];
	DGLB 0 1 90 c2 Item Count:;
	
	while( l[1] > 0 )
	{
		h225_H323_UU_PDU_nonS_item;
		l[1] -= 1;
	}
}

void h225_Seq_of_h245Control()
{
	PER_ExtLen;		//get the number of items in the sequence of
	l[1] = g[1];	//g[1] should contain the number of items
	DGLB 0 1 90 c2 H.245 Control Count:;
	while( l[1] > 0 )
	{
		//first get the length of the data
		PER_ExtLen;
		LABL 0 0 0 b7 H.245 Control;
		DGLB 0 1 90 c2 Length:;
		H245_tunneled;
		LABL 0 0 0 b8;
		l[1] -= 1;
	}
}

void h225_H323_UU_PDU_nonS_item()
{
	LABL 0 0 0 c9 Item:;
	DBYT 0 42 90 c9 nonStandardIdentifier:;
		CEQU 0 42 0 14 Object;
	l[5] = pl[1];
	ObjectIdentifier_BER;
	INCR 1;
	LABL 0 0 0 c8;
	if (l[5] == 0x60864801)
	{
		h225_H323_CCMS_Message();
		//there can be more tpkts after this one, dont dump the rest of the data.
		LABL 0 0 0 c8;
		
		//but there can be a null at the end, skip it
		l[1] = pb[0];
		
		if( l[1] == 0 )
		{
			INCR 1;
		}
		
		TRTS;
	}
	DUMP 0 1 90 c2 Data:;
	LABL 0 0 0 c8;
}

void h225_h323_message_body;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   1   5  5; //Extension Bit
    SNEQ    0   1;
    SKIP    9;
    DBIT    3   1   90  c2  UUIE Type:;
    ADDG    4   a;          *track bits and offset for alignment;
	PER_Align;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_h323_message_body_list;
	CST#    0   1   0   b7  h225_h323_message_body_list;
    h225_h323_message_body_base;
	LABL 0 0 0 b8;
    TRTS;

    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length

    SNEQ    0   1;
    SKIP    2;    
    h225_Progress_UUIE;
    TRTS;
    CEQU    1   1   90  c2  Empty;
    INCR    0   2   0   0   ext length;
    TRTS;


void h225_h323_message_body_base;*gi=1 go=x gc=x gu=x (g1 = 1 based index)
    SEQU    1   1;
    SKIP    80000002;
    h225_Setup_UUIE;
    TRTS;
    
    SEQU    2   1;
    SKIP    80000002;
    h225_CallProceeding_UUIE;
    TRTS;
    
    SEQU    3   1;
    SKIP    80000002;
    h225_Connect_UUIE;
    TRTS;
    
    SEQU    4   1;
    SKIP    80000002;
    h225_Alerting_UUIE;
    TRTS;
    
    SEQU    5   1;
    SKIP    80000002;
    h225_Information_UUIE;
    TRTS;
    
    SEQU    6   1;
    SKIP    80000002;
    h225_ReleaseComplete_UUIE;
    TRTS;
    
    SEQU    7   1;
    SKIP    80000002;
    h225_Facility_UUIE;
    TRTS;
    
    SEQU    c   1;
    SKIP    80000001;
    h225_SetupAcknowledge_UUIE;
    TRTS;
    
void display_H245_Address;
	LABL    0   0   0 b7  H.245 Address;
    TransportAddress;
	LABL 0 0 0 b8;
	
	* SP: 09/17/2002 - Here we mark the H.245 Control Channel port number (see "void ipAddress;")
	* used by "WHOA  0   2 0 0 H323_Decoders;" in "void TCP::Ports;" of IETF.dcd
	MARK 1 30 0 0 H323_Decoders;

void h225_Alerting_UUIE;*gi=x go=x gc=1,2,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	l[1] = g[0xc];
	BBIT    1   d   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;
	PER_Align;

	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	LABL    0   0   0 b7  Destination Info;
	EndpointType;
	LABL 0 0 0 b8;

    SBIT    0   d;
    SKIP    80000001;
    display_H245_Address;
    *LABL    0   0   0 b7  H.245 Address;
    *TransportAddress;
	*LABL 0 0 0 b8;

    MOVE    d   2;
    PER_Seq_ExtBitMask;

	// test to see if extension bit is set
	if (l[1] == 0)
	{
		TRTS;
	}

 //   SBIT    9   c;
 //   SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;
	
    SBIT    8   c;
    SKIP    80000006;
    PER_ExtLen;
    LABL    0   0   0 b7  H.245 Security Mode;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_H245Security;
	LABL 0 0 0 b8;

    SBIT    7   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    6   c;
    SKIP    80000002;
    PER_ExtLen;
    //ADDG 1 1;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    5   c;
    SKIP    80000002;
    PER_ExtLen;
    H245_FastStart_SEQ_OF_OpenLogicalChannel;    *DUMP    0   1   90  c2  Fast Start Data:;

    SBIT    4   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    3   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	PER_Align;
    
    SBIT    2   c;
    SKIP    80000006;
    PER_ExtLen;
    LABL    0   0   0 b7  Alerting Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    1   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_PresentationIndicator;
	PER_Align;

    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_ScreeningIndicator;

    PER_Align;
    TRTS;

void h225_SetupAcknowledge_UUIE;
	BBIT    1   c   5  5;		//Extension Bit
	ADDG    1   a;				*track bits and offset for alignment;
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;
	TRTS;

void h225_CallProceeding_UUIE;*gi=x go=x gc=1,2,a gu=c
	BBIT    1   41   5  5; //Extension Bit
	BBIT    1   42   5  5; //Options Bits
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	LABL    0   0   90  c2  destinationInfo;
	EndpointType;
    LABL 0 0 0 c8;

    SBIT    0   42;
    SKIP    80000001;
    display_H245_Address;

    MOVE    9   2;
    PER2_Seq_ExtBitMask;

	TEQU    0 10 0 0 RETURN;
    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    1   c;
    SKIP    80000005;
    PER_ExtLen;
    LABL    0   0   90  c2  H.245 Security Mode;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_H245Security;

    SBIT    2   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    3   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   c;
    SKIP    80000002;
    PER_ExtLen;
    H245_FastStart_SEQ_OF_OpenLogicalChannel;    *DUMP    0   1   90  c2  Fast Start Data:;

    SBIT    5   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    6   c;
    SKIP    80000003;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
    
    SBIT	7	c;
    SKIP	80000002;
    PER_ExtLen;
    LABL 0 0 90 c2 Fast Connect Refused;
    
    SBIT	8	c;
    SKIP	80000004;
    PER_ExtLen;
    LABL 0 0 90 c7 Feature Set;
    h225::FeatureSet;
    LABL 0 0 0 c8; 
       
    PER_Align;
    TRTS;


void h225_Connect_UUIE;*gi=x go=x gc=1,2,8,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	BBIT    1   d   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

    SBIT    0   d;
    SKIP    80000001;
    display_H245_Address;
    
	LABL    0   0   0 b7  Destination Info;
	EndpointType;
	LABL 0 0 0 b8;
	
	PER_Align;
	LABL 0 0 90 c7 Conference ID;
	h225::GloballyUniqueID;
	LABL 0 0 0 c8;
	
    MOVE    f   2;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    1   c;
    SKIP    80000005;
    PER_ExtLen;
    LABL    0   0   90  c2  H.245 Security Mode;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_H245Security;

    SBIT    2   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL 0 0 90 c7 Tokens;
    h225::seq_of_ClearToken;
    LABL 0 0 0 c8;

    SBIT    3   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   c;
    SKIP    80000002;
    PER_ExtLen;
    H245_FastStart_SEQ_OF_OpenLogicalChannel;    *DUMP    0   1   90  c2  Fast Start Data:;

    SBIT    5   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    6   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	PER_Align;

    SBIT    7   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Language Data:;

    SBIT    8   c;
    SKIP    80000005;
    PER_ExtLen;
    LABL    0   0   90  c2  Connected Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    9   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_PresentationIndicator;
	PER_Align;

    SBIT    a   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_ScreeningIndicator;

	SBIT	b	c;
	SKIP	80000002;
	PER_ExtLen;
	LABL	0	0	90	c2 Fast Connect Refused;
	
	SBIT	c	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 Service Control Session Data:;
	
	SBIT	d	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP	0	1	90	c2 CallCapacity Data:;
	
	SBIT	e	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL	0	0	90	c7 Feature Set;
	h225::FeatureSet;
	LABL	0	0	0	c8;
	
    PER_Align;
    TRTS;


void h225_Information_UUIE;		*gi=x go=x gc=1,2,a gu=c,d
	BBIT    1   c   5  5;		//Extension Bit
	ADDG    1   a;				*track bits and offset for alignment;
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

    g[2] = 6;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    1   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    2   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  CryptoTokens Data;

    SBIT    3   c;
    SKIP    80000002;
    PER_ExtLen;
    H245_FastStart_SEQ_OF_OpenLogicalChannel;    *DUMP    0   1   90  c2  Fast Start Data:;

    PER_Align;
    TRTS;


void h225_ReleaseComplete_UUIE;*gi=x go=x gc=1,2,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	BBIT    1   d   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;
	PER_Align;

	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

    SBIT    0   d;
    SKIP    80000002;
    LABL    0   0   0	b7  Reason;
    h225_ReleaseCompleteReason;
    LABL	0	0	0	b8;

    MOVE    9   2;
    PER_Seq_ExtBitMask;

	// si: ugh, i don't know if the numbering is wrong... it only works if i 
	//		offset it by 1
    SBIT    9   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    8   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens:;

    SBIT    7   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    6   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Busy Address Data:;

    SBIT    5   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_PresentationIndicator;
	PER_Align;
	
    SBIT    4   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_ScreeningIndicator;
	PER_Align;

	SBIT	3	c;				//?????
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 Call Capacity:;

	SBIT	2	c;				//?????
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 serviceControl:;

    SBIT    1   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  fastStart data;

    PER_Align;
    TRTS;


void h225_Setup_UUIE;*gi=x go=x gc=1,2,8,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	BBIT    7   d   5  5; //Options Bits
	ADDG    8   a;          *track bits and offset for alignment;
	PER_Align;

	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

    SBIT    6   d;
    SKIP    80000001;
    display_H245_Address;

    SBIT    5   d;
    SKIP    80000005;
    LABL    0   0   0 b7  Source Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

	LABL    0   0   0 b7  Source Info;
	EndpointType;
	LABL 0 0 0 b8;

    SBIT    4   d;
    SKIP    80000005;
    LABL    0   0   0 b7  Destination Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    3   d;
    SKIP    80000003;
    LABL    0   0   0 b7  Dest Call Signal Address;
    TransportAddress;
	LABL 0 0 0 b8;

    SBIT    2   d;
    SKIP    80000005;
    LABL    0   0   0 b7  Dest Extra Call Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;


    SBIT    1   d;
    SKIP    80000005;
    LABL    0   0   0 b7  Dest Extra CRV;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length

	SEQ OF h225_CallReferenceValue;
	LABL 0 0 0 b8;

    LABL    0   0   90  c2  Active MC:;
	PER_Boolean;

	PER_Align;
    LABL    0  0   90  c7  Conference ID;
    h225::GloballyUniqueID;
    LABL	0	0	0	c8;

	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Conference Goal:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_conferenceGoal_base;
    ADDG    3   a;          *track bits and offset for alignment;
    SKIP    7;
    GBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   90  c2  Ext Length;
    ADDG    1   1;   
    LABL    0   0   90  c2  Conference Goal:;
    CST#    0   1   0   14  h225_conferenceGoal_ext;
    INCR    0   2   0   0   ext length;

    SBIT    0   d;
    SKIP    80000003;
    LABL    0   0   0 b7  Call Services;
    QseriesOptions;
	LABL 0 0 0 b8;

    LABL    0   0   0 b7  Call Type;
    CallType;
	LABL 0 0 0 b8;

    MOVE    1a  2;
    PER2_Seq_ExtBitMask;

    SNEQ 0 c;
	SKIP 1;
	TRTS;
	
    SBIT    0  c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   0 b7  Source Call Signal Address;
    TransportAddress;
	LABL 0 0 0 b8;

    SBIT    1   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0  0 b7  Remote Extension Address;
    h225_AliasAddress;
	LABL 0 0 0 b8;

    SBIT    2   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    3   c;
    SKIP    80000006;
    PER_ExtLen;
    LABL    0   0   0 b7  H.245 Security Mode;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_H245Security;
	LABL 0 0 0 b8;

    SBIT    4   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c7  Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    5   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    6   c;
    SKIP    80000002;
    PER_ExtLen;
    * SP: 09/18/2002 - 
    H245_FastStart_SEQ_OF_OpenLogicalChannel;	*DUMP    0   1   90  c2  Fast Start Data:;
	
    SBIT    7   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Media Wait For Connect:;
	PER_Boolean;
	PER_Align;

    SBIT    8   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Can Overlap Send:;
	PER_Boolean;
	PER_Align;

    SBIT    9   c;
    SKIP    80000003;
    PER_ExtLen;
    LABL    0   0   90  c2  Endpoint Identifier;
    BMPString;

    SBIT    a   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    b   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	PER_Align;

    SBIT    c   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Connection Parameters Data:;

    SBIT    d   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Language Data:;

    SBIT    e   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_PresentationIndicator;
	PER_Align;

    SBIT    f   c;
    SKIP    80000003;
    PER_ExtLen;
    h225_ScreeningIndicator;
	PER_Align;

    SBIT    10   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP 0 1 90 c2 Service Control Data:;
    
    SBIT	11	c;
    SKIP	80000002;
    PER_ExtLen;
    LABL	0	0	90 c2 Symmetric Operation Required;
    
    SBIT	12	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Call Capacity Data:;
    
    SBIT	13	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Circuit Info Data:;
    
    SBIT	14	c;
    SKIP    80000008;
    PER_ExtLen;
    LABL    0   0   90  c7  Protocol;
	PER_Align;
	l[1] = g[8];
	PER_LengthDeterminant;
	SEQ OF h225_SupportedProtocols;
	g[8] = l[1];
	LABL	0	0	0	c8;
    
    SBIT	15	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Needed Features Data:;
    
    SBIT	16	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Desired Features Data:;

    SBIT	17	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Supported Features Data:;
    
    SBIT	18	c;
    SKIP	80000005;
    PER_ExtLen;
    LABL 0 0 0 b7 Parallel H.245 Control;
    CEQU 0 1 0 14 0 items;
    h225_Seq_of_h245Control;
    LABL 0 0 0 b8;    

    SBIT	19	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP	0	1	90	c2 Additional Source Addresses Data:;
   
    SBIT	1a	c;
    SKIP	80000008;
    PER_ExtLen;
    PER_Align;
    l[1] = g[8];
    g[8] = 31;	//31 - 1 + 1
    PER_Integer;
    g[8] += 1;
    DGLB  0 8 90 c2 Hop Count:;
    g[8] = l[1];
    
	PER_Align;
    TRTS;


void h225_Facility_UUIE;*gi=x go=x gc=1,2,8,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	BBIT    3   d   5  5; //Options Bits
	ADDG    4   a;          *track bits and offset for alignment;
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;


    SBIT    2   d;
    SKIP    80000003;
    LABL    0   0   0 b7  Alternative Address;
    TransportAddress;
	LABL 0 0 0 b8;


    SBIT    1   d;
    SKIP    80000005;
    LABL    0   0   0 b7  Alternative Alias Address;
	PER_Align;
	DBYT    1   8   90  c2  SEQ OF Length;
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;


    SBIT    0   d;
    SKIP    80000004;
	PER_Align;
    LABL    0  0   90  c7  Conference ID;
    h225::GloballyUniqueID;
    LABL	0	0	0	c8;

	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_FacilityReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    SKIP    7;
    DBIT    7   1   90  c2  Choice Ext Index:;
    ADDG    1   1;   
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_FacilityReason_ext;
    INCR    0   2;			* ext length


	//mb: updated to support H.225 ver 5
    MOVE    10   2;	
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000002;
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    1   c;
    SKIP    80000006;
    PER_ExtLen;
    LABL    0   0   0 b7  Dest Extra Call Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;


    SBIT    2   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   0 b7  Remote Extension Address;
    h225_AliasAddress;
	LABL 0 0 0 b8;


    SBIT    3   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c7  Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    4   c;
    SKIP    80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    5   c;
    SKIP    80000006;
    PER_ExtLen;
    LABL    0   0   0 b7  Conferences;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_ConferenceList;
	LABL 0 0 0 b8;

    SBIT    6   c;
    SKIP    80000002;
    PER_ExtLen;
    display_H245_Address;

    SBIT    7   c;
    SKIP    80000002;
    PER_ExtLen;
    H245_FastStart_SEQ_OF_OpenLogicalChannel;

    SBIT    8   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    9   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
    PER_Align;
    
    SBIT	a	c;
    SKIP	80000002;
    PER_ExtLen;
    LABL	0	0	90	c2 Fast Connect Refused;
    
    SBIT	b	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Service Control Session Data:;
    
    SBIT	c	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Circuit Info:;
    
    SBIT	d	c;
    SKIP	80000004;
    PER_ExtLen;
	LABL	0	0	90	c7 Feature Set;
	h225::FeatureSet;
	LABL	0	0	0	c8;
    
    SBIT	e	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Destination Info Data:;
     
    SBIT	f	c;
    SKIP	80000002;
    PER_ExtLen;
    DUMP    0   1   90  c2  Security Mode Data:;
    
    TRTS;


void h225_Progress_UUIE;*gi=x go=x gc=1,2,a gu=c,d
	BBIT    1   c   5  5; //Extension Bit
	BBIT    5   d   5  5; //Options Bits
	ADDG    6   a;          *track bits and offset for alignment;
	PER_Align;
	LABL    0   0   0 b7  Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	LABL    0   0   0 b7  Destination Info;
	EndpointType;
	LABL 0 0 0 b8;

    SBIT    4   d;
    SKIP    80000001;
    display_H245_Address;

    h225_CallIdentifier;

    SBIT    3   d;
    SKIP    80000004;
    LABL    0   0   90  c2  H.245 Security Mode;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_H245Security;

    *xx OPTIONALs require H.235 and H.245

    MOVE    1   2;
    PER_Seq_ExtBitMask;

    SBIT    1   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    0   c;
    SKIP    80000004;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	PER_Align;
	
    PER_Align;
    TRTS;


void h225_ConferenceList;*gi=x go=x gc=a gu=1f
	BBIT    1   0   5  5; //Extension Bit
	BBIT    3   1f  5  5; //Options Bits
	ADDG    4   a;          *track bits and offset for alignment;

    SBIT    2   1f;
    SKIP    80000002;
	PER_Align;
    HEX#    10  0   90  c2  Conference ID:;

    SBIT    1   1f;
    SKIP    80000002;
    LABL    0   0   90  c2  Conference Alias;
    h225_AliasAddress;

    SBIT    0   1f;
    SKIP    80000003;
    LABL    0   0   90  c7  Non Standard Data;
    NonStandardParameter;
    LABL 0 0 00 c8;

    TRTS;

void SEQ OF h225_ConferenceList;*gi=8 go=x gc=8 gu=x
	SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	h225_ConferenceList;
	SEQ OF h225_ConferenceList;
	TRTS;

void SEQ OF ObjectIdentifier_BER() 
{
	PER_Align;
	l[1] = g[8];
	PER_SeqLen_Unconstrained;
	l[2] = g[8];
	g[8] = l[1];
	
	while( l[2] > 0 )
	{
		LABL 0 0 0 c7 Obj Id;
		ObjectIdentifier_BER;
		LABL 0 0 0 c8;
		l[2] -= 1;
	}
	
	TRTS;
}

void h225_GatewayInfo;*gi=x go=x gc=8,a gu=x
	BBIT    1   0   5  5; //Extension Bit
	BBIT    2   41  5  5; //Options Bits
	ADDG    3   a;          *track bits and offset for alignment;

    SBIT    1   41;
    SKIP    80000007;
    LABL    0   0   90  c7  Protocol;
	PER_Align;
	l[1] = g[8];
	PER_LengthDeterminant;
	SEQ OF h225_SupportedProtocols;
	g[8] = l[1];
	LABL	0	0	0	c8;

    SBIT    0   41;
    SKIP    80000003;        *not present
    LABL    0   0   90  c7  Non Standard Data;
    NonStandardParameter;
    LABL	0	0	0	c8;

    TRTS;


void SEQ OF h225_CallReferenceValue;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	while( l[1] > 0 )
	{
		DWRD    0   0   90  c2  Call Reference Value:;
		l[1] -= 1;
	}

	TRTS;


void SEQ OF h225_SupportedProtocols;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	while( l[1] > 0 )
	{
		LABL 0 0 90 c7 SupportedProtocols;
		h225_SupportedProtocols;
		LABL 0 0 0 c8;
		l[1] -= 1;
	}

	TRTS;

void h225_SupportedProtocols;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    6;
    DBIT    4   1   90  c2  Supported Protocols:;
	ADDG    5   a;          *track bits and offset for alignment;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_SupportedProtocols_base_str;
	h225_SupportedProtocols_base;
    TRTS;
    DBIT    7   1   90  c2  Supported Protocols:;
    ADDG    1   1;   
    CST#    0   1   0   14  h225_SupportedProtocols_ext;
	PER_Align;
    PER_ExtLen;
    DUMP    0   1   90  c2  Protocol Data:;
    TRTS;
    

void h225_SupportedProtocols_base;*gi=1 go=x gc=1,8,a gu=1f (g1 = 1 based index)
    SEQU    1   1;
    SKIP    80000002;
    NonStandardParameter;
    TRTS;

    BBIT    1   1f  5  5; //Extension Bit
	BBIT    1   1   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;
    
    SBIT    0   1;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    SNEQ    0   1f;
    SKIP    1;
    TRTS    ;               *no extensions;
    DBIT    7   1f  5  5; //   Ext Bitmask Length 
    ADDG    7   a;          *track bits and offset for alignment;
    SEQU    1   1f;         *v2 ?
    SKIP    80000004;
    BBIT    2   1f  5  5; //   Ext Bitmask
    MULG    2   1f;         *g[1f]<<1;
    ADDG    2   a;          *track bits and offset for alignment;
    SKIP    3;
    TNEQ    2   1f  0   0   h225_Unsupported;
    BBIT    3   1f  5  5; //   Ext Bitmask*v3
    ADDG    3   a;          *track bits and offset for alignment;
	PER_Align;

    SBIT    2   1f;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Data Rates Supported;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_DataRate;

    SBIT    1   1f;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Supported Prefixes;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_SupportedPrefix;

    SBIT    0   1f;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Max Call Capacity:;
    MOVE 0 1;
	PER_LargeInt;

	PER_Align;
    TRTS;


void h225_McuInfo;*gi=x go=x gc=1,a gu=x
	BBIT    1   0   5  5; //Extension Bit
	BBIT    1   1   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;

    SBIT    0   1;
    SKIP    80000002;
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    TRTS;


void h225_TerminalInfo;*gi=x go=x gc=1,a gu=17
	BBIT    1   17  5  5; //Extension Bit
	BBIT    1   1   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;

    SBIT    0   1;
    SKIP    80000002;
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    SNEQ    0   17;
    SKIP    1;
    TRTS    ;               *no extensions;
    DBIT    7   17  5  5; //   Ext Bitmask Length
    TNEQ    0   17  0   0   h225_Unsupported;
    BBIT    1   17  5  5; //   Ext Bitmask*v3
	PER_Align;

    SBIT    0   17;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Set:;
	PER_Boolean;
	PER_Align;

    TRTS;


void h225_GatekeeperInfo;*gi=x go=x gc=1 gu=x
	BBIT    1   0   5  5; //Extension Bit
	BBIT    1   1   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;

    SBIT    0   1;
    SKIP    80000002;
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    TRTS;


void h225_ReleaseCompleteReason;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    4   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_ReleaseCompleteReason_base;
    ADDG    5   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_ReleaseCompleteReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;


void h225_Unsupported;*gi=x go=x gc=x gu=x
    LABL    0   0   90  c2  Unsupported/Invalid H.225 Version;
	PER_Align;
    Dump Data;
    TRTS;

void h225_PresentationIndicator;*gi=x go=x gc=1,a gu=x
	BBIT    1   1   5  5; //Extension Bit
    DBIT    2   1   90  c2  Presentation Indicator:;
    ADDG    3   a;          *track bits and offset for alignment;
    ADDG    1   1;
    CST#    0   1   0   14  h225_PresentationIndicator_list;
    TRTS;

void h225_ScreeningIndicator;*gi=x go=x gc=1,a gu=x
	BBIT    1   1   5  5; //Extension Bit
    DBIT    2   1   90  c2  Screening Indicator:;
    ADDG    3   a;          *track bits and offset for alignment;
    ADDG    1   1;
    CST#    0   1   0   14  h225_ScreeningIndicator_list;
    TRTS;

void h225_FacilityReason;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_FacilityReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_FacilityReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;


void h225_AliasAddress;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    1   1   90  c2  Alias Address:;
    ADDG    1   1;   
    ADDG    2   a;          *track bits and offset for alignment;
	h225_AliasAddress_base;
    TRTS;
    DBIT    7   1   90  c2  Alias Address:;
    ADDG    1   1;   
    h225_AliasAddress_ext;
    TRTS;


void h225_AliasAddress_base;*gi=1 go=x gc=x gu=x (g1 = 1 based index)
    SEQU    1   1;
    SKIP    80000002;
    h225_e164;
    TRTS;
    LABL    0   0   90  c2  H323-ID;
    BMPString8;
    TRTS;
    
void h225_AliasAddress_ext;*gi=1 go=x gc=2 gu=x (g1 = 1 based index)
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    
    SEQU    1   1;
    SKIP    80000004;
    DWRD    0   2   90  c2  URL-ID Length:;
    ADDG    1   2   0   0   ;*lb=1
    CHR#    0   2   90  c2  URL-ID:;
    TRTS;
    
    SEQU    2   1;
    SKIP    80000003;
    LABL    0   0   90  c2  Transport ID;
    TransportAddress;
    TRTS;
    
    SEQU    3   1;
    SKIP    80000004;
    DWRD    0   2   90  c2  Email-ID Length:;
    ADDG    1   2   0   0   ;*lb=1
    CHR#    0   2   90  c2  email-ID;
    TRTS;
    
    DUMP    0   2   90  c2  Extension Data:;
    TRTS;


void h225_e164;*gi=x go=x gc=1,a gu=x
    DBIT    7   1   5  5;
    ADDG    1   1;
    DGLB    0   1   90 c2 E.164 Length:;
    SUBG    1    1;
    ADDG    7   a;          *track bits and offset for alignment;
	PER_Align;

    ADDG    1   1   0   0   ;*lb = 1
    LABL    0   0   90  c2  E.164 Digits          ;
    h225_e164_digits;


void h225_e164_digits;*gi=1 go=x gc=1,2,a gu=x (g1 = no. of digits)
    SNEQ    0   1;
    SKIP    1;
    TRTS;
    SUBG    1   1;
    BBIT    4   2   5   5   ;*invisible
    ADDG    4   a;          *track bits and offset for alignment;
    CEQU    0   2   0   0   #;
    CEQU    1   2   0   0   asterick;
    CEQU    2   2   0   0   ,;
    CEQU    3   2   0   0   0;
    CEQU    4   2   0   0   1;
    CEQU    5   2   0   0   2;
    CEQU    6   2   0   0   3;
    CEQU    7   2   0   0   4;
    CEQU    8   2   0   0   5;
    CEQU    9   2   0   0   6;
    CEQU    a   2   0   0   7;
    CEQU    b   2   0   0   8;
    CEQU    c   2   0   0   9;
    TNXT    0   0   0   0   h225_e164_digits;
    TRTS;


void h225_CallIdentifier;*gi=x go=x gc=2,a gu=x
	BBIT    1   2   5  5; //Extension Bit
    ADDG    1   a;          *track bits and offset for alignment;
	PER_Align;
    LABL 0 0 90 c7 Call Identifier:;
    h225::GloballyUniqueID;
    LABL 0 0 0 c8;
    TRTS;


void h225_DataRate;*gi=x go=x gc=a gu=1e
	BBIT    1   0   5  5; //Extension Bit
	BBIT    2   1e  5  5; //Options Bits
	ADDG    3   a;          *track bits and offset for alignment;

    SBIT    1   1e;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    LABL    0   0   90  c2  Channel Rate:;
    g[1] = 0;
	PER_LargeInt;

    SBIT    0   1e;
    SKIP    80000001;        *not present
    LABL    0   0   90  c2  Channel Multiplier:;
    PER_Integer256;
    TRTS;

void SEQ OF h225_DataRate;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	while( l[1] > 0 )
	{
		LABL 0 0 90 c7 Data Rate;
		h225_DataRate;
		LABL 0 0 0 c8;
		l[1] -= 1;
	}
	TRTS;


void h225_SupportedPrefix;*gi=x go=x gc=1,a gu=x
	BBIT    1   0   5  5; //Extension Bit
	BBIT    1   1   5  5; //Options Bits
	ADDG    2   a;          *track bits and offset for alignment;

    SBIT    1   1;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    LABL    0   0   90  c2  Prefix;
    h225_AliasAddress;

    TRTS;

void SEQ OF h225_SupportedPrefix;*gi=8 go=x gc=8 gu=x
	SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	h225_SupportedPrefix;
	SEQ OF h225_SupportedPrefix;
	TRTS;


void h225_TransportQOS;*gi=x go=x gc=1,2,a gu=x
	BBIT    1   1   5  5; //Extension Bit
	DBIT    2   2   90  c2  Transport QOS:;
	ADDG    3   a;          *track bits and offset for alignment;
    CEQU    0   2   90  14  Endpoint Controlled;
    CEQU    1   2   90  14  Gatekeeper Controlled;
    CEQU    2   2   90  14  No Control;
	TRTS;



void h225_Endpoint;*gi=x go=x gc=8,a gu=18
	BBIT    1   0   5  5; //Extension Bit
    BBIT    a   18  5  5; //Options Bits
	ADDG    b   a;          *track bits and offset for alignment;

    SBIT    9   18;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

    SBIT    8   18;
    SKIP    80000004;        *not present
    LABL    0   0   90  c2  Alias Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    7   18;
    SKIP    80000004;        *not present
    LABL    0   0   90  c2  Call Signal Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;

    SBIT    6   18;
    SKIP    80000005;        *not present
    LABL    0   0   90  c9  RAS Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;
	LABL	0	0	00	c8;

    SBIT    5   18;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Endpoint Type;
	EndpointType;

    *xx tokens and cryptoTokens OPTIONALs require H.235 and H.245
    
    SBIT    2   18;
    SKIP    80000001;        *not present
    DBIT    7   0   90  c2  Priority:;

    SBIT    1   18;
    SKIP    80000004;        *not present
    LABL    0   0   90  c2  Remote Extension Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    0   18;
    SKIP    80000004;        *not present
    LABL    0   0   90  c2  Dest Extra Call Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    TRTS;


void SEQ OF h225_Endpoint;*gi=8 go=x gc=8 gu=x
	SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	h225_Endpoint;
	SEQ OF h225_Endpoint;
	TRTS;


void h225_PartyNumber;*gi=x go=x gc=1,a gu=x
	BBIT    1   0   5  5; //Extension Bit
    DBIT    3   1   90  c2  Party Number:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_PartyNumber_str;
    ADDG    4   a;          *track bits and offset for alignment;

    SNEQ    1   1;
    SKIP    2;
    h225_PublicPartyNumber;
    TRTS;

    SNEQ    4   1;
    SKIP    2;
    h225_PrivatePartyNumber;
    TRTS;

    * rest of the choices are e164 numbers

    h225_e164;
    TRTS;


void h225_PublicPartyNumber;*gi=x go=x gc=1,a gu=x
    LABL    0   0   90  c2  Public Party Number;
	BBIT    1   0   5  5; //Extension Bit
    DBIT    3   1   90  c2  Public Type Of Number:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_PublicTypeOfNumber;
    ADDG    4   a;          *track bits and offset for alignment;
    LABL    0   0   90  c2  Public Number Digits;
    h225_e164;
    TRTS;
    

void h225_PrivatePartyNumber;*gi=x go=x gc=1,a gu=x
    LABL    0   0   90  c2  Private Party Number;
	BBIT    1   0   5  5; //Extension Bit
    DBIT    3   1   90  c2  Private Type Of Number:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_PrivateTypeOfNumber;
    ADDG    4   a;          *track bits and offset for alignment;
    LABL    0   0   90  c2  Private Number Digits;
    h225_e164;
    TRTS;


void SEQ OF h225_AlternateGK;*gi=8 go=x gc=8 gu=x
	while( g[8] > 0 )
	{	
		LABL 0 0 90 c7 AlternateGK;
		h225_AlternateGK;
		LABL 0 0 0 c8;
		g[8] -= 1;
	}
	TRTS;


void h225_AlternateGK;*gi=x go=x gc=a gu=1b
	BBIT    1   0   5  5; //Extension Bit
	BBIT    1   41  5	5; //Option bits
    ADDG    2   a;          *track bits and offset for alignment;

    LABL    0   0   90  c7  RAS Address;
    TransportAddress;
	LABL    0   0   00  c8;

    SBIT    0   41;
    SKIP    80000003;        *not present 
	LABL    0   0   90  c7  Gatekeeper Identifier;
	BMPString;
	LABL	0	0	0	c8;

    LABL    0   0   90  c2  Need To Register:;
	PER_Boolean;
    
    DBIT    7   0   90  c2  Priority:;

    ADDG    7   a;          *track bits and offset for alignment;
    TRTS;

void h225_AltGKInfo;*gi=x go=x gc=8,a gu=x
	BBIT    1   0   5  5; //Extension Bit
    ADDG    1   a;          *track bits and offset for alignment;

    LABL    0   0   90  c2  Alternate Gatekeeper;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_AlternateGK;

    LABL    0   0   90  c2  Alt GK Is Permanent:;
	PER_Boolean;
    TRTS;


void h225_SecurityServiceMode;*gi=x go=x gc=1,a gu=x
	BBIT    1   0   5  5; //Extension Bit
    DBIT    2   1   90  c2  Security Service Mode:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_SecurityServiceMode_list;
    ADDG    3   a;          *track bits and offset for alignment;

    SNEQ    1   1;
    SKIP    1;
    NonStandardParameter;

    TRTS;


void h225_SecurityCapabilities;*gi=x go=x gc=1,1a gu=x
	BBIT    1   0   5  5; //Extension Bit
	BBIT    1   1   90  c2  Options Bit:;
    ADDG    2   a;          *track bits and offset for alignment;

    SNEQ    1   1;
    SKIP    1;
    NonStandardParameter;

    LABL    0   0   90  c7  Encryption;
    h225_SecurityServiceMode;
    LABL 0 0 00 c8;

    LABL    0   0   90  c7  Authenticaton;
    h225_SecurityServiceMode;
    LABL 0 0 00 c8;

    LABL    0   0   90  c7  Integrity;
    h225_SecurityServiceMode;
    LABL 0 0 00 c8;


void h225_H245Security;*gi=x go=x gc=1,a gu=x
	BBIT    1   0   5  5; //Extension Bit
    DBIT    2   1   90  c2  H245 Security:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_H245Security_list;
    ADDG    3   a;          *track bits and offset for alignment;

    SNEQ    1   1;
    SKIP    2;
    NonStandardParameter;
    TRTS;
    
    SNEQ    2   1;
    SKIP    1;              *null
    TRTS;

    h225_SecurityCapabilities;
    TRTS;

void SEQ OF h225_H245Security;*gi=8 go=x gc=8 gu=x
	SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	h225_H245Security;
	SEQ OF h225_H245Security;
	TRTS;


void h225_preGrantedARQ;*gi=x go=x gc=2,a,1f gu=1f
    MOVE    c   9f  0   0   ;*save g[c]->g[1f];
	BBIT    1   c   5  5; //Extension Bit
	ADDG    1   a;          *track bits and offset for alignment;

    LABL    0   0   90  c2  Make Call:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Use GKCSA To Make Call:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Answer Call:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Use GKCSA To Answer:;
	PER_Boolean;
    
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DWRD    0   0   90  c2  IRR Frequency In Call:;

    SBIT    1   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Total Bandwidth Restr:;
    MOVE 0 1;
	PER_LargeInt;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Use Annex E Call Sig:;
	PER_Boolean;
	PER_Align;

    MOVE    1f  8c  0   0   ;*restore g[1f]->g[c]
  	TRTS;


void h225_UUIEsRequested;*gi=x go=x gc=a gu=x
	BBIT    1   41   5  5;   //Extension Bit;

    LABL    0   0   90  c2  Setup:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Call Proceeding:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Connect:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Alerting:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Information:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Release Complete:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Facility:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Progress:;
	PER_Boolean;
    
    LABL    0   0   90  c2  Empty:;
	PER_Boolean;
    
    if( l[1] == 1 )
    {
		l[2] = g[12];	//PER2_Seq_ExtBitMask overwrites g[12], save it so we can restore later
		MOVE	4	2;
		PER2_Seq_ExtBitMask;

		SBIT    0   c;
		SKIP    80000004;        *not present
		PER_ExtLen;
		LABL    0   0   90  c2  Status;
		PER_Boolean;
		PER_Align;

		SBIT    1   c;
		SKIP    80000004;        *not present
		PER_ExtLen;
		LABL    0   0   90  c2  Status Inquiry;
		PER_Boolean;
		PER_Align;

		SBIT    2   c;
		SKIP    80000004;        *not present
		PER_ExtLen;
		LABL    0   0   90  c2  Setup Acknolwdge;
		PER_Boolean;
		PER_Align;

		SBIT    3   c;
		SKIP    80000004;        *not present
		PER_ExtLen;
		LABL    0   0   90  c2  notify;
		PER_Boolean;
		PER_Align;
		
		g[12] = l[2];
	}

	TRTS;


void SEQ OF h225_perCallInfo;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	while( l[1] > 0 )
	{
		LABL 0 0 90 c7 Per Call Info;
		h225_perCallInfo;
		LABL 0 0 0 c8;
		l[1] -= 1;
	}

	TRTS;

void h225_perCallInfo;*gi=x go=x gc=1,8,a gu=15,16
	BBIT    1   15  5  5; //Extension Bit
	BBIT    5   16  5  5; //Options Bits
	ADDG    6   a;          *track bits and offset for alignment;

    SBIT    4   16;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Non Standard Data;
    NonStandardParameter;

	PER_Align;
	l[1] = g[8];
	g[8] = 65536;	//65535 - 0 + 1
	PER_Integer;
	DGLB    0   8   90  c2  Call Reference Value:;
	g[8] = l[1];

	PER_Align;
    LABL    0  0   90  c7  Conference ID;
    h225::GloballyUniqueID;
    LABL	0	0	0	c8;

    SBIT    3   16;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Originator:;
	PER_Boolean;

    SBIT    2   16;
    SKIP    80000005;        *not present
    LABL    0   0   0  c7  Audio;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_RTPSession;
	LABL	0	0	0	c8;

    SBIT    1   16;
    SKIP    80000005;        *not present
    LABL    0   0   0  c7  Video;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_RTPSession;
	LABL	0	0	0	c8;

    SBIT    0   16;
    SKIP    80000005;        *not present
    LABL    0   0   90  c7  Data;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_TransportChannelInfo;
	LABL	0	0	0	c8;

    LABL    0   0   90  c2  H.245;
	h225_TransportChannelInfo;

    LABL    0   0   90  c2  Call Signaling;
	h225_TransportChannelInfo;

	LABL    0   0   0	c9  Call Type;
	CallType;
	LABL	0	0	0	c8;

    LABL    0   0   90  c2  Bandwidth:;
    MOVE 0 1;
	PER_LargeInt;

	LABL    0   0   0	c9  Call Model;
	CallModel;
	LABL	0	0	0	c8;

	//save some globals
	l[1] = g[1];
	l[2] = g[2];
	l[3] = g[3];
	l[12] = g[12];
	
	g[12] = g[21];
	g[2] = 7;
	PER_Seq_ExtBitMask;
	
	//at this point g[c] should have the bitmask
	//restore the globals
	g[21] = g[12];
	g[1] = l[1];
	g[2] = l[2];
	g[3] = l[3];
	g[12] = l[12];
	
    SBIT    7   15;
    SKIP    80000002;        *not present
    PER_ExtLen;
    h225_CallIdentifier;
	
    SBIT    6   15;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    5   15;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   15;
    SKIP    80000006;        *not present
    PER_ExtLen;
    LABL    0   0   0	c9  Substitute Conf IDs;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	if( g[8] == 0 )
	{
		LABL 0 0 0 14 0 items;
	}
	SEQ OF h225_ConferenceIdentifier;
	LABL	0	0	0	c8;

    SBIT    3   15;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  PDU Data:;

	SBIT	2	15;
	SKIP	80000002;
	PER_ExtLen;
	DUMP	0	1	90	c2 Call Linkage:;
	
	SBIT	1	15;
	SKIP	80000004;
	PER_ExtLen;
	LABL 0 0 0 c9 Usage Information;
	h225_RASUsageInformation;
	LABL 0 0 0 c8;
	
	SBIT	0	15;
	SKIP	80000002;
	PER_ExtLen;
	DUMP	0	1	90	c2 Circuit Info:;

void h225_RASUsageInformation()
{
	BBIT 1 41 5 5;	//extension bit
	BBIT 3 42 5 5;	//optional items bitfield
	
	//sequence of nonstandardparameters
	l[3] = g[8];
	PER_SeqLen_Unconstrained;
	l[4] = g[8];
	g[8] = l[3];
	
	LABL	0	0	90	c7 NonStandardUsageTypes;

	if( l[4] == 0 )
	{
		//if this item has no data let the user know
		LABL 0 0 0 14 0 items;
	}

	while( l[4] > 0 )
	{
		LABL 0 0 0 c7 Non Standard Parameter;
		NonStandardParameter;
		LABL 0 0 0 c8;
		
		l[4] -= 1;
	}
	
	LABL	0	0	0	c8;

	SBIT 2 42;
	SKIP 80000002;
	LABL 0 0 90 c2 Alerting Time:;
	h235_TimeStamp;
	
	SBIT 1 42;
	SKIP 80000002;
	LABL 0 0 90 c2 Connect Time:;
	h235_TimeStamp;
	
	SBIT 0 42;
	SKIP 80000002;
	LABL 0 0 90 c2 End Time:;
	h235_TimeStamp;
	
}

void h235_TimeStamp()
{
	l[1] = g[8];
	g[8] = 4294967295;
	PER_Integer;
	DGLB 0 8 90 42;
	g[8] = l[1];
	LABL 0 0 0 14 seconds since 1/1/1970;
}

void SEQ OF h225_ConferenceIdentifier;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	while( l[1] > 0 )
	{
		LABL 0 0 90 c7 Conference ID;
		h225_ConferenceIdentifier;
		LABL 0 0 0 c8;
		l[1] -= 1;
	}

	TRTS;

void h225_ConferenceIdentifier;*gi=x go=x gc=x gu=x
    LABL   10  0   90  c2  Conference ID:;
    h225::GloballyUniqueID;
  	TRTS;


void SEQ OF h225_TransportChannelInfo;*gi=8 go=x gc=8 gu=x
	SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	h225_TransportChannelInfo;
	SEQ OF h225_TransportChannelInfo;
	TRTS;

void h225_TransportChannelInfo;*gi=x go=x gc=x gu=1a
	BBIT    1   0   5  5; //Extension Bit
	BBIT    2   1a  5  5; //Options Bits
	ADDG    3   a;          *track bits and offset for alignment;

    SBIT    1   1a;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Send Address;
    TransportAddress;

    SBIT    0   1a;
    SKIP    80000002;        *not present
    LABL    0   0   90  c2  Recv Address;
    TransportAddress;

	TRTS;

void h225::seq_of_ServiceControlSession()
{
	l[1] = g[8];
	PER_SeqLen_Unconstrained;
	l[2] = g[8];
	
	while( l[2] > 0 )
	{
		LABL 0 0 90 c7 Service Control Session;
		h225::ServiceControlSession;
		LABL 0 0 0 c8;
		l[2] -= 1;
	}
	
	g[8] = l[1];
}

void h225::ServiceControlSession()
{
	BBIT 1 41 5 5;	//ext bit
	BBIT 1 42 5 5;	//option bits
	
	l[1] = g[8];
	g[8] = 256;	//255 - 0 + 1
	PER_Integer;
	DGLB 0 8 90 c2 sessionId:;
	g[8] = l[1];
	
	if( l[2] == 1 )
	{
		h225::ServiceControlDescriptor;
	}
	
	h225::ServiceControlSession_Choice;
	TRTS;
}

void h225::ServiceControlSession_Choice()
{
	BBIT 1 41 5 5;	//ext bit
	
	if( l[1] == 0 )
	{
		BBIT 2 42 5 5;
		DGLB 0 2 90 c2 reason:;
		CEQU 0 42 0 14 open;
		CEQU 1 42 0 14 refresh;
		CEQU 2 42 0 14 close;
	}
	
	TRTS;
}

void h225::ServiceControlDescriptor()
{
	BBIT 1 41 5 5;	//ext bit
	
	if( l[1] == 0 )
	{
		BBIT 2 42 5 5;	
		CST# 0 42 0 c7 h225::ServiceControlDescriptor_str;
		TSB# 0 42 0 0 h225::ServiceControlDescriptor_Funcs;
		SKIP;
			l[3] = g[8];
			g[8] = 513;	//512 - 0 + 1
			PER_Integer;
			if( g[8] <= 512 )
			{
				CHR# 0 8 90 c2 url:;
			}

			g[8] = l[3];
		ENDS;
		
		if( l[2] != 0 )
		{
			LABL 0 0 0 c8;
		}	
	}
}

str# h225::ServiceControlDescriptor_str;
	1	|	Signal;
	2	|	NonStandard;
	3	|	Call Credit Service Control;

str# h225::ServiceControlDescriptor_Funcs;
	1	|	h225::H248SignalsDescriptor;
	2	|	NonStandardParameter;
	3	|	h225::CallCreditServiceControl;

void h225::H248SignalsDescriptor()
{
	l[1] = g[8];
	g[8] = 0;	//unconstrained
	PER_LengthDeterminant;
	DUMP 0 8 90 c2 H248SignalsDescritor Data:;
	g[8] = l[1];
}

void h225::CallCreditServiceControl()
{
	BBIT 1 41 5 5;	//ext bit
	BBIT 5 42 5 5;	//option bits
	
	SBIT	4	42;
	SKIP	80000003;
	LABL	0	0	90	c7	Amount;
	BMPString;
	LABL	0	0	0	c8;
	
	SBIT	3	42;
	SKIP	80000005;
	BBIT 1 43 5 5;	//ext bit
	BBIT 1 44 5 5;
	DGLB 0 44 90 c2 Billing Mode:;
	CEQU 0 44 0 14 credit;
	CEQU 1 44 0 14 debit;
	
	SBIT	2	42;
	SKIP	80000006;
	l[3] = g[8];
	g[8] = 4294967295;	//4294967295 - 1 + 1
	PER_Integer;
	DGLB 0 8 90 c2 Call Duration Limit:;
	LABL	0	0	0	14 seconds;
	g[8] = l[3];
	
	SBIT	1	42;
	SKIP	80000002;
	LABL 0 0 90 c2 Enforce Call Duration Limit:;
	PER_Boolean;
	
	SBIT	0	42;
	SKIP	80000005;
	BBIT 1 43 5 5;	//ext bit
	BBIT 1 44 5 5;
	DGLB 0 44 90 c2 Call Starting Point:;
	CEQU 0 44 0 14 alerting;
	CEQU 1 44 0 14 connect;
	
}
		
void SEQ OF h225_RTPSession;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	if( l[1] == 0 )
	{
		LABL	0	0	0	14	0 items;
		TRTS;
	}
	
	while( l[1] > 0 )
	{
		LABL	0	0	90	c7 RTP Session;
		h225_RTPSession;
		LABL	0	0	0	c8;
		l[1] -= 1;
	}

	TRTS;

void h225_RTPSession;*gi=x go=x gc=1,8,a gu=x
	BBIT    1   41   5  5; //Extension Bit
    
    LABL    0   0   90  c2  RTP Address;
    h225_TransportChannelInfo;
    
    LABL    0   0   90  c2  RTCP Address;
    h225_TransportChannelInfo;

	PER_Align;
    DBYT    0   1   90  c2  CNAME Length:;
    CHR#    0   1   90  c2  CNAME:;

    LABL    0   0   90  c2  SSRC:;
    MOVE 1 1;
	PER_LargeInt;

	l[2] = g[8];
	g[8] = 255;	//255 - 1 + 1
	PER_Integer;
	g[8] += 1;
    DGLB    0   8   90  c2  Session Id:;
    g[8] = l[2];
    

    LABL    0   0   90  c7  Associated Session Ids;
	l[2] = g[8];
	PER_SeqLen_Unconstrained;
	SEQ OF h225_associatedSessionIds;
	g[8] = l[2];
	LABL	0	0	0	c8;

	if( l[1] == 0 )
	{
		TRTS;
	}
	
	MOVE 2 2;
	PER2_Seq_ExtBitMask;
	
	SBIT	0	c;
	SKIP	80000006;
	PER_ExtLen;
	LABL	0	0	90	c2 Multicast;
	SNEQ	0	1;
	SKIP;
		INCR 0 1;
	ENDS;
	
	SBIT	1	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL	0	0	90	c2 Bandwidth:;
	g[1] = 0;
	PER_LargeInt;
	
	TRTS;

void SEQ OF h225_associatedSessionIds;*gi=8 go=x gc=8 gu=x
	l[1] = g[8];
	
	if( l[1] == 0 )
	{
		LABL	0	0	0	14	0 items;
		TRTS;
	}
	
	while( l[1] > 0 )
	{
		l[2] = g[8];
		g[8] = 255;	//255 - 1 + 1
		PER_Integer;
		g[8] += 1;
		DGLB 0 8 90 c2 Session Id:;
		g[8] = l[2];
		l[1] -= 1;
	}
	
	TRTS;

str# h225_GatekeeperRejectReason_base;
    Resource Unavailable;
    Terminal Excluded;
    Invalid Revision;
    Undefined Reason;

str# h225_GatekeeperRejectReason_ext;
    Security Denial;

str# h225_RegistrationRejectReason_base;
    Discovery Required;
    Invalid Revision;
    Invalid Call Signal Address;
    Invalid RAS Address;
    Duplicate Alias;
    Invalid Terminal Type;
    Undefined Reason;
    Transport Not Supported;

str# h225_RegistrationRejectReason_ext;
    Transport QOS Not Supported;
    Resource Unavailable;
    Invalid Alias;
    Security Denial;
    Full Registration Required;

str# h225_UnregRequestReason_base;
    Re-registration Required;
    TTL Expired;
    Security Denial;
    Undefined Reason;

str# h225_UnregRejectReason_base;
    Not Currently Registered;
    Call In Progress;
    Undefined Reason;

str# h225_UnregRejectReason_ext;
    Permission Denied;
    Security Denial;

str# h225_TransportQOS_base;
    Endpoint Controlled;
    Gatekeeper Controlled;
    No Control;

str# h225_AdmissionRejectReason_base;
    Called Party Not Registered;
    Invalid Permission;
    Request Denied;
    Undefined Reason;
    Caller Not Registered;
    Route Call To Gatekeeper;
    Invalid Endpoint Identifier;
    Resource Unavailable;

str# h225_AdmissionRejectReason_ext;
    Security Denial;
    QoS Control Not Supported;
    Incomplete Address;
    Route Call To SCN;
    Aliases Inconsistent;
    Call Capacity Exceeded;

str# h225_BandRejectReason_base;
    Not Bound;
    Invalid Conference ID;
    Invalid Permission;
    Insufficient Resources;
    Invalid Revision;
    Undefined Reason;

str# h225_BandRejectReason_ext;
    Security Denial;

str# h225_LocationRejectReason_base;
    Not Registered;
    Invalid Permission;
    Request Denied;
    Undefined Reason;

str# h225_LocationRejectReason_ext;
    Security Denial;
    Route Call To SCN;
    Aliases Inconsistent;

str# h225_DisengageReason_base;
    Forced Drop;
    Normal Drop;
    Undefined Reason;

str# h225_DisengageRejectReason_base;
    Not Registered;
    Request To Drop Other;

str# h225_DisengageRejectReason_ext;
    Security Denial;

str# h225_InfoRequestNakReason_base;
    Not Registered;
    Security Denial;
    Undefined Reason;

str# h225_PresentationIndicator_list;
    Presentation Allowed;
    Presentation Restricted;
    Address Not Available;

str# h225_ScreeningIndicator_list;
    User Provided Not Screened;
    User Provided Verified And Passed;
    User Provided Verified And Failed;
    Network Provided;

str# h225_h323_message_body_list;
    1	| Setup-UUIE;
    2	| CallProceeding-UUIE;
    3	| Connect-UUIE;
    4	| Alerting-UUIE;
    5	| Information-UUIE;
    6	| ReleaseComplete-UUIE;
    7	| Facility-UUIE;
    12	| SetupAcknowledge-UUIE;

str# h225_ReleaseCompleteReason_base;
	No Bandwidth;
	Gatekeeper Resources;
	Unreachable Destination;
	Destination Rejection;
	Invalid Revision;
	No Permission;
	Unreachable Gatekeeper;
	Gateway Resources;
	BadFormat Address;
	Adaptive Busy;
	In Conf;
	Undefined Reason;

str# h225_ReleaseCompleteReason_ext;
    Facility Call Deflection;
    Security Denied;
    called Party Not Registered;
    Caller Not Registered;
    New Connection Needed;
    Non Standard Reason;
    Replace With Conference Invite;

str# h225_SupportedProtocols_base_str;
    Non Standard Data;
    H.310;
    H.320;
    H.321;
    H.322;
    H.323;
    H.324;
    Voice;
    T.120 Only;

str# h225_SupportedProtocols_ext;
    Non Standard Protocol;
    T.38 Fax Annex B Only;

str# h225_conferenceGoal_base;
    Create;
    Join;
    Invite;

str# h225_conferenceGoal_ext;
    Capability Negotiation;
    Call Independent Supplementary Service;

str# h225_FacilityReason_base;
    Route Call To Gatekeeper;
    Call Forwarded;
    Route Call To MC;
    Undefined Reason;

str# h225_FacilityReason_ext;
    Conference List Choice;
    Start H.245;
    No H.245;

str# h225_PartyNumber_str;
    Public Number;
    Data Party Number;
    Telex Party Number;
    Private Number;
    National Standard Party Number;

str# h225_PublicTypeOfNumber;
    Unknown;
    International Number;
    National Number;
    Network Specific Number;
    Subscriber Number;
    Abbreviated Number;

str# h225_PrivateTypeOfNumber;
    Unknown;
    Level 2 Regional Number;
    Level 1 Regional Number;
    PISN Specific Number;
    Local Number;
    Abbreviated Number;

str# h225_H245Security_list;
    Non Standard;
    No Security;
    TLS;
    IPSec;

str# h225_SecurityServiceMode_list;
    Non Standard;
    None;
    Default;


*********************************************************************
* Rest of dcod's are ASN PER utility decodes.
* Specification: X.691
*********************************************************************

void PER_ExtLen;*gi=x go=1 gc=1,a gu=x
	PER_Align;
    GBIT    1   1;
    SEQU    1   1;			*msb == 1 ?;
    SKIP    3;
    *DBYT    0   1   5  5; //   Ext Length
	GBYT 0 1;
	INCR 1;
    TRTS;
    BBIT    2   0   5   5;  *invisible;
    DBIT    e   1   5   5;   *invisible;
    *DBIT    e   1   5  5; //   Ext Length
    TRTS;


void PER_Seq_ExtBitMask;*gi=2,c go=c gc=1,2,3,a gu=x (*g[c]=extpres(in)/bitmask(out)  g2=numexp(in) g1/g3=scratch)
    SNEQ    0   c;			*Extensions;
    SKIP    1;				*none;
    TRTS;					*no extensions;

    MOVE    0   c;			*initialize;
    DBIT    7   1   05 05 bitmasklen:;	*Ext Bitmask Length
    ADDG    7   a;          *track bits and offset for alignment;
    SUBG    1   82;			*difference;
    SLTE    0   2;			*numfound < numexp;
    SKIP    2;
    h225_Unsupported;
    TRTS;

    * get bits
    ADDG    1   1;			*lb=1;
	ADDG    1   8a;			*track bits and offset for alignment;
    //LABL    0   0   5  5; //   Ext Bitmask
    //LABL    0   0   90  50  %;
    PER_ext1;

    SEQU    0   2;			*difference == 0 ?;
    SKIP    1;

    * add extra bits if necessary
    PER_ext2;

	PER_Align;
    TRTS;

void PER_ext1;*gi=1,c go=c gc=1,3 gu=x [g1=count(in), g[c]=bitmask, g[3]=scratch]
    SNEQ    0   1;
    SKIP    1;
    TRTS;
    DBIT    1   3   5  5;
    MULG    2   c           ;*gc<<1;
    ORRG    3   8c          ;*gc |= g3;
    SUBG    1   1           ;*g1--;
    TNXT    -PER_ext1;

void PER_ext2;*gi=2,c go=c gc=2 gu=x [g2=count(in) g[c]=bitmask]
    SNEQ    0   2;			*done ?;
    SKIP    1;
    TRTS;
    MULG    2   c;			*<<1;
    SUBG    1   2;			*g2--;
    TNXT    -PER_ext2;


//gi=2,c go=c gc=1,2,3,a gu=x (*g[c]=extpres(in)/bitmask(out)  g2=numexp(in) g1/g3=scratch)
void PER2_Seq_ExtBitMask;
	l[2] = g[2];
    SNEQ    0   c;			*Extensions;
    SKIP    1;				*none;
    TRTS;					*no extensions;

    MOVE    0   c;			*initialize;
    DBIT    7   1   5  5;	*Ext Bitmask Length
    ADDG    7   a;          *track bits and offset for alignment;
    SUBG    1   82;			*difference;
    //SLTE    0   2;			*numfound < numexp;
    //SKIP    2;
    //h225_Unsupported;
    //TRTS;
	
    * get bits
    ADDG    1   1;			*lb=1;
	ADDG    1   8a;			*track bits and offset for alignment;

    PER2_ext1;

    SGTE	0	2;
    //SEQU    0   2;			*difference == 0 ?;
    SKIP    1;

    * add extra bits if necessary
    PER2_ext2;

	PER_Align;
	SHFR	1	c;			// si: account for the uncond SHFL's in per2_ext1 & per2_ext2. [there will be one extra]
	
    // si: bit reversal
	g[2] = l[2];			// si: re-enter the length
	PER_BitReverse;			// si: value is in g[0xc]
    TRTS;

//gi=1,c go=c gc=1,3 gu=x [g1=count(in), g[c]=bitmask, g[3]=scratch]
void PER2_ext1()
{
	while (g[1] > 0)
	{
		DBIT 1 3 5 5;
		SHFL 1 c;		//MULG    2   c           ;*gc<<1;
		ORRG 3 8c;		//gc |= g3;
		g[1] -= 1;		//SUBG    1   1           ;*g1--;
    }
}

//gi=2,c go=c gc=2 gu=x [g2=count(in) g[c]=bitmask]
void PER2_ext2()
{
	while (g[2] > 0)
	{
		SHFL 1 c;		//MULG    2   c;			*<<1;
		g[2] -= 1;		//SUBG    1   2;			*g2--;
    }
}

//inputs:
//g[1] = lower_bound of integer
//outputs:
//g[1] = value of integer
void PER_LargeInt() *gi=1 go=x gc=1,a gu=x (g[1]..4294967295)
{
	l[1] = g[8];
	g[8] = 4294967296;	//4294967295 - 0 + 1
	PER_Integer;
	g[8] += g[1];
	DGLB    0  8   90  5;
	g[1] = g[8];
	g[8] = l[1];
}


*********************************************************************
* This section contains decoders for various RTP Payloads
*********************************************************************

*
* NOTE: gi= input globals (x if none)
*       go= output globals
*       gc= changed globals
*

*--------------------------------------------------------------------
* Q850 Call rejected diagnostic decoder
* Specification: ITU-T Q.850
*--------------------------------------------------------------------
void Q850 Cause Reject; *gi=6,10 go=x gc=6,a,b,10
    BBIT    8   a   b0  c2  Call Rejected Diagnostics:;
    CBIT    7   a   0   d4  1... .... Extension Bit: On;
    CLSE    7   a   0   d4  0... .... Extension Bit: Off;
    MOVE    a   8b;
    DIVG    4   b;
    ANDG    1f  b;
    CEQU    0   b   0   d4  .000 00.. Rejection Reason:	User Specific;
    CEQU    1   b   0   d4  .000 01.. Rejection Reason:	IE Missing;
    CEQU    2   b   0   d4  .000 10.. Rejection Reason:	IE Contents Not Sufficient;
	CLTE    3   b   0   d4  .xxx xx.. Rejection Reason: Reserved;
    MOVE    a   8b;
    ANDG    3   b;
    CEQU    0   b   0   d4  .... ..00 Q850 Condition: Unknown;
    CEQU    1   b   0   d4  .... ..01 Q850 Condition: Permanent;
    CEQU    3   b   0   d4  .... ..11 Q850 Condition: Transient;
	CLSE    0   0   0   d4  .... ..10 Q850 Condition: Reserved;
    SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;
	DUMP    0   6   b0  c2  User Diagnostics:;
	TNXT    -Q931 Info Elem;

*--------------------------------------------------------------------
* Q850 Attribute Id decoder
* Specification: ITU-T Q.850
*--------------------------------------------------------------------
void Q850 Cause Attr Id; *gi=6,10 go=b gc=6,a,b,10
    LABL    0   0   b0  c4  Attribute Identity Diagnostics:;
    DBIT    1   a   5  5; //Extension Bit
    CEQU    0   a   0   14  Off;
    CEQU    1   a   0   14  On;

    DBIT    7   b   b0  c2  Attribute Number:;
    ANDG    f   b;
	CST#    0   b   0   14  Q850 Attribute Number;
	CLSE    0   0   0   14  Reserved;

    SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;

    LABL    0   0   b0  c4  Rejected Attribute:;
    Q850 Attribute;

    SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;

    LABL    0   0   b0  c4  Available Attribute:;
    Q850 Attribute;

    SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;
	DUMP    0   6   b0  c2  Extra Diagnostics Info:;
	TNXT    -Q931 Info Elem;

void Q850 Attribute;*gi=b go=x gc=a
    DBIT    1   a   5  5; //Extension Bit
    CEQU    0   a   0   14  Off;
    CEQU    1   a   0   14  On;

    SNEQ    1   b;
    SKIP    3;
    DBIT    2   0   b0  c2  Reserved:;
    DBIT    5   a   b0  c2  Transfer Capability:;
	CST#    ffffffff a 0 14 Q931 Info Xfer Cap Types;

    SNEQ    2   b;
    SKIP    3;
    DBIT    2   a   b0  c2  Transfer Mode:;
	CST#    ffffffff a 0 14 Q931 Xfer Mode Types;
    DBIT    5   0   b0  c2  Reserved:;

    SNEQ    3   b;
    SKIP    3;
    DBIT    2   0   b0  c2  Reserved:;
    DBIT    5   a   b0  c2  Transfer Rate:;
	CST#    ffffffff a 0 14 Q931 Xfer Rate Types;

    SNEQ    4   b;
    SKIP    2;
    DBIT    3   a   b0  c2  Structure:;
    DBIT    4   0   b0  c2  Reserved:;

    SNEQ    5   b;
    SKIP    3;
    DBIT    3   0   b0  c2  Reserved:;
    DBIT    2   a   b0  c2  Configuration:;
    DBIT    2   0   b0  c2  Reserved:;

    SNEQ    6   b;
    SKIP    2;
    DBIT    5   0   b0  c2  Reserved:;
    DBIT    2   a   b0  c2  Establishment:;

    SNEQ    7   b;
    SKIP    2;
    DBIT    2   a   b0  c2  Symmetry:;
    DBIT    5   0   b0  c2  Reserved:;

    SNEQ    8   b;
    SKIP    2;
    DBIT    2   0   b0  c2  Reserved:;
    DBIT    5   a   b0  c2  Info Xfer Rate (d->o);

    SNEQ    9   b;
    SKIP    2;
    DBIT    2   0   b0  c2  Layer:;
    DBIT    5   a   b0  c2  Layer Specific Info:;

    SNEQ    a   b;
    SKIP    1;
    DBIT    7   0   b0  c2  Rate Multiplier:;

    *unknown attribute
    SGTE    a   b;
    SKIP    1;
    DBIT    7   0   b0  c2  Attribute:;
    TRTS;
    
        
      
str# Q850 Rejection Reasons;
	User specific;
	IE missing;
	IE contents are not sufficient;

str# Q850 Condition;
    Unknown;
    Permanent;
    ;
    Transient;
    
str# Q850 Attribute Number;
    ;
    Information transfer capability;
    Information transfer mode;
    Information transfer rate;
    Structure;
    Configuration;
    Establishment;
    Symmetry;
    Information transfer rate (dest->orig);
    Layer identification;

*--------------------------------------------------------------------
* H.263 Decoder
* Specification: RFC 2190
*--------------------------------------------------------------------
void  H.263; *gi=10 go=x gc=3,4,10
    LABL    0   0   0   b1  H.263 Video Stream Header;
    DBIT    1   3   b0  c2  Flag Bit (F):;
    TEQU    0   3   0   0   H.263 Mode A;
    DBIT    1   3   b0  c2  Mode Bit:; *save in g3
    CEQU    0   3   0   14  Mode B;
    CEQU    1   3   0   14  Mode C;
    DBIT    3   4   b0  c2  Start Bit Position (SBIT):;
    DBIT    3   4   b0  c2  End Bit Position (EBIT):;
    DBIT    3   4   b0  c2  Source Format (SRC):;
    DBIT    5   4   b0  c2  First MB Quant Value (QUANT):;
    DBIT    5   4   b0  c2  Start GOB Number (GOBN):;
    DBIT    9   4   b0  c2  MB Address (MBA):;
    DBIT    2   4   b0  c2  Reserved (R):;
    DBIT    1   4   b0  c2  Picture Coding Type Bit (I):;
    CEQU    0   4   0   14  Intra-coded;
    CEQU    1   4   0   14  Inter-coded;
    DBIT    1   4   b0  c2  Unrestr Motion Vector Bit (U):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    1   4   b0  c2  Syntax Arith Coding Bit (S):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    1   4   b0  c2  Advanced Prediction Bit (A):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    7   4   b0  c2  First MB Hor Mot Vect (HMV1):;
    DBIT    7   4   b0  c2  First MB Ver Mot Vect (VMV1):;
    DBIT    7   4   b0  c2  Third Blk Hor Mot Vect (HMV2):;
    DBIT    7   4   b0  c2  Third Blk Ver Mot Vect (VMV2):;
	TEQU    0   3   0   0   H.263 Layer Selection; 
    DBIT    13  4   b0  c2  Reserved (RR):;
    DBIT    2   4   b0  c2  Diff Quantization Par (DBQ):;
    DBIT    3   4   b0  c2  Temp Ref For B frame (TRB):;
    DBIT    8   4   b0  c2  Temp Ref For P frame (TR):;
	TNXT    -H.263 Layer Selection;

void H.263 Mode A; *gi=10 go=x gc=4,10
    LABL    0   0   0   14  Mode A;
    DBIT    1   4   b0  c2  PB Frames Mode Bit (P):;
    CEQU    0   4   0   14  Normal I or P Frame;
    CEQU    1   4   0   14  PB-Frames;
    DBIT    3   4   b0  c2  Start Bit Position (SBIT):;
    DBIT    3   4   b0  c2  End Bit Position (EBIT):;
    DBIT    3   4   b0  c2  Source Format (SRC):;
    DBIT    1   4   b0  c2  Picture Coding Type Bit (I):;
    CEQU    0   4   0   14  Intra-coded;
    CEQU    1   4   0   14  Inter-coded;
    DBIT    1   4   b0  c2  Unrestr Motion Vector Bit (U):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    1   4   b0  c2  Syntax Arith Coding Bit (S):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    1   4   b0  c2  Advanced Prediction Bit (A):;
    CEQU    0   4   0   14  Off;
    CEQU    1   4   0   14  On;
    DBIT    4   4   b0  c2  Reserved (R):;
    DBIT    2   4   b0  c2  Diff Quantization Par (DBQ):;
    DBIT    3   4   b0  c2  Temp Ref For B frame (TRB):;
    DBIT    8   4   b0  c2  Temp Ref For P frame (TR):;
	TNXT    -H.263 Layer Selection;



void H.263 Layer Selection( )
{
	LABL( 0, 0, 0, 0xb1,  "" );
	BBIT( 17, l[1], 0x5, 0x5 );
	BBIT( 5, l[2], 0x5, 0x5 );
	BBIT( 8, l[3], 0x5, 0x5 );
	BBIT( 2, 0, 0x5,0x5, Byte filling );
	DECR 4;
	l[4] = l[1];
	SHFL( 5 ,l[4]);
	l[4] += l[2];
	if (l[1] == 1)
	{
		if (l[2] == 0)
		{
			H.263 Picture Layer;
		}
		if (l[2] != 0)
		{
			H.263 GoB Layer;
		}
	}
	TNXT    -Dump Data; 
}



//T-REC-H.263-200501-I 
void H.263 Picture Layer( )
{
	LABL( 0, 0, 0, 0xb1,  "H.263 Picture layer" );
	HBIT( 22, 0, 0xb0, 0xc2, "Picture Start Code (PSC):" );
	BBIT( 8, 0, 0xb0, 0xc2, "Temporal Reference (TR):" );
	BBIT( 1, 0, 0xb0, 0xc2, "avoid start code emulation:" );
		
	BBIT( 1, 0, 0xb0, 0xc2, "distinction with H.261.:" );
	BBIT( 1, l[29], 0xb0, 0xc2, "Split screen indicator:" );
		CEQU( 0, l[29], 0xb0, 0x14, "off" );
		CEQU( 1, l[29], 0xb0, 0x14, "on" );
	
	BBIT( 1, l[29], 0xb0, 0xc2, "Document camera indicator:" );
		CEQU( 0, l[29], 0xb0, 0x14, "off" );
		CEQU( 1, l[29], 0xb0, 0x14, "on" );

	BBIT( 1, l[29] 0xb0, 0xc2, "Full Picture Freeze Release:" );
		CEQU( 0, l[29], 0xb0, 0x14, "off" );
		CEQU( 1, l[29], 0xb0, 0x14, "on" );

	DBIT    3   4   b0  c2  Source Format (SRC):;
		CEQU    0   4   0   14  forbidden,;
		CEQU    1   4   0   14  sub-QCIF;
		CEQU    2   4   0   14  QCIF;
		CEQU    3   4   0   14  CIF;
		CEQU    4   4   0   14  4CIF;
		CEQU    5   4   0   14  16CIF;
		CEQU    6   4   0   14  reserved;
		CEQU    7   4   0   14  extended Ptype;
	XEQU 7 4 0 c2 H.263 PL PLUSPTYPE;
	if (g[4] != 7)
	{
		BBIT( 1, l[29], 0xe0, 0xc2, "Picture Coding Type:" );
			CEQU( 0, l[29], 0x90, 0x14, "INTRA (I-picture)" );
			CEQU( 1, l[29], 0x90, 0x14, "INTER (P-picture)" );
		BBIT( 1, l[29], 0xe0, 0xc2, "Opt. Unrestricted Motion Vector mode:" );
			CEQU( 0, l[29], 0x90, 0x14, "off" );
			CEQU( 1, l[29], 0x90, 0x14, "on" );
		BBIT( 1, l[29], 0xe0, 0xc2, "Opt. Syntax-based Arithmetic Coding mode:" );
			CEQU( 0, l[29], 0x90, 0x14, "off" );
			CEQU( 1, l[29], 0x90, 0x14, "on" );
		BBIT( 1, l[29], 0xe0, 0xc2, "Opt. Advanced Prediction mode:" );
			CEQU( 0, l[29], 0x90, 0x14, "off" );
			CEQU( 1, l[29], 0x90, 0x14, "on" );
		BBIT( 1, l[31], 0xe0, 0xc2, "Opt. PB-frames mode:" );
			CEQU( 0, l[31], 0x90, 0x14, "normal I- or P-picture" );
			CEQU( 1, l[31], 0x90, 0x14, "PB-frame" );
	}
	DBIT( 5, 0, 0xb0, 0xc2, "Quantizer Information (PQUANT):" );
	DBIT( 1, l[30], 0xe0, 0xc2, "Cont. Pres. MP and Video Multiplex (CPM):" );
			CEQU( 0, l[30], 0x90, 0x14, "off" );
			CEQU( 1, l[30], 0x90, 0x14, "on" );
	if (l[30] == 1)
	{
		DBIT( 2, 0, 0xb0, 0xc2, "Picture Sub-Bitstream Indicator (PSBI):" );
	}
	if (l[31] == 1)
	{
		//could have 5 bit length if custom picture clock frequency is in use, but no packets to verify!
		DBIT( 3, 0, 0xf0, 0xc2, "Temporal Reference for B-pictures in PB-frames "); 
		DBIT( 2, 0, 0xf0, 0xc2, "Quantization information for B-pictures in PB-frames (DBQUANT):" );
	}
	BBIT( 1, l[33], 0xe0, 0xc2, "Extra Insertion Information (PEI):" );
		CEQU( 0, l[33], 0x90, 0x14, "false" );
		CEQU( 1, l[33], 0x90, 0x14, "true" );
	if (l[33] == 1)
	{
		BBIT( 8, 0, 0xe0, 0xc2, "Supplemental Enhancement Information (PSUPP):" );
		BBIT( 1, l[33], 0xe0, 0xc2, "Extra Insertion Information (PEI):" );
			CEQU( 0, l[33], 0x90, 0x14, "false" );
			CEQU( 1, l[33], 0x90, 0x14, "true" );
	}
	TNXT    -Dump Data; 
}

void  H.263 PL PLUSPTYPE( )
{
	TNXT    -Dump Data; 
}

void H.263 GoB Layer( )
{
	LABL( 0, 0, 0, 0xb1,  "H.263 Group of Block layer");
	HBIT( 17, 0, 0xb0, 0xc2, "Picture Start Code (PSC):" );
	DBIT( 5, 0, 0xb0, 0xc2, "Group Number (GN):" );
	TNXT    -Dump Data; 
}

*--------------------------------------------------------------------
* G.711 Decoder (used for both PCMA and PCMU payloads)
* Specification: ITU-T G.711, RFC 1890
*--------------------------------------------------------------------
void G.711; *gi=10 go=x gc=4,5,10
    LABL    0   0   0   b1  G.711 Payload (PCMA/PCMU);
    MOVE    10  84  0   0   ;
    MOVE    10  85  0   0   ;
    DIVG    8   4;* get no. of data blocks (block size = 8)
    DGLB    0   4   90  c2  No. Of Data Blocks:;
    MODG    8   5;* see if there are padding bytes
    SGTE    1   5;
    SKIP    1;
    HEX#    0   5   90  c2  Pad Bytes:;
    LSTS    0   4   0   c2  Audio Data Block#;
    HEX#    8   0   90  0   :;
    SUBG    1   4;
    LSTZ    0   4;
	TNXT    -Dump Data;

*--------------------------------------------------------------------
* G.723 Decoder (Speech and SID)
* Specification: ITU-T G.723.1 and ITU-T G.723 Annex E
*--------------------------------------------------------------------
void G.723; *gi=10 go=x gc=4
    LABL    0   0   0   b1  G.723 Payload;
    LSTS    0   10   0   c7  G.723 Payload Block#;
    GBIT    8   4;* get to 2 LSBs to find payload type
    ANDG    3   4;* and remaining bits out

    CEQU    0   4   0   64  High Rate Speech (6.3 kbps);
    SKIP    80000001;
    G.723 High;

    CEQU    1   4   0   64  Low Rate Speech (5.3 kbps);
    SKIP    80000001;
    G.723 Low;

    CEQU    2   4   0   64  Silence Insertion Descriptor (SID);
    SKIP    80000001;
    G.723 SID;

    CEQU    3   4   0   64  G.723 Reserved Payload Type;
    SKIP    80000001;
    Dump Data;
    LABL    0   0   0   b8  ;* unident
    LSTZ    0   10  0   0   ;* continue if data left
    TRTS;

void G.723 High; *gi=10 go=x gc=10
    G.723 Octet 1;
    
    G.723 Octets 2-12;

    * octet 13
    BBIT    7   0   b0  c2  MSBPOS (B6..B0):;
    BBIT    1   0   b0  c2  UB:;

    * octet 14
    BBIT    2   0   b0  c2  POS0 (B1..B0):;
    BBIT    6   0   b0  c2  MSBPOS (B12..B7):;

    * octet 15
    BBIT    8   0   b0  c2  POS0 (B9..B2):;

    * octet 16
    BBIT    1   0   b0  c2  POS1 (B2):;
    BBIT    1   0   b0  c2  POS1 (B0):;
    BBIT    6   0   b0  c2  POS0 (B15..B10):;

    * octet 17
    BBIT    8   0   b0  c2  POS1 (B10..B3):;

    * octet 18
    BBIT    4   0   b0  c2  POS2 (B3..B0):;
    BBIT    4   0   b0  c2  POS1 (B13..B11):;

    * octet 19
    BBIT    8   0   b0  c2  POS2 (B11..B4):;

    * octet 20
    BBIT    4   0   b0  c2  POS3 (B3..B0):;
    BBIT    4   0   b0  c2  POS2 (B15..B12):;

    * octet 21
    BBIT    8   0   b0  c2  POS3 (B11..B4):;

    * octet 22
    BBIT    6   0   b0  c2  PSIG0 (B5..B0):;
    BBIT    2   0   b0  c2  POS3 (B13..B12):;

    * octet 23
    BBIT    3   0   b0  c2  PSIG2 (B2..B0):;
    BBIT    5   0   b0  c2  PSIG1 (B4..B0):;

    * octet 24
    BBIT    5   0   b0  c2  PSIG3 (B4..B0):;
    BBIT    3   0   b0  c2  PSIG2 (B5..B3):;

    TRTS;


void G.723 Low; *gi=10 go=x gc=10
    G.723 Octet 1;

    G.723 Octets 2-12;

    * octet 13
    BBIT    8   0   b0  c2  POS0 (B7..B0):;

    * octet 14
    BBIT    4   0   b0  c2  POS1 (B3..B0):;
    BBIT    4   0   b0  c2  POS0 (B11..B8):;

    * octet 15
    BBIT    8   0   b0  c2  POS1 (B11..B4):;

    * octet 16
    BBIT    8   0   b0  c2  POS2 (B7..B0):;

    * octet 17
    BBIT    4   0   b0  c2  POS3 (B3..B0):;
    BBIT    4   0   b0  c2  POS2 (B11..B4):;

    * octet 18
    BBIT    8   0   b0  c2  POS3 (B11..B4):;

    * octet 19
    BBIT    4   0   b0  c2  PSIG1 (B3..B0):;
    BBIT    4   0   b0  c2  PSIG0 (B3..B0):;

    * octet 20
    BBIT    4   0   b0  c2  PSIG3 (B3..B0):;
    BBIT    4   0   b0  c2  PSIG2 (B3..B0):;

    TRTS;

void G.723 SID; *gi=10 go=x gc=10
    G.723 Octet 1;

    * octet 2
    BBIT    8   0   b0  c2  LPC (B13..B6):;

    * octet 3
    BBIT    8   0   b0  c2  LPC (B21..14):;
    
    * octet 4
    BBIT    6   0   b0  c2  GAIN (B5..B0):;
    BBIT    2   0   b0  c2  LPC (B23..22):;

    TRTS;


void G.723 Octet 1;*gi=x go=x gc=5
    * octet 1
    BBIT    6   0   b0  c2  LPC (B5..B0):;
    BBIT    1   5   b0  c2  VADFLAG:;
    CEQU    0   5   0   14  speech;
    CEQU    1   5   0   14  non-speech;
    BBIT    1   5   b0  c2  RATEFLAG:;
    CEQU    0   5   0   14  high-rate;
    CEQU    1   5   0   14  low-rate;
    TRTS;


void G.723 Octets 2-12;*gi=x go=x gc=x
    * octet 2
    BBIT    8   0   b0  c2  LPC (B13..B6):;

    * octet 3
    BBIT    8   0   b0  c2  LPC (B21..14):;
    
    * octet 4
    BBIT    6   0   b0  c2  ACL0 (B5..B0):;
    BBIT    2   0   b0  c2  LPC (B23..22):;
    
    * octet 5
    BBIT    5   0   b0  c2  ACL2 (B4..B0):;
    BBIT    2   0   b0  c2  ACL1 (B1..B0):;
    BBIT    1   0   b0  c2  ACL0 (B6):;
    
    * octet 6
    BBIT    4   0   b0  c2  GAIN0 (B3..B0):;
    BBIT    2   0   b0  c2  ACL3 (B1..B0):;
    BBIT    2   0   b0  c2  ACL2 (B6..B5):;

    * octet 7
    BBIT    8   0   b0  c2  GAIN0 (B11..B4):;

    * octet 8
    BBIT    8   0   b0  c2  GAIN1 (B7..B0):;

    * octet 9
    BBIT    4   0   b0  c2  GAIN2 (B3..B0):;
    BBIT    4   0   b0  c2  GAIN1 (B11..B8):;

    * octet 10
    BBIT    8   0   b0  c2  GAIN2 (B11..B4):;

    * octet 11
    BBIT    8   0   b0  c2  GAIN3 (B7..B0):;

    * octet 12
    BBIT    1   0   b0  c2  GRID3 (B0):;
    BBIT    1   0   b0  c2  GRID2 (B0):;
    BBIT    1   0   b0  c2  GRID1 (B0):;
    BBIT    1   0   b0  c2  GRID0 (B0):;
    BBIT    4   0   b0  c2  GAIN3 (B11..B8):;
    TRTS;


*--------------------------------------------------------------------
* G.728 Decoder
* Specification: ITU-T G.728, RFC 1890
*--------------------------------------------------------------------
void G.728; *gi=10 go=x gc=10
    LABL    0   0   0   b1  G.728 Payload;
    LSTS    0   10   0   c7  G.728 Payload Block#; *indent

    DBIT    a   0   b0  c2  Vector[1]:;
    DBIT    a   0   b0  c2  Vector[2]:;
    DBIT    a   0   b0  c2  Vector[3]:;
    DBIT    a   0   b0  c2  Vector[4]:;
    LABL    0   0   0   b8  ;* unindent

    LSTZ    0   10;
    TRTS;


*--------------------------------------------------------------------
* G.729 Decoder
* Specification: ITU-T G.729, RFC 1890
*--------------------------------------------------------------------
void G.729; *gi=10 go=x gc=10
    LABL    0   0   0   b1  G.729 Payload;

    LSTS    0   10   0   c7  G.729 Payload Block#;

    CLTE    a   10  0   64  Voice Frame (VAD);
    SKIP    80000001;
    G.729 Voice;

    CEQU    2   10  0   64  Comfort Noise Generator Frame (CNG);
    SKIP    80000001;
    G.729 CNG;

    SLTE    a   10  0   0   ;* g10 >= 10 ?
    SKIP    7;* yes, continue main loop
    SLTE    3   10  0   0   ;* g10 < 10. g10 >= 3 ?
    SKIP    80000002;* no, more checks
    HEX#    0   10  b0  c2  Unknown Payload Data:;* 2 < g10 < 10
    SKIP    3;

    SEQU    1   10  0   0   ;* g10 == 1 ?
    SKIP    80000001;* no, continue main loop
    HEX#    0   10  b0  c2  Unknown Payload Data:;* g10 == 1

    LABL    0   0   0   b8  ;* unident
    LSTZ    0   10  0   0   ;* continue if data left

void G.729 Voice;*gi=10 go=x gc=10
    BBIT    1   0   b0  c2  L0:;
    BBIT    7   0   b0  c2  L1:;
    BBIT    5   0   b0  c2  L2:;
    BBIT    5   0   b0  c2  L3:;
    BBIT    8   0   b0  c2  P1:;
    BBIT    1   0   b0  c2  P0:;
    BBIT    d   0   b0  c2  C1:;
    BBIT    4   0   b0  c2  S1:;
    BBIT    3   0   b0  c2  GA1:;
    BBIT    4   0   b0  c2  GB1:;
    BBIT    5   0   b0  c2  P2:;
    BBIT    d   0   b0  c2  C2:;
    BBIT    4   0   b0  c2  S2:;
    BBIT    3   0   b0  c2  GA2:;
    BBIT    4   0   b0  c2  GB2:;
    TRTS;

void G.729 CNG;*gi=10 go=x gc=10
    BBIT    1   0   b0  c2  LSF0:;
    BBIT    5   0   b0  c2  LSF1:;
    BBIT    4   0   b0  c2  LSF2:;
    BBIT    5   0   b0  c2  GAIN:;
    BBIT    1   0   b0  c2  RESV:;
    TRTS;

void H.261;
	LABL 0 0 0 b1 H.261 - Video Codec;
	DBIT 3 0 a0 c2 Start Bit Position:;
	DBIT 3 0 a0 c2 End Bit Position:;
	DBIT 1 5 a0 c2 Intraframe Encoded Data:;
	DBIT 1 3 a0 c2 Motion Vector Flag:;
	DBIT 4 0 a0 c2 GOB Number:;
	DBIT 5 4 a0 c2 Macroblock Address Pred:;
	DBIT 5 4 a0 c2 Quantizer:;
	DBIT 5 4 a0 c2 Horizontal Motion Vector:;
	DBIT 5 4 a0 c2 Vertical Motion Vector:;

void h323gatedisc;
	*gateway discovery is handled differently depending on whether it was sent via tcp or udp
	if( g[3] == 6 )
	{
		*tcp case
		TPKT;
		h323hostcall::Q931;
		TRTS;
	}
	
	TNXT -h225RASMessage;

void h323gatestat;
	*handled differently depending on whether it was sent via tcp or udp
	if( g[3] == 6 )
	{
		*tcp case
		TPKT;
		h323hostcall::Q931;
		TRTS;
	}
	TNXT -h225RASMessage;

void H.323 RTP/RTCP;
	MARK 3 1 0 0 UDP Sockets;
	MARK 3 2 0 0 UDP Sockets;
	TNXT -RTP/RTCP;

void h323hostcall_with_tpkt()
{	
* SP: 09/17/2002 - Retrieving the source port of the 1st Q.931 packet (the SETUP message) is not the way to
* identify a H.245 conversation, H.245 can be on a different port + H.245 encapsulation in Q.931 packets
* (H.245 tunneling) can be activated.  The way to retrieve the H.245 Control Channel port is to check for
* the H.245 Address field i.e commenting out the MARK instruction.
	*add 1 to port source port
	* ADDG 1 1;
	*mark new source port
	* MARK 1 1 0 0 H323_Decoders;

	*+ handle TPKT
	GWRD 0 5 0 0 ;
	SEQU 300 5;
	SKIP 1;
	TRTS;
	TPKT;
	
	h323hostcall;
}

//call this function if the tpkt has already been read
//inputs:
//g[1] = tpkt length
void h323hostcall()
{
	if( g[1] > 0x0000ffff )
	{
		//tpkt lengths are 16 bits, if g[1] is greater than that something is messed up
		TRTS;
	}
	
	l[10] = 3;
	
    while( l[10] == 3 )
    {	
		TEQU 0 10 0 30 IP Null;
		
		//g[1] has the packet length from TPKT
		l[1] = g[1];
		l[1] -= 4;	//the tpkt length includes the tpkt data which is 4 bytes
		BREM 0 42 5 5;
		h323hostcall::Q931;
		BREM 0 43 5 5;
		l[2] -= l[3];
		l[1] -= l[2];
		//the tpkt length includes the tpkt so more than 4 bytes indicates extra data
		if( l[1] > 0 )
		{
			if( l[1] == 1 )
			{
				l[2] = pb[0];
				
				if( l[2] == 0 )
				{
					//if there is one extra byte and it is a null byte just skip it
					//instead of dumping it
					INCR 1;
					l[1] -= 1;
				}
			}
			
			if( l[1] > 0 )
			{
				DUMP 0 41 90 c2 Extra TPKT Data:;
			}
		}
		
		l[10] = pb[0];
		
		//see if there is another tpkt
		GWRD 0 5 0 0 ;
		SEQU 300 5;
		SKIP 1;
		TRTS;
		TPKT;
    } 
}
    
void h323hostcall::Q931()
{
	TEQU 0 10 0 30 IP Null;
	LABL 0 0 0 b1 Q.931 - Basic Call Control\Q.931:;
	DBYT 0 5 a0 c2 Protocol Discriminator:\;
	CST# ffffffff 5 0 14 Q931 Proto Descriminators;
	TNEQ 8 5 0 0 Q931 Not;
	DBYT 0 5 a0 c2 Call Reference Value Len:\;
	CEQU 0 5 0 14 Dummy Call Reference;
	TEQU 0 5 0 0 Q931 Mtype;
	SLTE 5 5;
	SKIP e;
	SEQU 3 5;
	SKIP c;
	SEQU 2 5;
	SKIP 4;
	SEQU 1 5;
	SKIP 5;
	DLNG 0 0 a0 c2 Call Reference Value:\;
	TNXT -Q931 Mtype;
	DBIT 1 0 5 5;
	DBIT f 0 a0 c2 Call Reference Value:\;
	TNXT -Q931 Mtype;
	DBIT 1 0 5 5;
	DBIT 7 0 a0 c2 Call Reference Value:\;
	TNXT -Q931 Mtype;
	HEX# 0 5 a0 c2 Call Reference Value:\;
	TNXT -Q931 Mtype;
}

void Q931 Mtype;
	DBIT 3 6 a0 c2 Message Category:\Cat:;
	CST# ffffffff 6 0 14 Q931 Msg Categories;
	DBIT 5 7 a0 c2 Message Type:\Type:;
	TLTE 4 6 0 0 Q931 OInfo;
	SEQU 3 6;
	SKIP 6;
	SEQU 2 6;
	SKIP 6;
	SEQU 1 6;
	SKIP 6;
	CST# ffffffff 7 0 14 Q931 CEM Types;
	TNXT -Q931 OInfo;
	CST# ffffffff 7 0 14 Q931 MCM Types;
	TNXT -Q931 OInfo;
	CST# ffffffff 7 0 14 Q931 CCM Types;
	TNXT -Q931 OInfo;
	CST# ffffffff 7 0 14 Q931 CIPM Types;
	TNXT -Q931 OInfo;

void Q931 OInfo;
	TNXT -Q931 Info Elem;

void Q931 Info Elem;
	SEQU 0 f;  *use f to tell whether to end indent
	SKIP 1;
	LABL 0 0 0 b8;
	MOVE 1 f;
	TGTE 0 10 0 0 RETURN;
	GBYT 0 5;
	TBIT 7 5 0 0 Q931 SOIEF;
	GBYT 0 5;
	CST# ffffffff 5 0 b7 Q931 VElem Types;
	*LABL 0 0 0 1 Information Element;
	DBYT 0 5 b0 c2 Identifier:;
	CST# ffffffff 5 0 14 Q931 VElem Types;
	TEQU 7e 5 0 30 Q931 User-user;
    TEQU d 5 0 30 Q931 Extended Facility;
	DBYT 0 6 b0 c2 Content Length:;
	
	TNEQ 0 6 0 30 Q931_IE_Type; * SP: If content length = 0 skip to the next IE Type
	TNXT -Q931 Info Elem;
	
void Q931_IE_Type;
	TEQU 4 5 0 30 Q931 Bearer Capability;
	TEQU 8 5 0 30 Q931 Cause;
	TEQU 14 5 0 30 Q931 Call State;
	TEQU 18 5 0 30 Q931::ChannelIdentification;
    TEQU 1c 5 0 30 Q931 Facility;
	TEQU 1e 5 0 30 Q931 Progress Indicator;
	TEQU 27 5 0 30 Q931 Notification Indicator;
	TEQU 28 5 0 30 Q931 Display;
	TEQU 29 5 0 30 Q931 Date/Time;
	TEQU 2c 5 0 30 Q931 Keypad Facility;
    TEQU 32 5 0 30 Q931 Information Request;
	TEQU 34 5 0 30 Q931 Signal;
    TEQU 38 5 0 30 Q931 Feature Activation;
    TEQU 39 5 0 30 Q931 Feature Indication;
    TEQU 3a 5 0 30 Q931 Service Profile Identification;
    TEQU 3b 5 0 30 Q931 Endpoint Identifier;
	TEQU 6c 5 0 30 Q931 Call Party Number;
	TEQU 6d 5 0 30 Q931 Call Party Subaddress;
	TEQU 70 5 0 30 Q931 Call Party Number;
	TEQU 71 5 0 30 Q931 Call Party Subaddress;
    TEQU 74 5 0 30 Q931 Redirecting Number;
    TEQU 76 5 0 30 Q931 Redirection Number;
    if (g[6] > g[16])
	{
		HEX# 0 10 b0 c2 Contents:;
		LABL 0 0 0 b8;
		TRTS;
    }
	HEX# 0 6 b0 c2 Contents:;
	LABL 0 0 0 b8;

void Q931 SOIEF;
	GBIT 4 5;
	BBIT 1 0 b0 c2 Single Octet Info Element:;
	TEQU a 5 0 0 Q931 SOIEF Type 2;
	ANDG 7 5;
	CST# ffffffff 5 0 80 Q931 SOIEF Types;
	LABL 0 0 0 10 Information Element;
	BBIT 3 5 b0 c2 Information Element Identifier:;
	CST# ffffffff 5 0 14 Q931 SOIEF Types;
	BBIT 4 5 b0 c2 Information Element Contents:;
	TNXT -Q931 Info Elem;

void Q931 SOIEF Type 2;
	GBIT 7 5;
	BBIT 7 5 b0 c2 Information Element Identifier:;
	CEQU 20 5 0 14 More Data;
	CEQU 21 5 0 14 Sending Complete;
	TNXT -Q931 Info Elem;

void Q931 Bearer Capability;
	GBIT 3 7 0 42;
	ANDG 3 7 0 42;
	DGLB 0 7 b0 c2 Coding Standard:;
	CST# ffffffff 7 0 14 Q931 Coding Standard Types;
	GBYT 0 8 0 42;
	ANDG 1f 8 0 42;
	DGLB 0 8 b0 c2 Transfer Capability:;
	CST# ffffffff 8 0 14 Q931 Info Xfer Cap Types;
	INCR 1;
	GBIT 3 7 0 42;
	ANDG 3 7 0 42;
	DGLB 0 7 b0 c2 Transfer Mode:;
	CST# ffffffff 7 0 14 Q931 Xfer Mode Types;
	GBYT 0 7 0 42;
	ANDG 1f 7 0 42;
	DGLB 0 7 b0 c2 Transfer Rate:;
	CST# ffffffff 7 0 14 Q931 Xfer Rate Types;
	INCR 1;
	SUBG 2 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	SNEQ 18 7;
	SKIP 6;
	GBYT 0 7 0 c2;
	ANDG 7f 7 0 c2;
	DGLB 0 7 b0 c2 Rate Multiplier:;
	INCR 1;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	BBIT 3 7 b0 c2 Layer 1 Identifier:;
	GBYT 0 7 0 42;
	ANDG 1f 7 0 42;
	DGLB 0 7 b0 c2 User Info Layer 1 Protocol:;
	CST# ffffffff 7 0 14 Q931 User Info Proto Types;
	INCR 1;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	HEX# 0 6 b0 c2 Remaining Contents:;
	TNXT -Q931 Info Elem;

void Q931::ChannelIdentification()
{
	//g[6] holds the message length
	l[6] = g[6];
	
	BBYT 0 41 b0 c2 Interface Info:;
	l[2] = l[1];
	l[2] &= 0x80;
	CEQU 0 42 0 e4 0... .... Extension Bit: Off;
	CEQU 80 42 0 e4 1... .... Extension Bit: On;
	BST# 0 41 0 e4 Q931::ChannelIdentificationContentStrings;
	
	l[2] = l[1];
	l[3] = l[1];
	
	l[2] &= 0x3;	//get the last 2 bits
	l[3] &= 0x20;	//mask out the 6th bit
	
	SEQU 0 43 0 0;
	SKIP 3;
	CST# 0 42 0 e4 Q931::ChannelIdentificationOtherInterfaceStrings;
	SLTE 1 43 0 0;
	SKIP 1;
	CST# 0 42 0 e4 Q931::ChannelIdentificationBasicInterfaceStrings;

	//we have processed one byte
	l[6] -= 1;
		
	l[3] = l[1]; 
	l[3] &= 0x40;
	
	if( l[3] == 0x40 )
	{
		l[5] = 0x00;
		
		while( l[5] != 0x80 )
		{
			//get the interface identifier;
			GBYT 0 44 0 0;
			l[5] = l[4];
			l[5] &= 0x80;
			INCR 1  0 0 0;
			
			//we have processed one byte
			l[6] -= 1;
		}
	}
	
	l[3] = l[1];
	l[3] &= 0x20;
	
	if( l[3] == 0x20 )
	{
		//get the interface information
		BBYT 0 44 b0 c2 Channel Info:;
		l[5] = l[4];
		l[5] &= 0x80;	//get the extension bit
		CEQU 0 45 0 e4 0... .... Extension Bit: Off;
		CEQU 80 45 0 e4 1... .... Extension Bit: On;
		l[5] = l[4];
		l[5] &= 0x60;	//get the coding standard
		CEQU 0 45 0 e4 .00. .... ITU-T Standardized Coding;
		CEQU 20 45 0 e4 .01. .... ISO/IEC Standard;
		CEQU 30 45 0 e4 .10. .... National Standard;
		CEQU 60  45 0 e4 .11. .... Network Defined Standard;
		l[5] = l[4];
		l[5] &= 0x10;
		CEQU 0 45 0 e4 ...0 .... Using Channel Number;
		CEQU 10 45 0 e4 ...1 .... Using Slot Map;
		l[5] = l[4];
		l[5] &= 0x0f;
		CST# 0 45 0 e4 Q931::ChannelIdentificationTypeStrings;
		
		//we have processed one byte
		l[6] -= 1;
		
		l[5] = l[4];
		l[5] &= 0x10;
		
		SEQU 10 45 0 0;
		SKIP 3;
		HEX# 0 46 b0 c2 Channel Number;
		SEQU 0 45 0 0;
		SKIP 1;
		HEX# 0 46 b0 c2 Slot Map;
		
		l[6] = 0;	
	}
	
	if( l[6] > 0 )
	{
		//dump any extra data
		DUMP 0 46 b0 c2 Extra Data:;
	}
	
	TNXT -Q931 Info Elem;
}

str# Q931::ChannelIdentificationContentStrings;
	6 | .1.. .... Explicitly Defined Interface;
	    .0.. .... Implicitly Defined Interface;
	5 | ..1. .... Other Interface;
	    ..0. .... Basic Interface;
	4 | ...x .... Spare;
	    ...x .... Spare;
	3 | .... 1... Exclusive;
	    .... 0... Preferred;
	2 | .... .1.. Channel is D-channel;
	    .... .0.. Not D-channel;

str# Q931::ChannelIdentificationBasicInterfaceStrings;
	0 | .... ..00 No Channel;
	1 | .... ..01 B1 Channel;
	2 | .... ..10 B2 Channel;
	3 | .... ..11 Any Channel;

str# Q931::ChannelIdentificationOtherInterfaceStrings;
	0 | .... ..00 No Channel;
	1 | .... ..01 As Indicated;
	2 | .... ..10 Reserved;
	3 | .... ..11 Any Channel;

str# Q931::ChannelIdentificationTypeStrings;
	0x3 | .... 0011 B-channel Units;
	0x6 | .... 0110 H0-channel Units;
	0x8 | .... 1000 H11-channel Units;
	0x9 | .... 1001 H12-channel Units;
	
void Q931 Display;
	CHR# 0 6 b0 c2 Display Information:;
	TNXT -Q931 Info Elem;

void Q931 User-user;
	DWRD 0 6 b0 c2 Content Length:;
	DBYT 0 7 b0 c2 Protocol Descriminator:;
	CST# ffffffff 7 0 14 Q931 Proto Descr Types;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
    h225_H323_UserInformation;
    
	TRTS;
    
void Q931 Cause;
	GBIT 3 7 0 42;
	ANDG 3 7 0 42;
	DGLB 0 7 b0 c2 Coding Standard:;
	CST# ffffffff 7 0 14 Q931 Coding Standard Types;
	GBYT 0 8 0 42;
	ANDG f 8 0 42;
	DGLB 0 8 b0 c2 Location:;
	CST# ffffffff 8 0 14 Q850 Location Types;
	CLSE 0 0 0 14 Reserved;
    GBIT 1 7 0 0 extbit;
	INCR 1;
	SUBG 1 6 0 0;
	TEQU 0 6 0 0 Q931 Info Elem;
    SEQU 1 7;    *extbit == 1 ?;
    SKIP 6 0 0 0 no recommendation;

	DBYT 0 7 b0 c2 Recommendation:;
	CST# ffffffff 7 0 14 Q850 Recommendation Types;
	CLSE 0 0 0 14 Reserved;
	SUBG 1 6 0 0;
	TEQU 0 6 0 0 Q931 Info Elem;

	GBIT 4 7 0 42;
	ANDG 7 7 0 42;
	DGLB 0 7 b0 c2 Cause Class:;
	CST# ffffffff 7 0 14 Q850 Cause Class Types;
	GBYT 0 8 0 42;
	ANDG f 8 0 42;
	DGLB 0 8 b0 c2 Cause Value:;
	GBYT 0 8 0 42;
	ANDG 7f 8 0 42;
	CST# 0 8 0 14 Q850 Cause Value Types;
	INCR 1;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
    *+ added
    TEQU 15 8 0 0  Q850 Cause Reject;
    TEQU 39 8 0 0  Q850 Cause Attr Id;*57
    TEQU 3a 8 0 0  Q850 Cause Attr Id;*58
    TEQU 41 8 0 0  Q850 Cause Attr Id;*65
    *-
	DUMP 0 6 b0 c2 Diagnostics:;
	TNXT -Q931 Info Elem;

void Q931 Not;
	DUMP 1 0 b0 c2 Data Area:;

void Q931 Call State;
	DBIT 2 7 b0 c2 Coding Standard:;
	CST# ffffffff 7 0 14 Q931 Coding Standard Types;
	DBIT 6 8 b0 c2 Call State Value:;
	CEQU 1f 8 0 14 Call Independent Service;
	TNXT -Q931 Info Elem;

void Q931 Call Party Number;
	//g[6] holds the number of bytes left in this message
	GBYT 0 41 0 0;
	l[2] = l[1];
	l[2] &= 0x80;	//save the extension bit
	l[3] = l[1];
	l[3] &= 0x70;
	SHFR 4 43 0 0;
	DGLB 0 43 b0 c2 Type of Number:;
	CST# ffffffff 43 0 14 Q931 Type of Number Types;
	l[3] = l[1];
	l[3] &= 0x0f;
	DGLB 0 43 b0 c2 Numbering Plan ID:;
	CST# ffffffff 43 0 14 Q931 Num Plan ID Types;
	INCR 1;
	SUBG 1 6;
	
	if( l[2] == 0 )
	{
		BBYT 0 41 b0 c2 Indicators:;
		l[3] = l[1];
		l[3] &= 0x60;
		l[4] = l[1];
		l[4] &= 0x80;	//get the extension bit
		CEQU 0 44 0 e4 0... .... Extension Bit: Off;
		CEQU 80 44 0 e4 1... .... Extension Bit: On;
		CST# 0 43 0 e4 Q931::CallPartyNum_PresentationIndStrings;
		LABL 0 0 0 e4 ...x xx.. Spare;
		l[1] &= 0x03;
		CST# 0 41 0 e4 Q931::CallPartyNum_ScreeningIndStrings;
		SUBG 1 6;	//we read another byte, decrement the message length
	}
	
	TEQU 0 6 0 0 Q931 Info Elem;
	CHR# 0 6 b0 c2 Number Digits:;
	TNXT -Q931 Info Elem;

str# Q931::CallPartyNum_PresentationIndStrings;
	0x00 | .00. .... Presentation Allowed;
	0x20 | .01. .... Presentation Restricted;
	0x40 | .10. .... Number not available due to interworking;
	0x60 | .11. .... Reserved;
	
str# Q931::CallPartyNum_ScreeningIndStrings;
	0x00 | .... ..00 User-provided, not screened;
	0x01 | .... ..01 User-provided, verified and passed;
	0x02 | .... ..10 User-provided, verified and failed;
	0x03 | .... ..11 Network provided;
	
void Q931 Call Party Subaddress;
	GBIT 4 7 0 42;
	ANDG 7 7 0 42;
	DGLB 0 7 b0 c2 Type of Subaddress:;
	CST# ffffffff 7 0 14 Q931 Type of Subaddress Types;
	GBIT 5 8 0 42;
	CBIT 0 8 0 14 Odd Number Address SIgnals;
	CLSE 0 0 0 14 Even Number Address SIgnals;
	INCR 1;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	DUMP 0 6 b0 c2 Subaddress Information:;
	TNXT -Q931 Info Elem;

void Q931 Date/Time;
	DBYT 0 0 b0 c2 Year:;
	DBYT 0 0 b0 c2 Month:;
	DBYT 0 0 b0 c2 Day:;
	SUBG 3 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	DBYT 0 0 b0 c2 Hour:;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	DBYT 0 0 b0 c2 Minute:;
	SUBG 1 6;
	TEQU 0 6 0 0 Q931 Info Elem;
	DBYT 0 0 b0 c2 Second:;
	SUBG 1 6;
	TNXT -Q931 Info Elem;

void Q931 Keypad Facility;
	CHR# 0 6 b0 c2 Keypad Facility Information:;
	TNXT -Q931 Info Elem;

void Q931 Notification Indicator;
	GBYT 0 8 0 42;
	ANDG 7f 8 0 42;
	DGLB 0 8 b0 c2 Notification Indicator:;
	CEQU 0 8 0 14 User Suspended;
	CEQU 1 8 0 14 User Resumed;
	CEQU 2 8 0 14 Bearer Service Change;
    CEQU 3 8 0 14 Discriminator For Extension To ASN.1;
    CEQU 4 8 0 14 Call Completion Delay;
    CEQU 42 8 0 14 Conference Established;
    CEQU 43 8 0 14 Conference Disconnected;
    CEQU 44 8 0 14 Other Party Added;
    CEQU 45 8 0 14 Isolated;
    CEQU 46 8 0 14 Reattached;
    CEQU 47 8 0 14 Other Party Isolated;
    CEQU 48 8 0 14 Other Party Reattached;
    CEQU 49 8 0 14 Other Party Split;
    CEQU 4a 8 0 14 Other Party Disconnected;
    CEQU 4b 8 0 14 Conference Floating;
    CEQU 4f 8 0 14 Conference Floating, Served User Preempted;
    CEQU 4c 8 0 14 Conference Disconnected, Preemption;
    CEQU 79 8 0 14 Remote Hold;
    CEQU 7a 8 0 14 Remote Retrieval;
    CEQU 60 8 0 14 Call Is Waiting;
    CEQU 7b 8 0 14 Call Is Diverting;
    CEQU 68 8 0 14 Diversion Activated;
    CEQU 69 8 0 14 Reserved For Call Transfer;
    CEQU 6a 8 0 14 Reserved For Call Transfer;
    CEQU 6e 8 0 14 Reverse Charging (Whole Call);
    CEQU 6f 8 0 14 Reverse Charging (Rest Of The Call);
	INCR 1;
	TNXT -Q931 Info Elem;

void Q931 Progress Indicator;
	GBIT 3 7 0 42;
	ANDG 3 7 0 42;
	DGLB 0 7 b0 c2 Coding Standard:;
	CST# ffffffff 7 0 14 Q931 Coding Standard Types;
	GBYT 0 8 0 42;
	ANDG f 8 0 42;
	DGLB 0 8 b0 c2 Location:;
	CST# ffffffff 8 0 14 Q850 Location Types;
	CLSE 0 0 0 14 Reserved;
	INCR 1;
	GBYT 0 8 0 42;
	ANDG 7f 8 0 42;
	DGLB 0 8 b0 c2 Progress Description:;
	CST# ffffffff 8 0 14 Q931 Prog Descr Types;
	CLSE 0 0 0 14 Reserved;
	INCR 1;
	TNXT -Q931 Info Elem;

void Q931 Signal;
	DBYT 0 7 b0 c2 Signal Value:;
	CST# ffffffff 7 0 14 Q931 Signal Types;
	TNXT -Q931 Info Elem;

void h225RASMessage;
	LABL 0 0 90 c1 H.225;
	MOVE 1 a; *track bits and offset for alignment;
	BBIT 1 2 5  5; //Extension Bit
    SNEQ 0 2;* ext ?
    SKIP 7;
	DBIT 5 1 90 c2 RAS Message:;
	ADDG 6 a;* track bits and offset for alignment;
	ADDG 1 1;
	CST# 0 1 0 14 RAS Message Types;
	TST# 0 1 0 0 RAS Message Types Funcs;
	PER_Align;
    TRTS;

    * extensions
	DBIT 7 1 90 c2 Choice Ext Index:;
	PER_Align;
    PER_ExtLen;
	ADDG 1 1 0 0;
	CST# 0 1 0 14 RAS Message Types Extensions;
	TST# 0 1 0 0 RAS Message Types Extensions Funcs;
	PER_Align;
    TRTS;

void SEQ OF AliasAddress g8;
	SEQU 0 8;
	SKIP 3;
	SUBG 1 8;
	h225_AliasAddress;
	SEQ OF AliasAddress g8;
	TRTS;

void SEQ OF TransportAddress g8;
	SEQU 0 8;
	SKIP 3;
	SUBG 1 8;
	TransportAddress;
	SEQ OF TransportAddress g8;
	TRTS;

void Gatekeeper_Request_GRQ;
	PER_ExtBit;
	BBIT 4 d 5  5; //Options Bits
	ADDG 5 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 3 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

	LABL 0 0 90 c7 RAS Address;
	TransportAddress;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Endpoint Type;
	EndpointType;
	LABL 0 0 00 c8;

	SBIT 2 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Gatekeeper Identifier;
	BMPString;
	LABL 0 0 00 c8;

	SBIT 1 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Call Services;
	QseriesOptions;
	LABL 0 0 00 c8;

	SBIT 0 d;
	SKIP 80000005;
	LABL 0 0 90 c7 Endpoint Alias;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 00 c8;

   *+ extensions
    MOVE    b   2;			*numexp;
    PER_Seq_ExtBitMask;

    SBIT    b   c;			*alternateEndpoints;
    SKIP    80000005;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Alternate Endpoints;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_Endpoint;

    SBIT    a   c;			*tokens;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    9   c;			*cryptoTokens;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    8   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    DBYT 1 8 5 5;
    LABL 0 0 90 c9 Authentication Capacity;
    H235::AuthCapacity();
    LABL 0 0 0 c8;

    SBIT    7   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL 0 0 90 c9 Algorithm OIDs Data;
    SEQ OF ObjectIdentifier_BER;
    LABL 0 0 0 c8;

    SBIT    6   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Integrity Data:;

    SBIT    5   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Integrity Check Value Data:;

    SBIT    4   c;
    SKIP    80000002;        *not present
    LABL    0   0  90 c2  SupportsAltGK:;
    LABL    0   0  90  50  NULL;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    h225::FeatureSet;
    //DUMP    0   1   90  c2  FeatureSet:;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  genericData:;

    SBIT    1   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  supportsAssignedGK:;
    PER_Boolean;
	PER_Align;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Assigned GateKeeper:;

    //PER_ExtLen;
    //DUMP    0   1   90  c2  Integrity Check Value Data:;

	PER_Align;
    INCR 1;
	TRTS;

void Gatekeeper_Confirm_GCF;
	PER_ExtBit;
	BBIT 2 41 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 1 41;
	SKIP 80000003;
	LABL 0 0 90 c9 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
 
	SBIT 0 41;
	SKIP 80000003;
	LABL 0 0 90 c7 Gatekeeper Identifier;
	BMPString;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 RAS Address;
	TransportAddress;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    9   2;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Alternate Gatekeeper;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_AlternateGK;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    LABL    0   0   90  c7  Authentication Mode;
    H235::AuthMechnism;
    LABL	0	0	0	c8;

    SBIT    2   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL 0 0 90 c7 Tokens;
    h225::seq_of_ClearToken;
    LABL 0 0 0 c8;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c7  Algorithm OID;
	ObjectIdentifier_BER;
	LABL	0	0	0	c8;

    SBIT    5   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Integrity Data:;

    SBIT    6   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Integrity Check Value Data:;
    
    SBIT	7	c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL	0	0	90	c7	Feature Set;
    h225::FeatureSet;
    LABL	0	0	0	c8;
    
    SBIT	8	c;
    SKIP    80000007;        *not present
    PER_ExtLen;
    l[1] = g[8];
    g[8] = 0;	//unconstrained sequence_of
    LABL	0	0	90	c7	Generic Data;
    h225::seq_of_GenericData;
    LABL	0	0	0	c8;
    g[8] = l[1];
    
    *- extensions

	PER_Align;
	TRTS;

void Gatekeeper_Reject_GRJ;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 1 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Gatekeeper Identifier;
	BMPString;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Reject Reason;
	GatekeeperRejectReason;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    3   2;
    PER_Seq_ExtBitMask;

    SBIT    3   c;
    SKIP    80000004;        *not present
	LABL    0   0   90  c2  Alt GK Info;
    PER_ExtLen;
	h225_AltGKInfo;
	PER_Align;

    SBIT    2   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions
	PER_Align;

	TRTS;
void H235::AuthCapacity()
{
    SEQU    0   8;
	SKIP    3;
	SUBG    1   8;
	H235::AuthMechnism();
	H235::AuthCapacity();
}

void H235::AuthMechnism()
{
   	BBIT    1   2   5  5; //Extension Bit
    ADDG    1   a;
    if (g[2] == 0)
  //	BBIT    1   0   5  5; //Extension Bit
	{
        LABL  0  0 90 c2 AuthenticationMechanism:;
       // INCR 1;
        BBIT    3   1f  5  5; //Options Bits

        ADDG    3   a;          *track bits and offset for alignment;

        SNEQ    0   1f;
        SKIP    1;
        LABL    0 0 90 70 dhExch;

        SNEQ    1   1f;
        SKIP    1;
        LABL    0 0 90 70 pwdSymEnc;

        SNEQ    2   1f;
        SKIP    1;
        LABL    0 0 90 70 pwdHash;

        SNEQ    3   1f;
        SKIP    1;
        LABL    0 0 90 70 certSign;

        SNEQ    4   1f;
        SKIP    1;
        LABL    0 0 90 70 ipsec;

        SNEQ    5   1f;
        SKIP    1;
        LABL    0 0 90 70 tls;

        SNEQ    6   1f;
        SKIP    2;
        LABL    0   0   70  c2  Non Standard Data;
        NonStandardParameter;
        TRTS;
    }
    //PER_Align;

    PER_ExtLen;
	LABL    0   0   90  c2  AuthenticationBES:;
    H235::AuthenticationBES();
    PER_Align;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  keyExch Profile;
    ObjectIdentifier_BER;
    PER_Align;
}

void h225::seq_of_ClearToken()
{
	PER_Align;
	
	l[1] = g[8];
	PER_SeqLen_Unconstrained;
	
	while( g[8] > 0 )
	{
		LABL 0 0 90 c7 ClearToken;
		H235::ClearToken;
		LABL 0 0 0 c8;
		g[8] -= 1;
	}
	
	g[8] = l[1];
}

void H235::ClearToken()
{
	BBIT 1 41 5 5;	//ext bit
	BBIT 8 42 5 5;	//option bits
	
	LABL 0 0 90 c7 TokenOID;
	ObjectIdentifier_BER;
	LABL 0 0 0 c8;
	
	SBIT	7	42;
	SKIP	80000002;
	LABL 0 0 90 c2 timeStamp:;
	h235_TimeStamp;
	
	SBIT	6	42;
	SKIP	80000003;
	LABL 0 0 90 c7 Password;
	BMPString;
	LABL 0 0 0 c8;
	
	
	SBIT	5	42;
	SKIP	80000003;
	LABL 0 0 90 c7 dhKey;
	H235::DHSet;
	LABL 0 0 0 c8;
	
	SBIT	4	42;
	SKIP	80000006;
	l[3] = g[8];
	g[8] = 121;	// 128 - 8 + 1
	PER_Constrained_Whole_Number;
	g[8] += 8;	//add lower_bound
	CHR# 0 8 90 c2 Challenge:;
	g[8] = l[3];
	
	SBIT	3	42;
	SKIP	80000005;
	l[3] = g[8];
	g[8] = 0;	//unconstrained integer
	PER_Integer;
	DGLB 0 8 90 c2 Random:;
	g[8] = l[3];
	
	SBIT	2	42;
	SKIP	80000003;
	LABL 0 0 90 c7 Certificate;
	H235::TypedCertificate;
	LABL 0 0 0 c8;
	
	SBIT	1	42;
	SKIP	80000003;
	LABL 0 0 90 c7 generalID;
	BMPString;
	LABL 0 0 0 c8;
	
	SBIT	0	42;
	SKIP	80000003;
	LABL 0 0 90 c7 NonStandard;
	NonStandardParameter;	
	LABL 0 0 0 c8;
	
	if( l[1] == 0 )
	{
		//no extensions present
		TRTS;
	}
	
	g[2] = 4;
	PER2_Seq_ExtBitMask;
	
	SBIT	0	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 eckasdhkey:;
	
	SBIT	1	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL 0 0 90 c7 sendersID;
	BMPString;
	LABL 0 0 0 c8;

	SBIT	2	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 h235Key:;
	
	SBIT	3	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 Profile Info:;
	
	TRTS;	
}

void H235::DHSet()
{
	PER_ExtBit;
	l[1] = g[8];
	g[8] = 2049;	// 2048 - 0 + 1
	PER_Constrained_Whole_Number;
	DUMP 0 8 90 c2 HalfKey:;
	
	g[8] = 2049;
	PER_Constrained_Whole_Number;
	DUMP 0 8 90 c2 ModSize:;
	
	g[8] = 2049;
	PER_Constrained_Whole_Number;
	DUMP 0 8 90 c2 Generator:;
	
	g[8] = l[1];
}

void H235::TypedCertificate()
{
	PER_ExtBit;
	
	LABL 0 0 90 c7 Type;
	ObjectIdentifier_BER;
	LABL 0 0 0 c8;
	
	l[1] = g[8];
	g[8] = 0;
	PER_LengthDeterminant;
	DUMP 0 8 90 c2 Certificate:;
	g[8] = l[1];
}

void  H235::AuthenticationBES()
{
        PER_Align;
        INCR 1;
        ADDG    8   a;
        DBYT    1   41  5  5; //Options Bits

        ADDG    8   a;          *track bits and offset for alignment;

        SNEQ    0   41;
        SKIP    1;
        LABL    0  0 90 70 ClearToken;
        SNEQ     40  41;
        SKIP    1;
        LABL    0  0 90 70 Radius;
}

void Registration_Request_RRQ;
	PER_ExtBit;
	BBIT 3 d 5  5; //Options Bits
	ADDG 4 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 2 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	LABL 0 d 90 c2 Discovery Complete:;
	PER_Boolean;

	LABL 0 0 0 b7 Call Signal Address;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 RAS Address;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 Terminal Type;
	EndpointType;
	LABL 0 0 0 b8;

	SBIT 1 d;
	SKIP 80000005;
	LABL 0 0 0 b7 Terminal Alias;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 0 b7 Gatekeeper Identifier;
	BMPString;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 Endpoint Vendor;
	VendorIdentifier;
	LABL 0 0 0 b8;

    *+ extensions
    MOVE    16   2;			*numexp;
    PER_Seq_ExtBitMask;

    SBIT    16   c;			*alternateEndpoints;
    SKIP    80000006;		*not present;
    PER_ExtLen;
    LABL    0   0   0 b7  Alternate Endpoints;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_Endpoint;
	LABL 0 0 0 b8;


    SBIT    15   c;			*timeToLive;
    SKIP    80000006;		*not present;
    PER_ExtLen;
    l[1] = g[8];
    g[8] = 4294967295;	//4294967295 - 1 + 1
	PER_Integer;
	g[8] += 1;
	DGLB	0	8	90	c2 Time To Live:;
	g[8] = l[1];

    SBIT    14   c;			*tokens;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    13   c;			*cryptoTokens;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    //ADDG   1  1;
    DUMP    0   1   90  c2  Crypto Tokens:;

    SBIT    12   c;			*integrityCheckValue;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Integrity Check Value:;

	//SBIT	11	c;		keepAlive is not optional
    PER_ExtLen;
    LABL    0   0   90  c2  Keep Alive:;
	PER_Boolean;
	PER_Align;

	SBIT	10	c;			//endpointIdentifier
	SKIP	80000004;		//not present
	PER_ExtLen;
	LABL	0	0	0	b7 Endpoint Identifier;
	BMPString;
	LABL	0	0	0	b8;
	
	//SBIT    f   c;			*willSupplyUUIEs;
    PER_ExtLen;
    LABL    0   0   90  c2  Will Supply UUIEs:;
	PER_Boolean;
	PER_Align;

	//SBIT    e   c;			*maintainConnection;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	PER_Align;

    SBIT    d   c;			*suppAnxECallSig;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Alternative Transport:;
    TransportAddress;
    PER_Align;

    SBIT    c   c;			*suppAnxECallSig;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Additive Registration:;
    LABL	0	0	0	14	Null;

    SBIT    b   c;			*terminalAliasPattern;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 Terminal Alias Pattern:;

    SBIT    a   c;			*supportsAltGK;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  SupportsAltGK:;
    LABL    0   0	0	14   NULL;

    SBIT    9   c;			*usageReportingCapability;
    SKIP    80000005;		*not present;
    PER_ExtLen;
    LABL 0 0 0	b7 Usage Reporting Capability;
	h225_RasUsageInfoTypes;
	LABL 0 0 0	b8;
	PER_Align;

    SBIT    8   c;			*multipleCalls;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   1   90  c2 multipleCalls:;
    DUMP 0 1 90 c2 multipleCalls  Data:;

    SBIT    7   c;			*supportedH248Packages;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 supportedH248Packages:;

    SBIT    6   c;			*callCreditCapability;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL 0 0 0	b7 callCreditCapability;
    h225_CallCreditCapability;
    PER_Align;
    LABL 0 0 0	b8;

    SBIT    5   c;			*capacityReportingCapability;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 CapacityReportingCapability:;

    SBIT    4   c;			*capacity;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 CallCapacity:;

    SBIT    3   c;			*featureSet;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 featureSet:;

    SBIT    2   c;			*genericData;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP 0 1 90 c2 genericData:;

    SBIT    1   c;			*restart;
    SKIP    80000003;		*not present
    PER_ExtLen;
    LABL 0 1 90 c2 Restart:;
    LABL 0 0 0 14 NULL;

    SBIT    0   c;			*supportsACFSequence;
    SKIP    80000003;		*not present
    PER_ExtLen;
    LABL 0 1 90 c2 SupportsACFSequences:;
    LABL 0 0 0 14 NULL;


	//SBIT    3   c;			*suppAnxECallSig;
	//SKIP    80000002;		*not present;
    //LABL 0 0 90 c2 SupportsAssignedGK:;
    //PER_Boolean;


    //SBIT    2   c;			*suppAnxECallSig;
    //SKIP    80000002;		*not present;
    //PER_ExtLen;
    //DUMP  0 1 90 c2 assignedGatekeeper:;


    //SBIT    1   c;			*suppAnxECallSig;
    //SKIP    80000002;		*not present;
    //PER_ExtLen;
    //DUMP  0 1 90 c2 transportQOS:;

    //SBIT    0   c;			*suppAnxECallSig;
    //SKIP    80000002;		*not present;
    //PER_ExtLen;
    //DUMP  0 1 90 c2 language:;

	PER_Align;
	TRTS;

void Registration_Confirm_RCF;
	PER_ExtBit;
	BBIT 3 d 5  5; //Options Bits
	ADDG 4 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 2 d;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 Call Signal Address;
	PER_Align;
	l[1] = g[8];
	PER_LengthDeterminant;
	SEQ OF TransportAddress g8;
	g[8] = l[1];
	LABL 0 0 0 b8;

	SBIT 1 d;
	SKIP 80000005;
	LABL 0 0 0 b7 Terminal Alias;
	PER_Align;
	l[1] = g[8];
	PER_LengthDeterminant;
	SEQ OF AliasAddress g8;
	g[8] = l[1];
	LABL 0 0 0 b8;

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 0 b7 Gatekeeper Identifier:;
	BMPString;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 Endpoint Identifier;
	BMPString;
	LABL 0 0 0 b8;

    *+ extensions
    MOVE    11   2;			*numexp;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;			*alternateGatekeeper;
    SKIP    80000008;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c7  Alternate Gatekeeper;
	l[1] = g[8];
	PER_LengthDeterminant;
	DGLB 0 8 90 c2 Count:;
	SEQ OF h225_AlternateGK;
	g[8] = l[1];
	LABL	0	0	0	c8;

    SBIT    1   c;			*timeToLive;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Time To Live:;
    MOVE 1 1;
	PER_LargeInt;

    SBIT    2   c;			*tokens;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    3   c;			*cryptoTokens;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   c;			*integrityCheckValue;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    5   c;			*willRespondToIRR;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Will Respond To IRR:;
	PER_Boolean;
	PER_Align;

    SBIT    6   c;			*preGrantedARQ;
    SKIP    80000005;		*not present;
    LABL    0   0   90  c7  Pre Granted ARQ;
    PER_ExtLen;
    h225_preGrantedARQ;
    LABL	0	0	0	c8;
	PER_Align;

    SBIT    7   c;			*maintainConnection;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Maintain Connection:;
	PER_Boolean;
	
    SBIT    8   c;			*serviceControl;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    LABL	0	0	90	c7 Service Control;
    h225::seq_of_ServiceControlSession;
    LABL	0	0	0	c8;
	
    SBIT    9   2;			*supportsAdditiveRegistration;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Supports Additive Registration:;
    LABL	0	0	0	14 NULL;
	
    SBIT    a   c;			*Terminal Alias Pattern;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Terminal Alias Pattern:;
	
    SBIT    b   c;			*Supported Prefixes;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Supported Prefixes:;
	
    SBIT    c   c;			*usageSpec;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  usageSpec:;
	
    SBIT    d   c;			*featureServerAlias;
    SKIP    80000003;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c2  Feature Server Alias;
	h225_AliasAddress;
	
    SBIT    e   c;			*capacityReportingSpec;
    SKIP    80000002;		*not present;
    PER_ExtLen;
    DUMP    0   1   90  c2  Capacity Reporting Spec:;
	
    SBIT    f   c;			*featureset;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL    0   0   90  c7  Feature Set:;
    h225::FeatureSet;
    LABL	0	0	0	c8;
	
    SBIT    10   c;			*genericdata;
    SKIP    80000004;		*not present;
    PER_ExtLen;
    LABL	0	0	90	c7 GenericData;
	h225::seq_of_GenericData;
	LABL	0	0	0	c8;
    *- extensions

	PER_Align;
	TRTS;

void Registration_Reject_RRJ;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0  0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 1 d;
	SKIP 80000003;
	LABL 0 0 0 b7 Non Standard Data;
	NonStandardParameter;

	LABL 0 0 90 c2 Reg Reject Reason:;
	RegistrationRejectReason;
	SBIT 0 d;
	SKIP 80000002;
	LABL 0 0 90 c2 Gatekeeper Identifier;
	BMPString;

    *+ extensions
    MOVE    6   2;			*numexp;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  Alt GK Info;
	h225_AltGKInfo;
	PER_Align;

    SBIT    1   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL	0	0	90	c7 Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    
    SBIT	4	c;
    SKIP	80000004;
    PER_ExtLen;
    LABL	0	0	90	c7 Feature Set;
    h225::FeatureSet;
    LABL	0	0	0	c8;
    
    SBIT	5	c;
    SKIP	80000004;
    PER_ExtLen;
    LABL	0	0	90	c7 Generic Data;
    h225::seq_of_GenericData;
    LABL	0	0	0	c8;
    *- extensions

	PER_Align;
	TRTS;
	
void UnRegistration_Request_URQ;
	PER_ExtBit;
	BBIT 3 d 5  5; //Options Bits
	ADDG 4 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;
	LABL 0 0 90 c7 Call Signal Address;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;
	LABL 0 0 00 c8;
	
	SBIT 2 d;
	SKIP 80000005;
	LABL 0 0 90 c7 Endpoint Alias;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 00 c8;
	
	SBIT 1 d;
	SKIP 80000002;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Endpoint Identifier;
	BMPString;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    a   2;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Alternate Endpoints;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_Endpoint;

    SBIT    1   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  Gatekeeper Identifier;
	BMPString;

    SBIT    2   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL 0 0 90 c7 Tokens;
    h225::seq_of_ClearToken;
    LABL 0 0 0 c8;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    4   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    5   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c7  Reason;
    UnregRequestReason;
    LABL	0	0	00	c8;
    *- extensions

	SBIT	6	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 EndpointAliasPattern:;
	
	SBIT	7	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 SupportedPrefixes:;
	
	SBIT	8	c;
	SKIP	80000007;
	PER_ExtLen;
	LABL 0 0 90 c7 AlertnateGK;
	l[1] = g[8];
	PER_LengthDeterminant;
	SEQ OF h225_AlternateGK;
	g[8] = l[1];
	LABL 0 0 0 c8;
	
	SBIT	9	c;
	SKIP	80000007;
	PER_ExtLen;
	LABL 0 0 90 c7 GenericData;
	l[1] = g[8];
	g[8] = 0;
	h225::seq_of_GenericData;
	g[8] = l[1];
	LABL 0 0 0 c8;
		
	PER_Align;
	TRTS;

void UnRegistration_Confirm_UCF;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void UnRegistration_Reject_URJ;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	LABL 0 0 90 c7 Reject Reason;
	UnregRejectReason;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    3   2;
    PER_Seq_ExtBitMask;

    SBIT    3   c;
    SKIP    80000004;        *not present
	LABL    0   0   90  c2  Alt GK Info;
    PER_ExtLen;
	h225_AltGKInfo;
	PER_Align;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;


// si: you hope that...
//	g[2] = length of bits to reverse
//	g[0xc] = bits that need to be reversed...return reversed value in g[0xc]
void PER_BitReverse;
	l[2] = 0;
	while (g[2] > 0)
	{	
		l[1] = g[0xc];
		ANDG 1 41;
		l[2] += l[1];
		SHFL 1 42;
		SHFR 1 c;
		g[2] -= 1;
	}
	SHFR 1 42;				// si: the last SHFL should be killed by this
	g[0xc] = l[2];
	TRTS;

void Admission_Request_ARQ;
	BBIT 1 41 5 5;	//ext bit
	BBIT 7 42 5  5; //Options Bits
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Call Type;
	CallType;
	LABL 0 0 0 b8;

	SBIT 6 42; *call model;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 Call Model;
	CallModel;
	LABL 0 0 0 b8;


	LABL 0 0 0 b7 Endpoint Identifier;
	BMPString;
	LABL 0 0 0 b8;

	SBIT 5 42;
	SKIP 80000005; *not present;
	LABL 0 0 0 b7 Destination Info;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

	SBIT 4 42;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 Dest Call Signal Address;
	TransportAddress;
	LABL 0 0 0 b8;

	SBIT 3 42; *dest extra call info;
	SKIP 80000005;
	LABL 0 0 0 b7 Dest Extra Call Info;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

	LABL 0 0 0 b7 Src Info;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;


	SBIT 2 42; *src call signal address option;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 Src Call Signal Address;
	TransportAddress;
	LABL 0 0 0 b8;

    LABL 0 0 90 c2 Bandwidth:;
    MOVE 0 1;
	PER_LargeInt;
	DWRD 0 0 90 c2 Call Reference Value:;

	SBIT 1 42; *NonStandardData;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 nonStandardData;
	NonStandardParameter;
	LABL 0 0 0 b8;

	SBIT 0 42; *call services;
	SKIP 80000003; *not present;
	LABL 0 0 0 b7 Call Services;
	QseriesOptions;
	LABL 0 0 0 b8;

	PER_Align;
	LABL 0 0 90 c7 Conference Identifier;
	h225::GloballyUniqueID;
	LABL 0 0 0 c8;

	LABL 0 0 90 c2 Active MC:;
	PER_Boolean;
	LABL 0 0 90 c2 Answer Call:;
	PER_Boolean;

	if( l[1] == 0 )
	{
		TRTS;
	}
	
    // extensions
    MOVE    13   2;
    g[12] = 1;	//has extensions
    PER2_Seq_ExtBitMask;
    
	// if there are no extensions then leave
	SNEQ 0 c;
	SKIP 1;
	TRTS;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Can Map Alias:;
	PER_Boolean;
	PER_Align;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    2   c;
    SKIP    80000007;        *not present
    PER_ExtLen;
    LABL    0   0   90  c7  Src Alternatives;
	l[3] = g[8];
	PER_LengthDeterminant;
	SEQ OF h225_Endpoint;
	g[8] = l[3];
	LABL	0	0	0	c8;

    SBIT    3   c;
    SKIP    80000007;        *not present
    PER_ExtLen;
    LABL    0   0   90  c7  Dest Alternatives;
	l[3] = g[8];
	PER_LengthDeterminant;
	SEQ OF h225_Endpoint;
	g[8] = l[3];
	LABL	0	0	0	c8;

    SBIT    4   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c9  Gatekeeper Identifier;
	BMPString;
	LABL	0	0	00	c8;

    SBIT    5   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c7  Tokens;
    h225::seq_of_ClearToken;
    LABL	0	0	0	c8;

    SBIT    6   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    7   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    8   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Src Alternatives;
    h225_TransportQOS;

    SBIT    9   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Will Supply UUIEs:;
	PER_Boolean;
	
	
	SBIT	a	c;					// ?????
	SKIP	80000004;
	PER_ExtLen;
    LABL    0   0   90  c9  Call Linkage;
	PER_Align;
	DUMP 0 1 90 c2 Data:;
	/*
	DBYT    1   8   5  5;  //SEQ OF Length
	h225::CallLinkageSequence;
	LABL	0	0	00	c8;
	*/
	//Call Linkage
	
	
	SBIT	b	c;					// Gateway Data Rate
	SKIP	80000004;
	PER_ExtLen;
	LABL 0 0 00 b7 Gateway Data Rate;
	h225_DataRate;
	LABL 0 0 00 b8;
	
	SBIT c c;					// Call Capacity
	SKIP 80000004;
	PER_ExtLen;
	LABL 0 0 00 b7 Capacity;
	DUMP 0 1 90 c2 Data:;
	LABL 0 0 00 b8;

	SBIT	d	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL 0 0 00 b7 Circuit Info;
	DUMP 0 1 90 c2 Data:;
	LABL 0 0 00 b8;
	
	
	SBIT e c;
	SKIP 80000007;
	PER_ExtLen;
	LABL 0 0 00 b7 Desired Protocols;
    l[1] = g[8];
    PER_LengthDeterminant;
	SEQ OF h225_SupportedProtocols;
	g[8] = l[1];
	LABL 0 0 00 b8;
	
	SBIT f c;
	SKIP 80000004;
	PER_ExtLen;
	LABL 0 0 00 b7 Desired Tunnelled Protocol;
	DUMP 0 1 90 c2 Data:;
	LABL 0 0 00 b8;
	
	SBIT 10 c;
	SKIP 80000004;
	PER_ExtLen;
	LABL 0 0 00 b7 Feature Set;
	h225::FeatureSet;
	LABL 0 0 00 b8;
	
	SBIT 11 c;
	SKIP 80000007;
	PER_ExtLen;
	LABL 0 0 00 b7 Generic Data;
	l[1] = g[8];
	g[8] = 0;	//unconstrained
	h225::seq_of_GenericData;
	g[8] = l[1];
	LABL 0 0 00 b8;
	
	SBIT 12 c;
	SKIP 80000004;
	PER_ExtLen;
    LABL 0 0 90 c2 Can Map Alias:;
	PER_Boolean;
	PER_Align;
	
    //- extensions

	PER_Align;
	TRTS;
	
/*
void h225::CallLinkageSequence;
	if (g[8] > 0)
	{
		get ext bits
		SBIT 0 41;
		SKIP 80000002;
		LABL 0 0 90 c2 Global Call ID:;
		GloballyUniqueID;
		
		SBIT 1 41;
		SKIP 80000002;
		LABL 0 0 90 c2 ThreadID:;
		GloballyUniqueID;
	}

void GloballyUniqueID;
	CHR# 10 0 00 2;
	TRTS;
*/


void h225::FeatureSet;
	PER_ExtBit;
	BBIT 3 41 5 5;	//90 c2 options:;		//Options Bits
	g[0xa] += 4;
	//RBIT 3 41;						
	
	LABL 0 0 00 c2 Replacement Feature Set;
	PER_Boolean;
	g[0xa] += 1;
	PER_Align;
	
	l[2] = g[8];
	g[8] = 0;	//0 means the sequence_of_genericdata is unconstrained
	
	SBIT 2 41;
	SKIP 80000003;
	LABL 0 0 00 b7 Needed Features;
	h225::seq_of_GenericData;
	LABL 0 0 00 b8;
	
	SBIT 1 41;
	SKIP 80000003;
	LABL 0 0 00 b7 Desired Features;
	h225::seq_of_GenericData;
	LABL 0 0 00 b8;
	
	SBIT 0 41;
	SKIP 80000003;
	LABL 0 0 00 b7 Supported Features;
	h225::seq_of_GenericData;
	LABL 0 0 00 b8;
	
	g[8] = l[2];

//inputs:
//g[8] = range of sequence_of (upper_bound - lower_bound + 1) 
//set to 0 if unconstrained
void h225::seq_of_GenericData()
{
	PER_Align;
	l[1] = g[8];
	
	if( l[1] == 0 )
	{
		PER_SeqLen_Unconstrained;
	}
	
	if( l[1] > 0 )
	{
		//don't modify g[8] before calling this
		PER_SeqLen_Constrained;
	}
	
	l[2] = g[8];
	g[8] = l[1];	//restore value of g[8]
	
	DGLB 0 42 90 c2 Item Count:;
	
	while( l[2] > 0 )
	{
		LABL 0 0 0 c7 Item;
		h225::GenericData;
		LABL 0 0 0 c8;
		l[2] -= 1;
	}
}

void h225::GenericData;
	PER_ExtBit;
	BBIT 1 41 5 5; //90 c2 here:;		//Optional Bits
	
	h225::GenericIdentifier;			//ID
	
	SBIT 0 41;
	SKIP 80000003;
		LABL 0 0 0 c7 Parameters;
		h225::seq_of_EnumeratedParameter;		//Parameters
		LABL 0 0 0 c8;
	TRTS;

void h225::GenericIdentifier;
	PER_ExtBit;
	BBIT 2 41 5 5;
	DGLB 0 41 90 c2 ID:;
		CEQU 0 41 0 14 Standard;
		CEQU 1 41 0 14 OID;
		CEQU 2 41 0 14 nonStandard;
		
	if (l[1] == 0)
	{
		BBIT 1 42 5 5;	//ext bit
		if( l[2] == 0 )
		{
			l[2] = g[8];
			g[8] = 16384;	//16383 - 0 + 1
			PER_Integer;
			DGLB 0 8 90 c2 Standard;
			g[8] = l[2];
		}
	}
	if (l[1] == 1)
	{
		LABL 0 00 42 c7 Obj ID:;
		ObjectIdentifier_BER;
		LABL 0 0 0 c8;
	}
	if (l[1] == 2)
	{
		LABL 0 00 90 c7 NonStandard:;
		h225::GloballyUniqueID;
		LABL 0 0 0 c8;
	}

void h225::GloballyUniqueID()
{
	HWRD 80000000 41 90 c2 GUID:;
	HWRD 80000000 41 0 0;
	LABL 0 0 0 0 -;
	HWRD 80000000 41 0 0;
	LABL 0 0 0 0 -;
	HWRD 80000000 41 0 0;
	LABL 0 0 0 0 -;
	HWRD 80000000 41 0 0;
	LABL 0 0 0 0 -;
	HWRD 80000000 41 0 0;
	HWRD 80000000 41 0 0;
	HWRD 80000000 41 0 0;
}

void h225::seq_of_EnumeratedParameter()
{
	PER_Align;
	l[1] = g[8];
	g[8] = 512;	//range of seqlen
	PER_SeqLen_Constrained;
	l[2] = g[8];
	g[8] = l[1];
	
	//the seq_of len goes from 1 to 512 so the len will be off by 1
	l[2] += 1;
	
	DGLB 0 42 90 c2 Parameter Count:;
	
	while( l[2] > 0 )
	{
		LABL 0 0 0 c7 Item;
		h225::EnumeratedParameter;
		LABL 0 0 0 c8;
		l[2] -= 1;
	}
}

void h225::EnumeratedParameter;
	BBIT 1 41 5 5;	//ext bit
	BBIT 1 41 5 5;		//Options Bits
	
	h225::GenericIdentifier;

	SBIT 0 41;
	SKIP 80000001;
		h225::Content;
	TRTS;

// content ::= choice
void h225::Content()
{
	PER_ExtBit;
	DBIT 4 41 90 c2 Choice:;
	CST# 0 41 00 14 h225::Content::List;
	
	if( l[1] == 0 )
	{
		LABL 0 0 0 c7 Raw;
		//octet string
		LABL 0 0 0 c8;
		TRTS;
	}
	
	if( l[1] == 1 )
	{
		LABL 0 0 0 c7 Text;
		//ia5string
		LABL 0 0 0 c8;
		TRTS;
	}

	if( l[1] == 2 )
	{
		LABL 0 0 0 c7 Unicode;
		BMPString;
		LABL 0 0 0 c8;
		TRTS;
	}

	if( l[1] == 3 )
	{
		PER_Boolean;
		TRTS;
	}
	
	if( l[1] == 4 )
	{
		l[2] = g[8];
		g[8] = 256; // 255 - 0 + 1
		PER_Integer;
		DGLB 0 8 90 c2 Number8:;
		g[8] = l[2];
		TRTS;
	}
	
	if( l[1] == 5 )
	{
		l[2] = g[8];
		g[8] = 65536; // 65535 - 0 + 1
		PER_Integer;
		DGLB 0 8 90 c2 Number16:;
		g[8] = l[2];
		TRTS;
	}
	
	if( l[1] == 6 )
	{
		l[2] = g[8];
		g[8] = 4294967296; // 4294967295 - 0 + 1
		PER_Integer;
		DGLB 0 8 90 c2 Number32:;
		g[8] = l[2];
		TRTS;
	}

	if( l[1] == 7 )
	{
		LABL 0 0 0 c7 Id;
		h225::GenericIdentifier;
		LABL 0 0 0 c8;
		TRTS;
	}	

	if( l[1] == 8 )
	{
		LABL 0 0 0 c7 Alias;
		h225_AliasAddress;
		LABL 0 0 0 c8;
		TRTS;
	}

	if( l[1] == 9 )
	{
		LABL 0 0 0 c7 Transport;
		TransportAddress;
		LABL 0 0 0 c8;
		TRTS;
	}

	if( l[1] == 10 )
	{
		LABL 0 0 0 c7 Compound;
		h225::seq_of_EnumeratedParameter;
		LABL 0 0 0 c8;
		TRTS;
	}
	
	if( l[1] == 11 )
	{
		LABL 0 0 0 c7 Nested;
		l[2] = g[8];
		g[8] = 16;	// 16 - 1 + 1
		h225::seq_of_GenericData;
		g[8] = l[2];
		LABL 0 0 0 c8;
		TRTS;
	}			
}	

str# h225::Content::List;
	 0 | Raw;
	 1 | Text;
	 2 | Unicode;
	 3 | BOOL;
	 4 | Number8;
	 5 | Number16;
	 6 | Number32;
	 7 | ID;
	 8 | Alias;
	 9 | Transport;
	10 | Compound;
	11 | Nested;

// --------------------------------------------------------------------------

void Admission_Confirm_ACF;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;

	l[1] = g[8];
	g[8] = 4294967296;	//4294967295 - 0 + 1
	PER_Integer;
    DGLB 0 8 90 c2 Bandwidth:;
    g[8] = l[1];

	LABL 0 0 90 c2 Call Model;
	CallModel;

	LABL 0 0 0 b7 Dest Call Signal Address;
	TransportAddress;
	LABL 0 0 0 b8;

	SBIT 1 d;
	SKIP 80000005;
	PER_Align;
	l[1] = g[1];
	LABL	0	0	90	c2 IRR Frequency:;
	PER_Integer65535;
	g[1] = l[1];

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    16  2;
    PER2_Seq_ExtBitMask;
    
	SNEQ 0 c;
	SKIP 1;
	TRTS;

    SBIT    0   c;
    SKIP    80000006;        *not present
    LABL    0   0   0 b7  Destination Info;
    PER_ExtLen;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    1   c;
    SKIP    80000006;        *not present
    LABL    0   0   0 b7  Dest Extra Call Info;
    PER_ExtLen;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    2   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Destination Type;
    PER_ExtLen;
	EndpointType;
	LABL 0 0 0 b8;

    SBIT    3   c;
    SKIP    80000006;        *not present
    LABL    0   0   0 b7  Remote Extension Address;
    PER_ExtLen;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    4   c;
    SKIP    80000006;        *not present
    LABL    0   0   0 b7  Alternate Endpoints;
    PER_ExtLen;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_Endpoint;
	LABL 0 0 0 b8;

    SBIT    5   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0 90 c7  Tokens;
    h225::seq_of_ClearToken;
	LABL 0 0 0 c8;

    SBIT    6   c;
    SKIP    80000004;        *not present
    LABL    0   0 0 b7  Crypto Tokens Data;
    PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    7   c;
    SKIP    80000004;        *not present
	LABL 0 0 0 b7 Integrity Check Value;
    PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    8   c;
    SKIP    80000005;        *not present
    LABL    0   0   0 b7  TransportQOS;
    PER_ExtLen;
    h225_TransportQOS;
	PER_Align;
	LABL 0 0 0 b8;

    SBIT    9   c;
    SKIP    80000006;        *not present
    LABL    0   0   0 b7  Will Respond To IRR;
    PER_ExtLen;
    LABL    0   0   90 c2  Value;
	PER_Boolean;
	PER_Align;
	LABL 0 0 0 b8;

    SBIT    a   c;
    SKIP    80000005;        *not present
    LABL    0   0   0 b7  UUIEs Requested;
    PER_ExtLen;
    h225_UUIEsRequested;
	PER_Align;
	LABL 0 0 0 b8;

    SBIT    b   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Language Data;
    PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    c   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Alternate Transport Addresses;
    PER_ExtLen;
	DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    d   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Use Specified Transport;
    PER_ExtLen;
	DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;
	
    SBIT    e   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Circuit Info;
    PER_ExtLen;
	DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;
	
    SBIT    f   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Usage Spec;
    PER_ExtLen;
	DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;
	
    SBIT    10   c;
    SKIP    80000007;        *not present
    LABL    0   0   0 b7  Supported Protocols;
    PER_ExtLen;
    l[1] = g[8];
    PER_LengthDeterminant;
	SEQ OF h225_SupportedProtocols;
	g[8] = l[1];
	LABL 0 0 0 b8;

    SBIT    11   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Service Control;
    PER_ExtLen;
	h225::seq_of_ServiceControlSession;
	LABL 0 0 0 b8;

    SBIT    12   c;
    SKIP    80000003;        *not present
    LABL    0   0   90 c2  Multiple Calls:;
	PER_Boolean;
	PER_Align;

    SBIT    13   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Feature Set;
    PER_ExtLen;
	h225::FeatureSet;
	LABL 0 0 0 b8;

    SBIT    14   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Generic Data;
    PER_ExtLen;
	h225::seq_of_GenericData;
	LABL 0 0 0 b8;

    SBIT    15   c;
    SKIP    80000004;        *not present
    LABL    0   0   0 b7  Modified Source Info;
    PER_ExtLen;
	DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;
					
	PER_Align;
	TRTS;

void Admission_Reject_ARJ;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	LABL 0 0 90 c7 Reject Reason;
	AdmissionRejectReason;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    4   2;
    PER_Seq_ExtBitMask;

    SBIT    4   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  Alt GK Info;
	h225_AltGKInfo;
	PER_Align;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    2   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Call Signal Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Bandwidth_Request_BRQ;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	LABL 0 0 90 c2 Endpoint Identifier;
	BMPString;
	PER_Align;
	HEX# 10 0 90 c2 Conference Identifier:;
	DWRD 0 0 90 c2 Call Reference Value:;
	SBIT 1 d;
	SKIP 80000002;
	LABL 0 0 90 c2 Call Type;
	CallType;
    LABL 0 0 90 c2 Bandwidth:;
    MOVE 0 1;
	PER_LargeInt;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    6   2;
    PER_Seq_ExtBitMask;

    SBIT    6   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    5   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  Gatekeeper Identifier;
	BMPString;

    SBIT    4   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    1   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Answered Call:;
	PER_Boolean;
	PER_Align;

    SBIT    0   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
    DBIT    7   0   90  c2  Remaining Call Capacity:;
	PER_Align;
    *- extensions

	PER_Align;
	TRTS;

void Bandwidth_Confirm_BCF;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	PER_Align;
	LABL 0 0 90 c2 Bandwidth:;
	MOVE 0 1;
	PER_LargeInt;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Bandwidth_Reject_BRJ;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	LABL 0 0 90 c2 Reject Reason;
	BandRejectReason;
    LABL 0 0 90 c2 Bandwidth:;
    MOVE 0 1;
	PER_LargeInt;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    3   2;
    PER_Seq_ExtBitMask;

    SBIT    3   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
	LABL    0   0   90  c2  Alt GK Info;
	h225_AltGKInfo;
	PER_Align;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Location_Request_LRQ;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	SBIT 1 d;
	SKIP 80000002;
	LABL 0 0 90 c2 Endpoint Identifier;
	BMPString;

	LABL 0 0 0 b7 Destination Info;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c2 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Reply Address;
	TransportAddress;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    5   2;
    PER_Seq_ExtBitMask;

    SBIT    5   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Source Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    4   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Can Map Alias:;
	PER_Boolean;
	PER_Align;

    SBIT    3   c;
    SKIP    80000002;        *not present
	LABL    0   0   90  c2  Gatekeeper Identifier;
	BMPString;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Location_Confirm_LCF;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	LABL 0 0 90 c7 Call Signal Address;
	TransportAddress;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 RAS Address;
	TransportAddress;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

   *+ extensions
    MOVE    8   2;
    PER_Seq_ExtBitMask;

    SBIT    8   c;
    SKIP    80000006;        *not present
    PER_ExtLen;
    LABL    0   0   0 b7  Destination Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 0 b8;

    SBIT    7   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Dest Extra Call Info;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    6   c;
    SKIP    80000003;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Destination Type;
	EndpointType;

    SBIT    5   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Remote Extension Address;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;

    SBIT    4   c;
    SKIP    80000005;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Alternate Endpoints;
	PER_Align;
	DBYT    1   8   5  5;  //SEQ OF Length
	SEQ OF h225_Endpoint;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Supports AnnexE Call Sig:;
	PER_Boolean;
	PER_Align;
    *- extensions

	PER_Align;
	TRTS;

void Location_Reject_LRJ;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	LABL 0 0 90 c2 Reject Reason;
	LocationRejectReason;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    3   2;
    PER_Seq_ExtBitMask;

    SBIT    3   c;
    SKIP    80000004;        *not present
	LABL    0   0   90  c2  Alt GK Info;
    PER_ExtLen;
	h225_AltGKInfo;
	PER_Align;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Disengage_Request_DRQ;
	PER_ExtBit;
	BBIT 1 d 5 5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;
	LABL 0 0 0 b7 Endpoint Identifier;
	BMPString;
	LABL 0 0 0 b8;
	PER_Align;
	LABL 10 0 90 c7 Conference Identifier:;
	h225::GloballyUniqueID;
	LABL 0 0 0 c8;
	
	DWRD 0 0 90 c2 Call Reference Value:;
	LABL 0 0 0 b7 Disengage Reason;
	DisengageReason;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    d   2;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000004;        *not present
	LABL    0   0   0 b7  Call Identifier;
    PER_ExtLen;
    h225_CallIdentifier;
	LABL 0 0 0 b8;
	
    SBIT    1   c;
    SKIP    80000004;        *not present
	LABL    0   0   0 b7  Gatekeeper Identifier;
    PER_ExtLen;
	CHR# 0 1 90 c2 BMPString Name:;
	LABL 0 0 0 b8;

    SBIT    2   c;
    SKIP    80000004;        *not present
	LABL 0 0 0 b7 Tokens;
    PER_ExtLen;
    h225::seq_of_ClearToken;
	LABL 0 0 0 b8;

    SBIT    3   c;
    SKIP    80000004;        *not present
	LABL 0 0 0 b7 Crypto Tokens Data;
    PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    4   c;
    SKIP    80000004;        *not present
	LABL 0 0 0 b7 Int Check Value;
    PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    5   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Answered Call:;
	PER_Boolean;
	PER_Align;

	SBIT	6	c;		//si: um, hopefully this is right
	SKIP 80000004;
	LABL 0 0 0 b7 Call Linkage;
	PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

    SBIT    7   c;
    SKIP    80000005;        *not present
	LABL 0 0 0 b7 Call Capacity;
    PER_ExtLen;
    DBIT    7   0   90  c2  Value:;
	PER_Align;
	LABL 0 0 0 b8;

	SBIT	8	c;		//si: um, hopefully this is right
	SKIP 80000004;
	LABL 0 0 0 b7 Circuit Info;
	PER_ExtLen;
    DUMP    0   1   90  c2  Data:;
	LABL 0 0 0 b8;

	SBIT	9	c;		
	SKIP 80000004;
	LABL 0 0 0 b7 RAS Usage Information;
	PER_ExtLen;
    h225_RASUsageInformation;
	LABL 0 0 0 b8;

	SBIT	a	c;		
	SKIP 80000004;
	LABL 0 0 0 b7 Termination Cause;
	PER_ExtLen;
    h225::CallTerminationCause;
	LABL 0 0 0 b8;

	SBIT	b	c;		
	SKIP 80000004;
	LABL 0 0 0 b7 Service Control;
	PER_ExtLen;
    h225::seq_of_ServiceControlSession;
	LABL 0 0 0 b8;

	SBIT	c	c;		
	SKIP 80000004;
	LABL 0 0 0 b7 Generic Data;
	PER_ExtLen;
    h225::seq_of_GenericData;
	LABL 0 0 0 b8;
			
	PER_Align;
	LABL 0 0 0 b8;

	TRTS;

void h225::CallTerminationCause()
{
	BBIT 1 41 5 5;	//ext bit
	
	if( l[1] == 0 )
	{
		BBIT 1 42 5 5;	//choice
		TSB# 0 42 0 0 h225::CallTerminationCause_Func;
		TRTS;
	}
	
	TRTS;	
}

str# h225::CallTerminationCause_Func;
	0	|	h225::ReleaseCompleteReason;
	1	|	h225::ReleaseCompleteCauseIE;
	
void h225::ReleaseCompleteReason()
{
	BBIT 1 41 5 5;	//ext bit
	
	if( l[1] == 0 )
	{
		DBIT 4 42 90 c2 Release Complete Reason:;	//choice
		CST# 0 42 0 14 h225::ReleaseCompleteReason_Choice_str;
		TRTS;
	}
	
	DBIT 7 42 90 c2 Release Complete Reason;	//choice extension
	l[2] += 12;
	CST# 0 42 0 14 h225::ReleaseCompleteReason_Choice_str;
	
	l[1] = g[1];
	PER_ExtLen;
	l[3] = g[1];
	
	TSB# 0 42 0 0 h225::ReleaseCompleteReason_Ext_Funcs;
	SKIP 1;
	DUMP 0 43 90 c2 Data;
	
	g[1] = l[1];
	TRTS;
}

void h225::ReleaseCompleteCauseIE()
{
	l[1] = g[8];
	g[8] = 31;	//32 -2 + 1
	PER_Constrained_Whole_Number;
	g[8] += 2;
	
	PER_Align;
	LABL 0 0 0 c7 Release Complete Cause IE;
	HEX# 0 8 90 c2 Cause:;
	LABL 0 0 0 c8;
	
	g[8] = l[1];
}

str# h225::ReleaseCompleteReason_Choice_str;
	0	|	no bandwidth;
	1	|	gatekeeper resources exhausted;
	2	|	unreachable destination;
	3	|	destination rejection;
	4	|	invalid revision;
	5	|	no permission;
	6	|	unreachable gatekeeper;
	7	|	gateway resources;
	8	|	bad format address;
	9	|	adaptive busy;
	10	|	in conf (called party busy);
	11	|	undefined reason;
	12	|	facility call deflection;
	13	|	security denied;
	14	|	called party not registered;
	15	|	caller not registered;
	16	|	new connection needed;
	17	|	non standard reason;
	18	|	replace with conference invite;
	19	|	generic data reason;
	20	|	needed feature not supported;
	21	|	tunnelled signalling rejected;
	22	|	invalid cid;
	23	|	security error;
	24	|	hop count exceeded;

str# h225::ReleaseCompleteReason_Ext_Funcs;
	17	|	NonStandardParameter;
	18	|	h225_ConferenceIdentifier;
	
void Disengage_Confirm_DCF;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Disengage_Reject_DRJ;
	PER_ExtBit;
	BBIT 1 d 5  5; //Options Bits
	ADDG 2 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
    PER_Integer65535;

	LABL 0 0 0 b7 Reject Reason;
	DisengageRejectReason;
	LABL 0 0 0 b8;

	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    3   2;
    PER_Seq_ExtBitMask;

	SNEQ 0 c;
	SKIP 2;
	PER_Align;
	TRTS;

	LABL 0 0 0 b7 Extensions;

    SBIT    3   c;
    SKIP    80000004;        *not present
	LABL    0   0   90  c2  Alt GK Info;
    PER_ExtLen;
	h225_AltGKInfo;
	PER_Align;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	LABL 0 0 0 b8;

	PER_Align;
	TRTS;

void Info_Request_IRQ;
	PER_ExtBit;
	BBIT 2 d 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;

	l[1] = g[8];
	g[8] = 65536;	//65535 - 0 + 1
	PER_Integer;	
	DGLB 0 8 90 c2 Call Reference Value:;
	g[8] = l[1];

	
	SBIT 1 d;
	SKIP 80000003;
	LABL 0 0 90 c2 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Reply Address;
	TransportAddress;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    4   2;
    PER_Seq_ExtBitMask;

    SBIT    4   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    h225_CallIdentifier;

    SBIT    3   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  UUIEs Requested;
    h225_UUIEsRequested;
	PER_Align;
    *- extensions
	PER_Align;

	TRTS;

void Info_Request_Response_IRR;
	PER_ExtBit;
	BBIT 3 d 5  5; //Options Bits
	ADDG 4 a;*track bits and offset for alignment;
	
	SBIT 2 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	LABL 0 0 90 c7 Endpoint Type;
	EndpointType;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Endpoint Identifier;
	BMPString;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 RAS Address;
	TransportAddress;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Call Signal Address;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF TransportAddress g8;
	LABL 0 0 00 c8;
	
	SBIT 1 d;
	SKIP 80000005;
	LABL 0 0 90 c7 Endpoint Alias;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF AliasAddress g8;
	LABL 0 0 00 c8;
	
	SBIT 0 d;
	SKIP 80000005;
	LABL 0 0 90 c7 Per Call Info;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF h225_perCallInfo;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    8   2;
    PER2_Seq_ExtBitMask;

    SBIT    0   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL 0 0 90 c7 Tokens;
    h225::seq_of_ClearToken;
    LABL 0 0 0 c8;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;

    SBIT    3   c;
    SKIP    80000004;        *not present
    PER_ExtLen;
    LABL    0   0   90  c2  Need Response:;
	PER_Boolean;
	PER_Align;
	
	SBIT	4	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL	0	0	0	c9 Capacity;
	DUMP	0	1	90	c2 Capacity Data:;
	LABL	0	0	0	c8;
	
	SBIT	5	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL	0	0	0	c9 IRR Status;
	DUMP	0	1	90	c2 IRR Status Data:;
	LABL	0	0	0	c8;
	
	SBIT	6	c;
	SKIP	80000004;
	PER_ExtLen;
	LABL	0	0	90	c2 Unsolicited:;
	PER_Boolean;
	PER_Align;
	
	SBIT	7	c;
	SKIP	80000007;
	PER_ExtLen;
	LABL	0	0	0	c7 Generic Data;
	l[1] = g[8];
	g[8] = 0;
	h225::seq_of_GenericData;
	g[8] = l[1];
	LABL	0	0	0	c8;
	
    *- extensions

	PER_Align;
	TRTS;

void Nonstandard_Message;
	PER_ExtBit;
	ADDG 1 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	*SBIT 2 d;
	*SKIP 80000002;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

    *+ extensions
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Unknown_Message_Response_XRS;
	PER_ExtBit;
	ADDG 1 a;		*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;

    *+ extensions
    MOVE    2   2;
    PER_Seq_ExtBitMask;

    SBIT    2   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Tokens Data:;

    SBIT    1   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Crypto Tokens Data:;

    SBIT    0   c;
    SKIP    80000002;        *not present
    PER_ExtLen;
    DUMP    0   1   90  c2  Int Check Value Data:;
    *- extensions

	PER_Align;
	TRTS;

void Request_In_Progress_RIP;
	PER_ExtBit;
	BBIT 4 d 5  5; //Options Bits
	ADDG 5 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	SBIT 3 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
    * OPTIONALs require H.235
	PER_Align;
	DWRD 0 0 90 c2 Delay:;
	PER_Align;
	TRTS;

void Resources_Available_Indicate_RAI;
	PER_ExtBit;
	BBIT 4 d 5  5; //Options Bits
	ADDG 5 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 3 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
	LABL 0 0 90 c7 Endpoint Identifier;
	BMPString;
	LABL 0 0 00 c8;
	
    LABL 0 0 90 c7 Protocols;
	PER_Align;
	DBYT 1 8 5  5;  //SEQ OF Length
	SEQ OF h225_SupportedProtocols;
	LABL 0 0 00 c8;
	
    LABL 0 0 90 c2 Almost Out Of Resources:;
	PER_Boolean;
    * OPTIONALs require H.235
	PER_Align;
	TRTS;

void Resources_Available_Confirm_RAC;
	PER_ExtBit;
	BBIT 4 d 5  5; //Options Bits
	ADDG 5 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;

	LABL 0 0 0 b7 Protocol Identifier;
	ObjectIdentifier_BER;
	LABL 0 0 0 b8;

	SBIT 3 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;
	
    * OPTIONALs require H.235
	TRTS;

void Info_Request_ACK_IACK;
	PER_ExtBit;
	BBIT 4 d 5  5; //Options Bits
	ADDG 5 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num;
	PER_Integer65535;
	
	SBIT 3 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
    LABL 0 0 00 c8;
    
    * OPTIONALs require H.235
	PER_Align;
	TRTS;

void Info_Request_NAK_INAK;
	PER_ExtBit;
	BBIT 5 d 5  5; //Options Bits
	ADDG 6 a;*track bits and offset for alignment;
	PER_Align;
	LABL 0 0 90 c2 Request Seq Num:;
	PER_Integer65535;
	
	SBIT 4 d;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
    LABL 0 0 00 c8;
    
    LABL 0 0 90 c2 NAK Reason;
    InfoRequestNakReason;
    SBIT 3 d;
    SKIP 80000002;
	LABL 0 0 90 c2 Alt GK Info;
	h225_AltGKInfo;
    * OPTIONALs require H.235
	PER_Align;
	TRTS;

void NonStandardIdentifier;
	BBIT 1 0 5  5; //Extension Bit
	DBIT 1 1 90 c2 Choice:;
	CEQU 0 1 90 14 Object;
	CEQU 1 1 90 14 H.221 Non Standard;
	ADDG 2 a; *track bits and offset for alignment;
	SEQU 0 1; *ObjectIdentifier_BER;
	SKIP 80000002;
	ObjectIdentifier_BER;
	TRTS;
	H221NonStandard;
	TRTS;

void TransportAddress;
	BBIT 1 1 5  5; //Extension Bit
	DBIT 3 11 90 c2 Choice:;
	CEQU 0 11 90 14 IP Address;
	CEQU 1 11 90 14 IP Source Route;
	CEQU 2 11 90 14 IPX Address;
	CEQU 3 11 90 14 IP6 Address;
	CEQU 4 11 90 14 Net Bios;
	CEQU 5 11 90 14 NSAP;
	CEQU 6 11 90 14 Non Standard Address;
	ADDG 4 a;*track bits and offset for alignment;
	PER_Align;
	SEQU 0 11; *ipAddress;
	SKIP 80000002;
	ipAddress;
	TRTS;
	SEQU 2 11; *ipxAddress;
	SKIP 80000001;
	ipxAddress;
	TRTS;

void ipxAddress;
    HEX# 6 0 90 c2 Node:;
    DLNG 0 0 90 c2 Network Number:;
	DWRD 0 0 90 c2 Port:;
	TRTS;
    
void ipAddress;
	IPLG 0 0 90 c2 IP:;

	* check for bad Q931 packet in TT3682
	SLTE 2 10;
	SKIP 2;
	INCR 1;
	TRTS;

	* SP: 09/17/2002 - We store the port in g30, we will reuse it to MARK the H.245 Address field of Q.931 messages
	* e.g SETUP, ALERTING, CONNECT, etc.
	DWRD 0 30 90 c2 Port:;
	TRTS;

void EndpointType;
	BBIT 1 41 5  5; //Extension Bit
	BBIT 6 42 5  5; //Options Bits
	ADDG 7 a;  *track bits and offset for alignment;
	
	SBIT 5 42;
	SKIP 80000003;
	LABL 0 0 90 c7 Non Standard Data;
	NonStandardParameter;
	LABL 0 0 00 c8;

	SBIT 4 42;
	SKIP 80000003;
	LABL 0 0 0 b7 Vendor;
	VendorIdentifier;
	LABL 0 0 0 b8;

	SBIT 3 42;
	SKIP 80000002;
	LABL 0 0 90 c2 Gatekeeper;
	h225_GatekeeperInfo;

	SBIT 2 42;
	SKIP 80000003;
	LABL 0 0 0 b7 Gateway;
	h225_GatewayInfo;
	LABL 0 0 0 b8;

	SBIT 1 42;
	SKIP 80000002;
	LABL 0 0 90 c2 MCU;
	h225_McuInfo;

	SBIT 0 42;
	SKIP 80000003;
	LABL 0 0 90 c7 Terminal;
	h225_TerminalInfo;
	LABL 0 0 00 c8;

	LABL 0 0 90 c2 MC:;
	PER_Boolean;
	LABL 0 0 90 c2 Undefined Node:;
	PER_Boolean;

    if( l[1] == 0 )
    {
		TRTS;
    }

	g[2] = 2;
	PER2_Seq_ExtBitMask;
	
	SBIT 0	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 Set Data:;
	
	SBIT 1	c;
	SKIP	80000002;
	PER_ExtLen;
	DUMP 0 1 90 c2 Tunnelled Protocols Data:;
	
	TRTS;


void ObjectIdentifier_BER;
* SP: 09/15/2002 - the OID is octet-aligned, so we need to position after the padding bits Info_Request_Response_IRRif any)
	PER_Align;

	MOVE 8 91;  *save g8 in g11
	DBYT 0 2 90 c2 Length:;
	LABL 0 0 90 c2 OID:;
	ASN1_OID;
	MOVE b 88;  * restore g11 into g8
	TRTS;

void NonStandardParameter;
	LABL 0 0 90 c7 Non Standard Identifier;
	NonStandardIdentifier;
	LABL 0 0 00 c8;
	DBYT 1 1 90 c2 Length:;
	CHR# 0 1 90 c2 Data:;
	TRTS;

void H221NonStandard;
	BBIT 1 1 5  5; //Extension Bit
	ADDG 1 a;*track bits and offset for alignment;
	PER_Align;
	DBYT 1 41 90 c2 T.35 Country Code:;
    CST# 0 41 0 24 T35 Country Code;
	DBYT 1 0 90 c2 T.35 Extension:;
	DWRD 2 0 90 c2 Manufacturer Code:;
	TRTS;

void VendorIdentifier;
	BBIT 1 1 5  5; //Extension Bit
	BBIT 2 2 5  5; //Options Bits
	ADDG 3 a;*track bits and offset for alignment;
	LABL 0 0 0 b7 Vendor;
	H221NonStandard;
	SBIT 1 2;
	SKIP 80000003;
	DBYT 0 3 90 c2 Length:;
	ADDG 1 3;
	CHR# 0 3 90 c2 Product Id:;
	SBIT 0 2;
	SKIP 80000003;
	DBYT 0 3 90 c2 Length:;
	ADDG 1 3;
	CHR# 0 3 90 c2 Version Id:;
	LABL 0 0 0 b8;
	TRTS;


void BMPString8; *Info_Request_Response_IRR1..256)
	PER_Align;
	DBYT 1 1 5 5; //BMPString Length
	ADDG 1 1;
	MULG 2 1;
	CHR# 0 1 90 c2 BMPString Name:;
	TRTS;

void BMPString; *Info_Request_Response_IRR1..128) 7 bits for length
	DBIT 7 1 5 5; //BMPString Length
    ADDG 7 a;
	PER_Align;
	ADDG 1 1;
	MULG 2 1;
	CHR# 0 1 90 c2 BMPString Name:;
	TRTS;

void QseriesOptions;
	BBIT 1 1 5  5; //Extension Bit
	ADDG 1 a;*track bits and offset for alignment;
	LABL 0 0 90 c2 Q.932 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.951 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.952 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.953 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.955 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.956 Full:;
	PER_Boolean;
	LABL 0 0 90 c2 Q.957 Full:;
	PER_Boolean;
	TRTS;

void Q954Details;
	BBIT 1 1 5  5; //Extension Bit
	ADDG 1 a;*track bits and offset for alignment;
	LABL 0 0 90 c2 Conference Calling:;
	PER_Boolean;
	LABL 0 0 90 c2 Three Party Service:;
	PER_Boolean;
	TRTS;

void GatekeeperRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_GatekeeperRejectReason_base;
    ADDG    3   a;			*track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_GatekeeperRejectReason_ext;
    INCR    0   2;			*ext length;
    TRTS;

void RegistrationRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    3   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_RegistrationRejectReason_base;
    ADDG    4   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_RegistrationRejectReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;

void UnregRequestReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    4;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_UnregRequestReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;

void UnregRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_UnregRejectReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_UnregRejectReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;

void CallType;
	BBIT 1 1 5  5; //Extension Bit
	DBIT 2 2 90 c2 Call Type:;
	ADDG 3 a;*track bits and offset for alignment;
	CEQU 0 2 90 14 Point To Point;
	CEQU 1 2 90 14 One To N;
	CEQU 2 2 90 14 N To One;
	CEQU 3 2 90 14 N To N;
	TRTS;

void CallModel;
	BBIT 1 1 5  5; //Extension Bit
	DBIT 1 2 90 c2 Call Model:;
	ADDG 2 a;*track bits and offset for alignment;
	CEQU 0 2 90 14 Direct;
	CEQU 1 2 90 14 Gatekeeper Routed;
	TRTS;

void AdmissionRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    3   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_AdmissionRejectReason_base;
    ADDG    4   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_AdmissionRejectReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;

void BandRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_BandRejectReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_BandRejectReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;

void LocationRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_LocationRejectReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;
    
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c7  Reason;
    CST#    0   1   0   14  h225_LocationRejectReason_ext;
    INCR    0   2   0   0   ext length;
	LABL	0	0	0	c8;
    TRTS;

void DisengageReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    4;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_DisengageReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;

void DisengageRejectReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    5;
    DBIT    1   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_DisengageRejectReason_base;
    ADDG    2   a;          *track bits and offset for alignment;
    TRTS;
    DBIT    7   1   90  c2  Choice Ext Index:;
	PER_Align;
    DBYT    0   2   5  5; //   Ext Length
    ADDG    1   1;   
    LABL    0   0   90  c2  Reason:;
    CST#    0   1   0   14  h225_DisengageRejectReason_ext;
    INCR    0   2   0   0   ext length;
    TRTS;

void InfoRequestNakReason;
	BBIT    1   2   5  5; //Extension Bit
    SNEQ    0   2;
    SKIP    4;
    DBIT    2   1   90  c2  Reason:;
    ADDG    1   1;   
	CST#    0   1   0   14  h225_InfoRequestNakReason_base;
    ADDG    3   a;          *track bits and offset for alignment;
    TRTS;

void h225_CallCreditCapability()
{
	BBIT	1	41	5	5;	//Extension Bit
	BBIT	2	42	5	5;	//Optional Components
	
	SBIT	1	42;
	SKIP	80000002;
	LABL	0	0	90	c2 Can Display Amount String:;
	PER_Boolean;
	
	SBIT	0	42;
	SKIP	80000002;
	LABL	0	0	90	c2 Can Enforce Duration Limit:;
	PER_Boolean;
}

void h225_RasUsageInfoTypes()
{
	BBIT	1	41	5	5;	//Extension Bit
	BBIT	3	42	5	5;	//Optional Components
	
	l[3] = g[8];
	PER_SeqLen_Unconstrained;
	l[4] = g[8];
	g[8] = l[3];
	
	LABL	0	0	0	b7	NonStandard Usage Types;
	DGLB	0	44	90	c2	Count:;

	while( l[4] > 0 )
	{
		//nonstandardparameter
		LABL	0	0	0	b7	NonStandard Parameter;
		NonStandardParameter;
		LABL	0	0	0	b8;
		l[4] -= 1;
	}
	
	LABL	0	0	0	b8;
		
	SBIT	2	42;
	SKIP	80000002;
	LABL	0	0	90	c2 startTime;
	LABL	0	0	0	14	NULL;
	
	SBIT	1	42;
	SKIP	80000002;
	LABL	0	0	90	c2 endTime;
	LABL	0	0	0	14	NULL;
	
	SBIT	0	42;
	SKIP	80000002;
	LABL	0	0	90	c2 terminationCause;
	LABL	0	0	0	14	NULL;	
}

str# Q931 Proto Descriminators;
	User-Specific;
	OSI High Layer;
	Recommendation X.244;
	Reserved - System Management Convergence;
	IA5 Characters;
	X.208 & X.209 Coded User Information;
	Undefined;
	Recommendation V.120 Rate Adoption;
	Q.931/I.451 User-Network Call Control;
	Q.2931 User-Network Call Control;

str# Q931 Msg Categories;
	Call Establishment Message;
	Call Information Phase Message;
	Call Clearing Message;
	Miscellaneous Call Message;

str# Q931 CEM Types;
	Specified Nationally;
	Alerting;
	Call Proceeding;
	Progress;
	;
	Setup;
	;
	Connect;
	;
	;
	;
	;
	;
	Setup Acknowledge;
	;
	Connect Acknowledge;

str# Q931 CIPM Types;
	User Information;
	Suspend Reject;
	Resume Reject;
	;
	Hold;
	Suspend;
	Resume;
	;
	Hold Acknowledge;
	;
	;
	;
	;
	Suspend Acknowledge;
	Resume Acknowledge;
    ;
    Hold Reject;
    Retrieve;
    ;
    Retrieve Acknowledge;
    ;
    ;
    ;
    Retrieve Reject;

str# Q931 CCM Types;
	;
	;
	;
	;
	;
	Disconnect;
	Restart;
	;
	;
	;
	;
	;
	;
	Release;
	Restart Acknowledge;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	Release Complete;

str# Q931 MCM Types;
	Segment;
	;
	Facility;
	;
	Register;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	Notify;
	;
	;
	;
	;
	;
	;
	Status Enquiry;
	;
	;
	;
	Congestion Control;
	;
	Information;
	;
	Status;

str# Q931 VElem Types;
	Segmented Message ;
	;
	;
	;
	Bearer Capability ;
	;
	;
	;
	Q.850 Cause ;
	;
	;
	;
	;
	Extended Facility;
	;
	;
	Call Identity ;
	;
	;
	;
	Call State ;
	;
	;
	;
	Channel Identification ;
	;
	;
	;
	Facility;
	;
	Progress Indicator ;
	;
	Network-specific Facilities ;
	;
	;
	;
	;
	;
	;
	Notification Indicator ;
	Display ;
	Date/Time;
	;
	;
	Keypad Facility ;
	;
	;
	;
	;
	;
	Information Request;
	;
	Signal ;
	;
	;
	;
	Feature Activation;
	Feature Indication;
	Service Profile Identification;
	Endpoint Identifier;
	;
	;
	;
	;
	Information Rate ;
	;
	End-to-end Transit Delay ;
	Transit Delay Selection and Indication ;
	Packet Layer Binary Parameters ;
	Packet Layer Window Size ;
	Packet Size ;
	Closed User Group ;
	;
	;
	Reverse Charging Indication ;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	Calling Party Number ;
	Calling Party Subaddress ;
	;
	;
	Called Party Number ;
	Called Party Subaddress ;
	;
	;
	Redirecting Number ;
	;
	Redirection Number ;
	;
	Transit Network Selection ;
	Restart Indicator ;
	;
	;
	Low Layer Compatibility ;
	High Layer Compatibility ;
	User-user ;
	Escape For Extension ;

str# Q931 SOIEF Types;
	Reserved;
	Shift;
	;
	Congestion Level;
	;
	Repeat Indicator;

str# Q931 Coding Standard Types;
	ITU-T;
	ISO/IEC;
	National Standard;
	Local Standard;

str# Q931 Info Xfer Cap Types;
	Speech;
	;
	;
	;
	;
	;
	;
	;
	Unrestricted Digital Information;
	Restricted Digital Information;
	;
	;
	;
	;
	;
	;
	3.1 kHz Radio;
	Unrestricted Digital Information with Tones/Announcements;
	;
	;
	;
	;
	;
	;
	Video;

str# Q931 Xfer Mode Types;
	Circuit Mode;
	;
	Packet Mode;
	;

str# Q931 Xfer Rate Types;
	Packet Mode;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	64 kbit/sec;
	2 x 64 kbit/sec;
	;
	384 kbit/sec;
	;
	1536 kbit/sec;
	;
	1920 kbit/sec;
	Multirate (64 kbit/sec base rate);

str# Q931 User Info Proto Types;
	ITU-T Standardized V.110, I.460 and X.30;
	;
	G.711 u-law;
	G.711 A-law;
	G.721 23kbits/sec ADPCM;
	H.221 and H.242;
	H.223 and H.245;
	Non-ITU-T;
	ITU-T Standardized V.120;
	ITU-T Standardized X.31;

str# Q931 Proto Descr Types;
	User Specific;
	OSI High Layer;
	X.244;
	System Management Convergence Function;
	IA5 Characters;
	X.208 and X.209;
	;
	V.120 Rate Adaption;
	Q.931/I.451 User Network Call Control Messages;

str# Q931 Type of Number Types;
	Unknown;
	International;
	National;
	Network Specific;
	Subscriber;
	Reserved;
	Abbreviated;
	Reserved for Extension;

str# Q931 Num Plan ID Types;
	Unknown;
	ISDN/Telephony (E.164);
	;
	Data (X.121);
	Telex (F.69);
	;
	;
	;
	National Standard;
	Private;
	;
	;
	;
	;
	;
	Reserved for Extension;

str# Q931 Type of Subaddress Types;
	NSAP (X.213) abd ISO/IEC 8348 Add.2;
	;
	User Specified;

str# Q931 Notif Indicator Types;
	User Suspended;
	User Resumed;
	Bearer Service Change;
    Discriminator For Extension To ASN.1;
    Call Completion Delay;

str# Q931 Prog Descr Types;
	;
	Call is not end-to-end ISDN;
	Destination Address is non-ISDN;
	Origination Address is non-ISDN;
	Call has returned to the ISDN;
	Interworking has occurred and has resulted in a telecommunications service change;
	;
	;
	In-band information or an appropriate pattern is now available;
str# Q931 Signal Types;
	Dial Tone Is On;
	Ring Back Tone Is On;
	Intercept Tone Is On;
	Network Congestion Tone Is On;
	Busy Tone On;
	Confirm Tone On;
	Answer Tone On;
	Call Waiting Tone On;
	Off-Hook Warning Tone On;
	Pre-emption Tone On;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	Tones Off;
	Alerting On - Pattern;
	Alerting On - Pattern 1;
	Alerting On - Pattern 2;
	Alerting On - Pattern 3;
	Alerting On - Pattern 4;
	Alerting On - Pattern 5;
	Alerting On - Pattern 6;
	Alerting On - Pattern 7;
	;
	;
	;
	;
	;
	;
	;
	Alerting Off;

str# RAS Message Types;
	Gatekeeper Request (GRQ);
	Gatekeeper Confirm (GCF);
	Gatekeeper Reject (GRJ);
	Registration Request (RRQ);
	Registration Confirm (RCF);
	Registration Reject (RRJ);
	UnRegistration Request (URQ);
	UnRegistration Confirm (UCF);
	UnRegistration Reject (URJ);
	Admission Request (ARQ);
	Admission Confirm (ACF);
	Admission Reject (ARJ);
	Bandwidth Request (BRQ);
	Bandwidth Confirm (BCF);
	Bandwidth Reject (BRJ);
	Disengage_Request (DRQ);
	Disengage_Confirm (DCF);
	Disengage_Reject (DRJ);
	Location Request (LRQ);
	Location Confirm (LCF);
	Location_Reject (LRJ);
	Info_Request (IRQ);
	Info_Request_Response (IRR);
	Nonstandard Message ();
	Unknown Message Response (XRS);

str# RAS Message Types Funcs;
	Gatekeeper_Request_GRQ;
	Gatekeeper_Confirm_GCF;
	Gatekeeper_Reject_GRJ;
	Registration_Request_RRQ;
	Registration_Confirm_RCF;
	Registration_Reject_RRJ;
	UnRegistration_Request_URQ;
	UnRegistration_Confirm_UCF;
	UnRegistration_Reject_URJ;
	Admission_Request_ARQ;
	Admission_Confirm_ACF;
	Admission_Reject_ARJ;
	Bandwidth_Request_BRQ;
	Bandwidth_Confirm_BCF;
	Bandwidth_Reject_BRJ;
	Disengage_Request_DRQ;
	Disengage_Confirm_DCF;
	Disengage_Reject_DRJ;
	Location_Request_LRQ;
	Location_Confirm_LCF;
	Location_Reject_LRJ;
	Info_Request_IRQ;
	Info_Request_Response_IRR;
	Nonstandard_Message;
	Unknown_Message_Response_XRS;
	
str# RAS Message Types Extensions;
	Request In Progress (RIP);
	Resources Available Indicate (RAI);
	Resources Available Confirm (RAC);
	Info Request ACK (IACK);
	Info Request NAK (INAK);

str# RAS Message Types Extensions Funcs;
	Request_In_Progress_RIP;
	Resources_Available_Indicate_RAI;
	Resources_Available_Confirm_RAC;
	Info_Request_ACK_IACK;
	Info_Request_NAK_INAK;
	
str# Q850 Location Types;
	User;
	Local Private Network (LPN);
	Local Public Network (LN);
	Transit Network (TN);
	Remote User Public Network (RLN);
	Remote User Private Network (RPN);
	;
	International Network (INTL);
	;
	;
	Network Beyond Internetworking Point (BI);

str# Q850 Recommendation Types;
	Q.931;
	;
	;
	X.21;
	X.25;
	Q.1031/Q.1051;

str# Q850 Cause Class Types;
	Normal Event;
	Normal Event;
	Resource Unavailable;
	Service or Option Not Available;
	Service or Option Not Implemented;
	Invalid Message;
	Protocol Error;
	Interworking;

str# Q850 Cause Value Types;
	;
	Unallocated Number;
	No Route to Specified Transit Network;
	No Route to Destination;
	Send Special Information Tone;
	Misdialed Trunk Prefix;
	Channel Unacceptable;
	Call Awarded and Being Delivered in Established Channel;
	Preemption;
	Preemption - Circuit Reserved for Reuse;
	;
	;
	;
	;
	;
	;
	Normal Call Clearing;
	User Busy;
	No User Responding;
	No Answer from User (User Alerted);
	Subscriber Absent;
	Call Rejected;
	Number Changed;
	Redirection to New Destination;
	;
	Exchange Routing Error;
	Non-selected User Clearing;
	Destination Out of Order;
	Invalid Number Format (Address Incomplete);
	Facility Rejected;
	Response to STATUS ENQUIRY;
	Normal, unspecified;
	;
	;
	No Circuit/Channel Available;
	;
	;
	;
	Network Out of Order;
	Permanent Frame Mode Connection Out of Service;
	Permanent Frame Mode Connection Operational;
	Temporary Failure;
	Switching Equipment Congestion;
	Access Information Discarded;
	Requested Circuit/Channel Not Available;
	;
	Precedence Call Blocked;
	Resource Unavailable;
	;
	Quality of Service Not Available;
	Requested Facility Not Subscribed;
	;
	;
	Outgoing Calls Barred within CUG;
	;
	Incoming Calls Barred within CUG;
	;
	Bearer Capability Not Authorized;
	Bearer Capability Not Presently Available;
	;
	;
	;
	Inconsistency in Designated Outgoing Access Info and Subscriber Class;
	Service or Option Not Available, Unspecified;
	;
	Bearer Capability Not Implemented;
	Channel Type Not Implemented;
	;
	;
	Requested Facility Not Implemented;
	Only Restricted Digital Info Bearer Capability Is Available;
	;
	;
	;
	;
	;
	;
	;
	;
	Service or Option Not Implemented, Unspecified;
	;
	Invalid Call Reference Value;
	Identified Channel Does Not Exist;
	A Suspended Call Exists, But This Call Identity Does Not;
	Call Identity In Use;
	No Call Suspended;
	Call Having Requested Call Identity Has Been Cleared;
	User Not Member of CUG;
	Incompatible Destination;
	;
	Non-existent CUG;
	Invalid Transit Network Selection;
	;
	;
	;
	Invalid Message, Unspecified;
	Mandatory Information Element Is Missing;
	Message Type Non-Existent or Not Implemented;
	Message Not Compatible With Call State or Message Type Non-Existent pr Not Implemented;
	Information Element/Parameter Non-Existent or Not Implemented;
	Invalid Information Element Contents;
	Message Not Compatible With Call State;
	Recovery On Timer Expiry;
	Parameter Non-Existent or Not Implemented, Passed On;
	;
	;
	;
	;
	;
	;
	Message with Unrecognized Parameter, Discarded;
	Protocol Error, Unspecified;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	;
	Interworking, Unspecified;

*--------------------------------------------------------------------
* Q932 - Supplementary Services and Q95x 
* Specifications: ITU-T Q.932, Q.950, Q.952, Q.956 and Q.957
*--------------------------------------------------------------------
void Q931 Facility;*gi=6 (IE length)
    BBIT    3   0   5   5   ;* skip first 3 bits
    BBIT    5   11  b0  c2  Protocol Profile:;
    CST#    10  11  0   14  Q932 Protocol Profile;
    SUBG    1   6   0   0   ;
    
    SEQU    11  11  0   0   ;
    SKIP    2   0   0   0   ;
	DUMP    0   6   b0  c2  PDU Data:;
	TNXT    0   0   0   0   Q931 Info Elem;

    MOVE    0   6   0   0   ;*consume g6 IE length

    HBYT    0   11  b0  c2  Component:;
    CST#    A0  11  0   14  Q932 Component;
    DBYT    0   1   b0  c2  Length;
    
    SNEQ    A1  11  0   0   ;
    SKIP    2   0   0   0   ;
    Q932 InvokeComponent;
	TNXT    0   0   0   0   Q931 Info Elem;

    SNEQ    A2  11  0   0   ;
    SKIP    2   0   0   0   ;
    Q932 ReturnResultComponent;
	TNXT    0   0   0   0   Q931 Info Elem;

    SNEQ    A3  11  0   0   ;
    SKIP    2   0   0   0   ;
    Q932 ReturnErrorComponent;
	TNXT    0   0   0   0   Q931 Info Elem;

    SNEQ    A4  11  0   0   ;
    SKIP    2   0   0   0   ;
    Q932 RejectComponent;
	TNXT    0   0   0   0   Q931 Info Elem;

	TNXT    0   0   0   0   Q931 Info Elem;


void Q932 InvokeComponent;
    LABL    0   0   0   c7  Invoke Id:;
    Q932 InvokeIdentifierType;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    80  1   0   0   ;
    SKIP    3;
    LABL    0   0   0   c7  Linked Id:;
    Q932 InvokeIdentifierType;
    LABL    0   0   0   c8  ;

    Q932 OPERATION;

    TSB#    0   1   0   0   Q932 Invoke Operation;

    TRTS;

void Q932 ReturnResultComponent;
    LABL    0   0   0   c7  Invoke Id:;
    Q932 InvokeIdentifierType;
    LABL    0   0   0   c8  ;

    Q932 OPERATION;

    TSB#    0   1   0   0   Q932 Result Operation;

    TRTS;

void Q932 ReturnErrorComponent;
    LABL    0   0   0   c7  Invoke Id:;
    Q932 InvokeIdentifierType;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Error Value;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Error Value:;
    CST#    0   1   0   14  Q932 Error;
    LABL    0   0   0   c8  ;

    TRTS;

void Q932 RejectComponent;
    LABL    0   0   0   c7  Invoke Id:;
    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;
    SKIP    6;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  None;
    MOVE    0   2   0   0   ;
    SEQU    0   2   0   0   ;*force SKIP
    SKIP    1;
    Q932 InvokeIdentifierType;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Problem;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    80  11  0   0   ;
    SKIP    4;
    DBYT    0   1   b0  c2  General Problem:;
    CST# ffffffff 1 0   14  Q932 GeneralProblem;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;
    SKIP    4;
    DBYT    0   1   b0  c2  Invoke Problem:;
    CST# ffffffff 1 0   14  Q932 InvokeProblem;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    82  11  0   0   ;
    SKIP    4;
    DBYT    0   1   b0  c2  Return Result Problem:;
    CST# ffffffff 1 0   14  Q932 ReturnResultProblem;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    83  11  0   0   ;
    SKIP    4;
    DBYT    0   1   b0  c2  Return Error Problem:;
    CST# ffffffff 1 0   14  Q932 ReturnErrorProblem;
    LABL    0   0   0   c8  ;
    TRTS;

    TRTS;

void Q932 Invoke ExplicitReservationCreationControl;
    GBYT    0   1   0   0   ;
    SEQU    a   1   0   0   ;*ENUMERATED
    SKIP    1;
    TRTS;

    LABL    0   0   0   c7  Control Option;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Control Option Value:;
    CST# ffffffff 1 0   14  Q932 ControlOption;
    LABL    0   0   0   c8  ;
    TRTS;

void Q932 Result ExplicitReservationCreationControl;
    GBYT    0   1   0   0   ;
    SNEQ    2   1   0   0   ;*INTEGER
    SKIP    1;
    Q932 ReservationIndicator;
    TRTS;

void Q932 Invoke ExplicitReservationManagement;
    GBYT    0   1   0   0   ;
    SNEQ    2   1   0   0   ;*INTEGER
    SKIP    1;
    Q932 ReservationIndicator;
    TRTS;

void Q932 Invoke ExplicitReservationCancel;
    GBYT    0   1   0   0   ;
    SNEQ    2   1   0   0   ;*INTEGER
    SKIP    1;
    Q932 ReservationIndicator;
    TRTS;

void Q932 ReservationIndicator;
    LABL    0   0   0   c7  Reservation Indicator;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT 80000000 1 b0  c2  Reservation Indicator:;*(-128..127)
    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PresentedAddressScreened;
    LABL    0   0   0   c7  Presented Address Screened;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    A0  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Allowed Address;
    Q932 AddressScreened;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Presentation Restricted;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    82  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Number Not Available Due To Interworking;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A3  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Restricted Address:;
    Q932 AddressScreened;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PresentedAddressUnscreened;
    LABL    0   0   0   c7  Presented Address Unscreened;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    A0  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Allowed Address;
    Q932 Address;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Presentation Restricted;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    82  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Number Not Available Due To Interworking;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A3  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Restricted Address:;
    Q932 Address;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PresentedNumberScreened;
    LABL    0   0   0   c7  Presented Number Screened;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    A0  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Allowed Number;
    Q932 NumberScreened;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Presentation Restricted;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    82  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Number Not Available Due To Interworking;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A3  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Restricted Number:;
    Q932 NumberScreened;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c7  Presented Number Unscreened;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    A0  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Allowed Number;
    Q932 PartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Presentation Restricted;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    82  11  0   0   ;
    SKIP    3;
    LABL    0   0   b0  c2  Number Not Available Due To Interworking;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A3  11  0   0   ;
    SKIP    4;
    LABL    0   0   b0  c2  Presentation Restricted Number;
    Q932 PartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 AddressScreened;
    LABL    0   0   0   c7  Address;

    Q932 PartyNumber;

    Q932 ScreeningIndicator;

    GBYT    0   1   0   0   ;
    SEQU    30  1   0   0   ;*SEQUENCE
    SKIP    2;
    SNEQ    4   1   0   0   ;*OCTET STRING
    SKIP    1;
    Q932 PartySubaddress;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 NumberScreened;
    LABL    0   0   0   c7  Address;

    Q932 PartyNumber;

    Q932 ScreeningIndicator;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 Address;*gu=12(len),13(rem)
    LABL    0   0   0   c7  Address;
    BER Tag;
    DBYT    0   12  b0  c2  Length:;
    BREM    0   13;         

    Q932 PartyNumber;

    * check if bytesleft in current SEQUENCE
    BREM    0   1   0   0   ;
    SUBG    1   93  0   0   ;*bytesused
    SUBG    13  92  0   0   ;*bytesleft
    SGTE    0   12  0   0   ;*0 >= bytesleft
    SKIP    80000002;
    LABL    0   0   0   c8  ;
    TRTS;
    
    BREM    0   13;
    Q932 PartySubaddress;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PartyNumber;
    LABL    0   0   0   c7  Party Number;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    80  11  0   0   ;
    SKIP    3;
    HEX#    0   1   b0  c2  Unknown Party Number:;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A1  11  0   0   ;
    SKIP    3;
    Q932 PublicPartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    83  11  0   0   ;
    SKIP    3;
    HEX#    0   1   b0  c2  Data Party Number:;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    84  11  0   0   ;
    SKIP    3;
    HEX#    0   1   b0  c2  Telex Party Number:;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    A5  11  0   0   ;
    SKIP    3;
    Q932 PrivatePartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    88  11  0   0   ;
    SKIP    3;
    HEX#    0   1   b0  c2  National Standard Party Number:;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PublicPartyNumber;
    LABL    0   0   0   c7  Public Party Number;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    
    LABL    0   0   0   c7  Public Type Of Number;
    DBYT    0   1   b0  c2  Public Type Of Number:;
    CST# ffffffff 1 0   14  Q932 PublicTypeOfNumber;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Number Digits;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  Number Digits:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PrivatePartyNumber;
    LABL    0   0   0   c7  Private Party Number;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    
    LABL    0   0   0   c7  Private Type Of Number;
    DBYT    0   1   b0  c2  Private Type Of Number:;
    CST# ffffffff 1 0   14  Q932 PrivateTypeOfNumber;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Number Digits;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  Number Digits:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 PartySubaddress;
    LABL    0   0   0   c7  Party Subaddress;
    GBYT    0   1   0   0   ;
    SNEQ    30  1   0   0   ;*SEQUENCE
    SKIP    3;
    Q932 UserSpecifiedSubaddress;
    LABL    0   0   0   c8  ;
    TRTS;
    SEQU    4   1   0   0   ;*OCTET STRING
    SKIP    2;   
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c7  NSAP Subaddress;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  NSAP SubAddress:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 UserSpecifiedSubaddress;*g31,32
    LABL    0   0   0   c7  User Specified Subaddress;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    LABL    0   0   0   c7  Subaddress Information;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  Sub Address:;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SEQU    1   1   0   0   ;*BOOLEAN
    SKIP    2;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c7  Odd Count Indicator;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   0   b0  c2  Odd Count Indicator Value:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q932 ScreeningIndicator;
    LABL    0   0   0   c7  Screening Indicator;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Screening Indicator:;
    CST# ffffffff 1 0   14  Q932 ScreeningIndicator_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q932 InvokeIdentifierType;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Invoke Identifier:;
    TRTS;

void Q932 OPERATION;
    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;*Operation value type == INTEGER ?
    SKIP    1;
    TRTS;
    LABL    0   0   0   c7  Operation Value;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Operation:;
    CST#    0   1   0   14  Q932 Operation Str;
    LABL    0   0   0   c8  ;
    TRTS;

str# Q932 Protocol Profile;
    Remote Operations Protocol (ROSE);
    CMIP Protocol;
    ACSE Protocol;

str# Q932 Component;
    Invoke;
    Return Result;
    Return Error;
    Reject;

str# Q932 Operation Str;
    UserUserService;*1
    ;
    ;
    ;
    ;
    ;
    ActivationDiversionType;*7
    DeactivationDiversionType;*8
    ActivationStatusNotificationDivType;*9
    DeactivationStatusNotificationDivType;*10
    InterrogationDiversionType;*11
    DiversionInformationType;*12
    CallDeflectionType;*13
    CallReroutingType;*14
    DivertingLegInformation2Type;*15
    InvokeStatusType;*16
    InterrogationDiversion1Type;*17
    DivertingLegInformation1Type;*18
    DivertingLegInformation3Type;*19
    ExplicitReservationCreationControl;*20
    ExplicitReservationManagement;*21
    ExplicitReservationCancel;*22
    ;
    ;
    ;
    ;*26
    ;
    ;
    ;
    ChargingRequest;*30
    AOCSCurrency;*31
    AOCSSpecialArr;*32
    AOCDCurrency;*33
    AOCDChargingUnit;*34
    AOCECurrency;*35
    AOCEChargingUnit;*36
    IdentificationOfCharge;*37
    ;
    ;
    ;*40
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;*50
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    RequestREV;*60
    REVIndication;*61
    REV-T-Status;*62


str# Q932 Invoke Operation;
    Q957 Invoke UserUserService;*1
    ;
    ;
    ;
    ;
    ;
    Q952 Invoke ActivationDiversionType;*7
    Q952 Invoke DeactivationDiversionType;*8
    Q952 Invoke ActivationStatusNotificationDivType;*9
    Q952 Invoke DeactivationStatusNotificationDivType;*10
    Q952 Invoke InterrogationDiversionType;*11
    Q952 Invoke DiversionInformationType;*12
    Q952 Invoke CallDeflectionType;*13
    Q952 Invoke CallReroutingType;*14
    Q952 Invoke DivertingLegInformation2Type;*15
    Q952 Invoke InvokeStatusType;*16
    ;*InterrogationDiversion1Type;*17
    Q952 Invoke DivertingLegInformation1Type;*18
    Q952 Invoke DivertingLegInformation3Type;*19
    Q932 Invoke ExplicitReservationCreationControl;*20
    Q932 Invoke ExplicitReservationManagement;*21
    Q932 Invoke ExplicitReservationCancel;*22
    ;
    ;
    ;
    ;*26
    ;
    ;
    ;
    Q956 Invoke ChargingRequest;*30
    Q956 Invoke AOCSCurrency;*31
    Q956 Invoke AOCSSpecialArr;*32
    Q956 Invoke AOCDCurrency;*33
    Q956 Invoke AOCDChargingUnit;*34
    Q956 Invoke AOCECurrency;*35
    Q956 Invoke AOCEChargingUnit;*36
    Q956 Invoke IdentificationOfCharge;*37
    ;
    ;
    ;*40
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;*50
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    Q956 Invoke RequestREV;*60
    ;*REVIndication;*61
    Q956 Invoke REV-T-Status;*62

str# Q932 Result Operation;
    Dummy;*UserUserService;*1 (does not work if left empty)
    ;
    ;
    ;
    ;
    ;
    ;*ActivationDiversionType;*7
    ;*DeactivationDiversionType;*8
    ;*ActivationStatusNotificationDivType;*9
    ;*DeactivationStatusNotificationDivType;*10
    Q952 Result InterrogationDiversionType;*11
    ;*DiversionInformationType;*12
    ;*CallDeflectionType;*13
    ;*CallReroutingType;*14
    ;*DivertingLegInformation2Type;*15
    ;*InvokeStatusType;*16
    Q952 Result InterrogationDiversion1Type;*17
    ;*DivertingLegInformation1Type;*18
    ;*DivertingLegInformation3Type;*19
    Q932 Result ExplicitReservationCreationControl;*20
    ;*ExplicitReservationManagement;*21
    ;*ExplicitReservationCancel;*22
    ;
    ;
    ;
    ;*26
    ;
    ;
    ;
    Q956 Result ChargingRequest;*30
    ;*AOCSCurrency;*31
    ;*AOCSSpecialArr;*32
    ;*AOCDCurrency;*33
    ;*AOCDChargingUnit;*34
    ;*AOCECurrency;*35
    ;*AOCEChargingUnit;*36
    ;*IdentificationOfCharge;*37
    ;
    ;
    ;*40
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;*50
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    ;*RequestREV;*60
    ;*REVIndication;*61
    ;*REV-T-Status;*62


str# Q932 ControlOption;
    NoReservationRequired;
    ReservationRequiredWithReservationIndicator;
    ReservationRequiredWithoutReservationIndicator;
    
str# Q932 GeneralProblem;
    UnrecognizedComponent;
    MistypedComponent;
    BadlyStructuredComponent;

str# Q932 InvokeProblem;
    Duplicatelnvocation;
    UnrecognizedOperation;
    MistypedArgument;
    ResourceLimitation;
    InitiatorReleasing;
    UnrecognizedLinkedld;
    LinkedResponseUnexpected;
    UnexpectedChildOperation;

str# Q932 ReturnResultProblem;
    Unrecognizedlnvocation;
    ResultResponseUnexpected;
    MistypedResult;

str# Q932 ReturnErrorProblem;
    UnrecognizedInvocation;
    ErrorResponseUnexpected;
    UnrecognizedError;
    UnexpectedError;
    MistypedParameter;

str# Q932 Error;
    User Not Subscribed;
    Rejected By Network;
    ;
    Not Available;
    ;
    Insufficient Info;
    Invalid Served User Number;
    Invalid Call State;
    Basic Service Not Provided;
    Not Incoming Call;
    SS Interaction Not Allowed;
    Invalid Diverted Nr;
    Operator Access;
    Special Service Nr;
    Diversion To Served User Nr;
    Invalid or Unregistered CUG Index;*16
    Requested Basic Service Violates CUG Contraints;*17
    Outgoing Calls barred within CUG;*18
    Incoming Calls barred within CUG;*19
    User not Member of CUG;*20
    Inconsistency in Designated Facility and Subscriber Class;*21
    ;*22
    IncomingCallAcceptedByOtherTerminal;*23
    NumberOfDiversionCounterExceeded;*24
    Call Failure;*25
    NoChargingInfoAvailable;*26
    CUG Violation;*27
    Illegal Conference ID;*28
    Illegal Party ID;*29
    Number of parties have exceeded;*30
    Not active;*31
    Not allowed;*32
    MaximumNumberOfReservationsReached;*33
    NoExplicitReservationExistsOrlnvalidReservationIndicator;*34
    UnwantedReservationCreated;*35
    ImplicitReservationUsed;*36
    ;*37
    ;*38
    ;*39
    ;*40
    ;*41
    ;*42
    Procedural Error;*43
    Unauthorized Precedence Level;*44
    UserIgnored;*45
    NotActivated;*46
    UUsReqAsEssential;*47
    ;*48
    REVIsAlreadyRunning;*49

str# Q932 PublicTypeOfNumber;
    Unknown;
    InternationalNumber;
    NationalNumber;
    NetworkSpecificNumber;
    SubscriberNumber;
    ;
    AbbreviatedNumber;

str# Q932 PrivateTypeOfNumber;
    Unknown;
    Level2RegionalNumber;
    Level1RegionalNumber;
    PTNSpecificNumber;
    LocalNumber;
    Level3RegionalNumber;
    AbbreviatedNumber;

str# Q932 ScreeningIndicator_list;
    UserProvidedNotScreened;
    UserProvidedVerifiedAndPassed;
    UserProvidedVerifiedAndFailed;
    NetworkProvided;


*--------------------------------------------------------------------
* Q952
*--------------------------------------------------------------------
void Q952 Invoke ActivationDiversionType;
    LABL    0   0   0   c7  Activation Diversion Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 Procedure;
    Q952 BasicService;
    
    LABL    0   0   0   c7  Forwarded To Address;
    Q932 Address;
    LABL    0   0   0   c8  ;

    Q952 ServedUserNr;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke DeactivationDiversionType;
    LABL    0   0   0   c7  Deactivation Diversion Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 Procedure;
    Q952 BasicService;
    Q952 ServedUserNr;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke ActivationStatusNotificationDivType;
    LABL    0   0   0   c7  Activation Status Notification Div Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 Procedure;
    Q952 BasicService;
    
    LABL    0   0   0   c7  Forwarded To Address;
    Q932 Address;
    LABL    0   0   0   c8  ;

    Q952 ServedUserNr;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke DeactivationStatusNotificationDivType;
    LABL    0   0   0   c7  Deactivation Status Notification Div Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 Procedure;
    Q952 BasicService;
    Q952 ServedUserNr;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke InvokeStatusType;
    LABL    0   0   0   c7  Invoke Status Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 DiversionReason;
    Q952 BasicService;
    
    LABL    0   0   0   c7  Invoke Failure;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Invoke Failure:;
    CST# ffffffff 1 0   14  Q952 InvokeFailure;
    LABL    0   0   0   c8  ;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke InterrogationDiversionType;
    LABL    0   0   0   c7  Interrogation Diversion Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 Procedure;
    GBYT    0   1;
    SNEQ    a   1;	*ENUMERATED
    SKIP    1;
    Q952 BasicService;

    Q952 ServedUserNr;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Result InterrogationDiversionType;*gu=21,22
    LABL    0   0   0   c7  Interrogation Diversion Type;
    BER Tag;
    DBYT    0   21  b0  c2  Length:;
    BREM    0   22;

    LSTS    0   21  0   c7  Int Result List-;
    Q952 IntResult;
    BREM    0   1   0   0   ;
    SUBG    1   a2  0   0   ;*bytesused in g[22]
    SUBG    22  a1  0   0   ;*bytesleft
    LABL    0   0   0   c8  ;
    BREM    0   22;
    LSTZ    0   21  0   0   ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Result InterrogationDiversion1Type;*gu=21,22
    LABL    0   0   0   c7  Interrogation Diversion 1 Type;
    BER Tag;
    DBYT    0   21  b0  c2  Length:;
    BREM    0   22;
    
    LSTS    0   21  0   c7  Int Result List 1-;
    Q932 PartyNumber;
    BREM    0   1   0   0   ;
    SUBG    1   a2  0   0   ;*bytesused in g[22]
    SUBG    22  a1  0   0   ;*bytesleft
    LABL    0   0   0   c8  ;
    BREM    0   22;
    LSTZ    0   21  0   0   ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke DiversionInformationType;*gu=31,32
    LABL    0   0   0   c7  Diversion Information Type;
    BER Tag;
    DBYT    0   31  b0  c2  Length:;
    BREM    0   32;         
    
    Q952 DiversionReason;

    GBYT    0   1   0   0   ;
    SNEQ    a   1   0   0   ;*ENUMERATED
    SKIP    1;
    Q952 BasicService;

    GBYT    0   1   0   0   ;
    SEQU    30  1   0   0   ;*SEQUENCE
    SKIP    2;
    SNEQ    4   1   0   0   ;*OCTET STRING
    SKIP    1;
    Q932 PartySubaddress;

    GBYT    0   1   0   0   ;
    SNEQ    A0  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Calling Address;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedAddressScreened;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A1  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Original Called Nr;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A2  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Last Forwarding Nr;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    83  1   0   0   ;
    SKIP    3;
    LABL    0   0   0   c7  Last Forwarding Reason;
    Q952 DiversionReason;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    45  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Q931 Information Element;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  Q932 IE Data:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke CallDeflectionType;
    LABL    0   0   0   c7  Call Deflection Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    LABL    0   0   0   c7  Deflection Address;
    Q932 Address;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    1   1   0   0   ;*BOOLEAN
    SKIP    5;
    LABL    0   0   0   c7  Presentation Allowed Diverted To User;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   0   b0  c2  Presentation Allowed Ind:;
    LABL    0   0   0   c8  ;

    * RoutingInformation not defined anywhere

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke CallReroutingType;
    LABL    0   0   0   c7  Call Rerouting Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    LABL    0   0   0   c7  Rerouting Reason;
    Q952 DiversionReason;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Called Address;
    Q932 Address;
    LABL    0   0   0   c8  ;

    Q952 DiversionCounter;

    GBYT    0   1   0   0   ;
    SNEQ    45  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Q931 Information Element;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    HEX#    0   1   b0  c2  Q932 IE Data:;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A1  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Last Rerouting Nr;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;
    
    GBYT    0   1   0   0   ;
    SNEQ    82  1   0   0   ;
    SKIP    6;
    LABL    0   0   0   c7  Subscription Option;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Subscription Option:;
    CST# ffffffff 1 0   14  Q952 SubscriptionOptionStr;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A3  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Calling Party Subaddress;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PartySubaddress;
    LABL    0   0   0   c8  ;
    
    GBYT    0   1   0   0   ;
    SNEQ    84  1   0   0   ;*BOOLEAN
    SKIP    5;
    LABL    0   0   0   c7  Presentation Allowed Diverted To User;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   0   b0  c2  Presentation Allowed Ind:;
    LABL    0   0   0   c8  ;

    * RoutingInformation not defined anywhere

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke DivertingLegInformation1Type;
    LABL    0   0   0   c7  Diverting Leg Information 1 Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 DiversionReason;

    LABL    0   0   0   c7  Subscription Option;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Subscription Option:;
    CST# ffffffff 1 0   14  Q952 SubscriptionOptionStr;
    LABL    0   0   0   c8  ;

    *OPTIONAL

    GBYT    0   1   0   0   ;
    SEQU    A0  1   0   0   ;
    SKIP    7;
    SEQU    81  1   0   0   ;
    SKIP    5;
    SEQU    82  1   0   0   ;
    SKIP    3;
    SEQU    A3  1   0   0   ;
    SKIP    1;
    TRTS;

    LABL    0   0   0   c7  Nominated Nr;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Invoke DivertingLegInformation2Type;
    LABL    0   0   0   c7  Diverting Leg Information 2 Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;

    Q952 DiversionCounter;
    Q952 DiversionReason;

    GBYT    0   1   0   0   ;
    SNEQ    A1  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Diverting Nr;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;
    
    GBYT    0   1   0   0   ;
    SNEQ    A2  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Original Called Nr;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PresentedNumberUnscreened;
    LABL    0   0   0   c8  ;
    
    LABL    0   0   0   c8  ;
    TRTS;


void Q952 Invoke DivertingLegInformation3Type;
    LABL    0   0   0   c7  Diverting Leg Information 3 Type;
    BER Tag;
    DBYT    0   0   b0  c2  Length:;
    DBYT    0   0   b0  c2  Presentation Allowed Ind:;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 Procedure;
    LABL    0   0   0   c7  Procedure;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Procedure:;
    CST# ffffffff 1 0   14  Q952 Procedure_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 SubscriptionOption;
    DBYT    0   1   b0  c2  S:;
    CST# ffffffff 1 0   14  Q952 Procedure_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 DiversionCounter;
    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;*INTEGER
    SKIP    1;   
    TRTS;

    LABL    0   0   0   c7  Diversion Counter;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Diversion Counter:;
    LABL    0   0   0   c8  ;

    TRTS;

void Q952 DiversionReason;
    LABL    0   0   0   c7  Diversion Reason;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Diversion Reason:;
    CST# ffffffff 1 0   14  Q952 DiversionReason_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 BasicService;
    LABL    0   0   0   c7  BasicService;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  BasicService:;
    CEQU    0   1   0   14  AllServices;
    CEQU    2   1   0   14  UnrestrictedDigitalInformation;
    CEQU    3   1   0   14  Audio3100Hz;
    CEQU    20  1   0   14  Telephony;
    CEQU    21  1   0   14  Teletex;
    CEQU    22  1   0   14  TelefaxGroup4Class1;
    CEQU    23  1   0   14  VideotexSyntaxBased;
    CEQU    24  1   0   14  Videotelephony;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 ServedUserNr;
    LABL    0   0   0   c7  ServedUserNr;

    GBYT    0   11  0   0   ;
    SNEQ    5   11  0   0   ;*NULL
    SKIP    5;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  AllNumbers;
    LABL    0   0   0   c8  ;
    TRTS;

    Q932 PartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

void Q952 IntResult;
    LABL    0   0   0   c7  Int Result;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   0   c8  ;

    Q952 ServedUserNr;

    Q952 BasicService;
    
    Q952 Procedure;

    LABL    0   0   0   c7  Forwarded To Address;
    Q932 Address;
    LABL    0   0   0   c8  ;
    TRTS;

str# Q952 InvokeFailure;
    UUsReqAsEssential;
    InvalidForwardingInvocation;
    MaxNrOfForwardingsExceeded;

str# Q952 SubscriptionOptionStr;
    NoNotification;
    NotificationWithoutDivertedToNr;
    NotificationWithDivertedToNr;

str# Q952 Procedure_list;
    Cfu;
    Cfb;
    Cfnr;

str# Q952 DiversionReason_list;
    Unknown;
    Cfu;
    Cfb;
    Cfnr;
    Cd;
    CdImmediate;


*--------------------------------------------------------------------
* Q956 dcods
*--------------------------------------------------------------------
void Q956 Invoke ChargingRequest;
    LABL    0   0   0   c7  Charging Request;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Charging Case:;
    CST# ffffffff 1 0   14  Q956 ChargingCase;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Result ChargingRequest;
    LABL    0   0   0   c7  Charging Request;    
    BER Tag;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    4;
    DBYT    0   21  b0  c2  Length:;
    LABL    0   0   b0  c2  Charging Info Follows;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    2   11  0   0   ;*INTEGER
    SKIP    4;
    BER Integer;
    DGLB    0   1   b0  c2  AOCS Special Arr Info:;
    LABL    0   0   0   c8  ;
    TRTS;

    Q956 AOCSCurrencyInfoList;

    LABL    0   0   0   c8  ;
    TRTS;
    

void Q956 Invoke AOCSCurrency;
    LABL    0   0   0   c7  AOCS Currency;    
    BER Tag;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    4;
    DBYT    0   21  b0  c2  Length:;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    Q956 AOCSCurrencyInfoList;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Invoke AOCSSpecialArr;
    LABL    0   0   0   c7  AOCS Special Arr;    
    BER Tag;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    4;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    2   11  0   0   ;*INTEGER
    SKIP    2;
    BER Integer;
    DGLB    0   1   b0  c2  AOCS Special Arr Info:;

    LABL    0   0   0   c8  ;
    TRTS;


void Q956 Invoke AOCDCurrency;
    LABL    0   0   0   c7  AOCD Currency;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   b0  c2  AOCD Currency Info;
    SNEQ    81  11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Free Of Charge;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c7  Specific Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    Q956 RecordedCurrency;
    Q956 TypeOfChargingInfo;

    GBYT    0   1   0   0   ;
    SNEQ    83  1   0   0   ;
    SKIP    1;
    Q956 AOCDBillingId;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Invoke AOCDChargingUnit;
    LABL    0   0   0   c7  AOCD Charging Unit;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    SNEQ    81  11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Free Of Charge;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c7  Specific Charging Units;

    Q956 RecordedUnitsList;
    Q956 TypeOfChargingInfo;

    GBYT    0   1   0   0   ;
    SNEQ    83  1   0   0   ;
    SKIP    1;
    Q956 AOCDBillingId;

    LABL    0   0   0   c8  ;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Invoke AOCECurrency;
    LABL    0   0   0   c7  AOCE Currency;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    Q956 AOCECurrencyInfo;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Invoke AOCEChargingUnit;
    LABL    0   0   0   c7  AOCE Charging Unit;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    SNEQ    5   11  0   0   ;*NULL
    SKIP    3;
    LABL    0   0   b0  c2  Charge Not Available;
    LABL    0   0   0   c8  ;
    TRTS;

    Q956 AOCEChargingUnitInfo;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Invoke IdentificationOfCharge;
    Q956 ChargingAssociation;
    TRTS;

void Q956 AOCSCurrencyInfoList;*gi=21 (len), gu=22
    DBYT    0   21  b0  c2  Length:;
    BREM    0   22;

    LSTS    0   21  0   c7  AOCS Currency Info List;
    Q956 AOCSCurrencyInfo;
    BREM    0   1   0   0   ;
    SUBG    1   a2  0   0   ;*bytesused in g[22]
    SUBG    22  a1  0   0   ;*bytesleft
    LABL    0   0   0   c8  ;
    BREM    0   22;
    LSTZ    0   21  0   0   ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 AOCSCurrencyInfo;
    LABL    0   0   0   c7  AOCS Currency Info;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    LABL    0   0   0   c7  Charged Item;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Charged Item:;
    CST# ffffffff 1 0   14  Q956 ChargedItem;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A1  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Duration Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q956 DurationCurrency;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A2  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Flat Rate Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q956 Currency And Amount;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    A3  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Volume Rate Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q956 VolumeRateCurrency;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    2   1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Special Charging Code;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Special Charging Code:;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    84  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Free Of Charge;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  Free Of Charge;
    LABL    0   0   0   c8  ;

    GBYT    0   1   0   0   ;
    SNEQ    85  1   0   0   ;
    SKIP    5;
    LABL    0   0   0   c7  Currency Info Not Available;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  Currency Info Not Available;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 DurationCurrency;
    Q956 Currency And Amount;

    LABL    0   0   0   c7  ChargingType;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Charging Type:;
    CST# ffffffff 1 0   14  Q956 ChargingType;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  DTime;    
    Q956 Time;
    LABL    0   0   0   c8  ;

    *OPTIONAL

    GBYT    0   1   0   0   ;
    SEQU    a5  1   0   0   ;
    SKIP    1;
    TRTS;

    LABL    0   0   0   c7  DGranularity;    
    Q956 Time;
    LABL    0   0   0   c8  ;

    TRTS;

void Q956 VolumeRateCurrency;
    Q956 Currency And Amount;

    LABL    0   0   0   c7  Volume Unit;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Volume Unit:;
    CST# ffffffff 1 0   14  Q956 VolumeUnit;
    LABL    0   0   0   c8  ;

    TRTS;

void Q956 RecordedCurrency;
    LABL    0   0   0   c7  Recorded Currency;
    Q956 Currency And Amount;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 RecordedUnitsList;*gu=21,21
    BER Tag;
    DBYT    0   21  b0  c2  Length:;
    BREM    0   22;

    LSTS    0   21  0   c7  Recorded Units List-;
    Q956 RecordedUnits;
    BREM    0   1   0   0   ;
    SUBG    1   a2  0   0   ;*bytesused in g[22]
    SUBG    22  a1  0   0   ;*bytesleft
    LABL    0   0   0   c8  ;
    BREM    0   22;
    LSTZ    0   21  0   0   ;
    
    TRTS;

void Q956 RecordedUnits;
    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;
    SKIP    4;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    LABL    0   0   b0  c2  Not Available;
    SKIP    80000005;
    LABL    0   0   0   c7  Recorded Number Of Units;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Recorded Number Of Units:;
    LABL    0   0   0   c8  ;

    *OPTIONAL

    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;
    SKIP    1;
    TRTS;

    LABL    0   0   0   c7  Recorded Type Of Units;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Recorded Type Of Units:;
    LABL    0   0   0   c8  ;

    TRTS;
    
void Q956 AOCECurrencyInfo;
    LABL    0   0   0   c7  AOCE Currency Info;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    
    SNEQ    81  11  0   0   ;*NULL
    SKIP    2;
    LABL    0   0   b0  c2  Free Of Charge;
    SKIP    80000001;
    Q956 AOCECurrencyInfo_specificCurrency;

    Q956 ChargingAssociation;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 AOCECurrencyInfo_specificCurrency;
    LABL    0   0   0   c7  Specific Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    Q956 RecordedCurrency;

    GBYT    0   1   0   0   ;
    SNEQ    82  1   0   0   ;
    SKIP    1;
    Q956 AOCEBillingId;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 AOCEChargingUnitInfo;
    LABL    0   0   0   c7  AOCE Charging Unit Info;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    
    SNEQ    81  11  0   0   ;*NULL
    SKIP    2;
    LABL    0   0   b0  c2  Free Of Charge;
    SKIP    80000001;
    Q956 AOCEChargingUnitInfo_specificChargingUnits;

    Q956 ChargingAssociation;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 AOCEChargingUnitInfo_specificChargingUnits;
    LABL    0   0   0   c7  Specific Charging Units;

    Q956 RecordedUnitsList;

    GBYT    0   1   0   0   ;
    SNEQ    82  1   0   0   ;
    SKIP    1;
    Q956 AOCEBillingId;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 AOCDBillingId;
    LABL    0   0   0   c7  AOCD Billing Id;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  AOCD Billing Id:;
    CST# ffffffff 1 0   14  Q956 AOCDBillingId_list;
    LABL    0   0   0   c8  ;
    TRTS;


void Q956 AOCEBillingId;
    LABL    0   0   0   c7  AOCE Billing Id;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  AOCE Billing Id:;
    CST# ffffffff 1 0   14  Q956 AOCEBillingId_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 TypeOfChargingInfo;
    LABL    0   0   0   c7  Type Of Charging Info;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Type Of Charging Info:;
    CST# ffffffff 1 0   14  Q956 TypeOfChargingInfo_list;
    LABL    0   0   0   c8  ;
    TRTS;

void Q956 ChargingAssociation;
    GBYT    0   1   0   0   ;
    SEQU    2   1   0   0   ;
    SKIP    9;
    SEQU    A0  1   0   0   ;
    SKIP    1;
    TRTS;
    LABL    0   0   0   c7  Charging Association;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    Q932 PartyNumber;
    LABL    0   0   0   c8  ;
    TRTS;

    LABL    0   0   0   c7  Charging Association;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Charge Identifier:;
    LABL    0   0   0   c8  ;

    TRTS;

void Q956 Amount;
    LABL    0   0   0   c7  Amount;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    LABL    0   0   0   c7  Currency Amount;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Currency Amount:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Multiplier;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Multiplier:;
    CST# ffffffff 1 0   14  Q956 Multiplier;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Time;
    LABL    0   0   0   c7  Time;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    LABL    0   0   0   c7  Length Of Time Unit;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Length Of Time Unit:;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Scale;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Scale:;
    CST# ffffffff 1 0   14  Q956 Scale;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;

void Q956 Currency And Amount;
    LABL    0   0   0   c7  Currency;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    CHR#    0   1   b0  c2  Currency:;
    LABL    0   0   0   c8  ;

    Q956 Amount;
    TRTS;

void Q956 Invoke RequestREV;
    LABL    0   0   0   c7  Case;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Case:;
    CST#    0   1   0   14  Q956 Case;
    LABL    0   0   0   c8  ;

    TRTS;

void Q956 Invoke REV-T-Status;
    LABL    0   0   0   c7  Status;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Status:;
    CST#    0   1   0   14  Q956 Status;
    LABL    0   0   0   c8  ;

    TRTS;


str# Q956 ChargingCase;
    ChargingInformationAtCallSetup;
    ChargingDuringACall;
    ChargingAtTheEndOfACall;

str# Q956 ChargedItem;
    BasicCommunication;
    CallAttempt;
    CallSetup;
    UserToUserInfo;
    OperationOfSupplementaryServ;

str# Q956 TypeOfChargingInfo_list;
    SubTotal;
    Total;

str# Q956 AOCDBillingId_list;
    NormalCharging;
    ReverseCharging;
    CreditCardCharging;

str# Q956 AOCEBillingId_list;
    NormalCharging;
    ReverseCharging;
    CreditCardCharging;
    CallForwardingUnconditional;
    CallForwardingBusy;
    CallForwardingNoReply;
    CallDeflection;
    CallTransfer;

str# Q956 Multiplier;
    OneThousandth;
    OneHundredth;
    OneTenth;
    One;
    Ten;
    Hundred;
    Thousand;

str# Q956 Scale;
    OneHundrethSecond;
    OneTenthSecond;
    OneSecond;
    TenSeconds;
    OneMinute;
    OneHour;
    TwentyFourHours;

str# Q956 VolumeUnit;
    Octet;
    Segment;
    Message;

str# Q956 ChargingType;
    ContinuousCharging;
    StepFunction;

str# Q956 Case;
    CaseA;
    CaseB;
    CaseC;

str# Q956 Status;
    WholeCall;
    ForTheRestOfTheCall;

*--------------------------------------------------------------------
* Q957 dcods
*--------------------------------------------------------------------
void Q957 Invoke UserUserService;
    LABL    0   0   0   c7  User User Service;    
    BER Tag;
    DBYT    0   1   b0  c2  Length:;

    LABL    0   0   0   c7  Service;
    BER Tag;
    BER Integer;
    DGLB    0   1   b0  c2  Service:;
    CST#    0   1   0   14  Q957 Service;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c7  Preferred;
    BER Tag;
    DBYT    0   1   b0  c2  Length:;
    DBYT    0   1   b0  c2  Value:;
    CEQU    1   1   0   14  Preferred;
    CEQU    0   1   0   14  Required;
    LABL    0   0   0   c8  ;

    LABL    0   0   0   c8  ;
    TRTS;


str# Q957 Service;
    Service1;
    Service2;
    Service3;


*--------------------------------------------------------------------
* BER utility decodes
*--------------------------------------------------------------------
void BER Tag;*go=11 (tag)
    HBYT    0   11  b0  c2  Tag:;
    TRTS;

void BER Integer;
    DBYT    0   1   b0  c2  Length:;
    
    SNEQ    1   1   0   0   ;
    SKIP    3;
    GBYT    0   1   0   0   ;*1 byte 
    INCR    1;
    TRTS;

    SNEQ    2   1   0   0   ;
    SKIP    3;
    GWRD    0   1   0   0   ;*2 bytes
    INCR    2;
    TRTS;

    SNEQ    3   1   0   0   ;
    SKIP    3;
    GBIT    18  1   0   0   ;*3 bytes
    INCR    3;
    TRTS;

    SNEQ    4   1   0   0   ;
    SKIP    3;
    GLNG    0   1   0   0   ;*4 bytes 
    INCR    4;
    TRTS;

    TRTS;


*--------------------------------------------------------------------
* Non-ASN IEs
*--------------------------------------------------------------------
void Q931 Extended Facility;*Q.932 Ch 8
    GBIT    1   6   0   0 ;*check if MSB == 0/1
    SEQU    1   6;
    SKIP    2;
	DBYT    0   6   b0  c2 Content Length:;
    TNXT    -Q931 Facility;* rest is same as Facility

    GBYT    0   1   0   0;
    ANDG    7f  1   0   0;
    INCR    1;

    SNEQ    1   1   0   0   ;
    SKIP    2;
    DBYT    0   6   b0  c2  Content Length:;
    TNXT    -Q931 Facility;

    SNEQ    2   1   0   0   ;
    SKIP    2;
    DWRD    0   6   b0  c2  Content Length:;
    TNXT    -Q931 Facility;

    SNEQ    3   1   0   0   ;
    SKIP    2;
    DBIT    12  6   b0  c2  Content Length:;
    TNXT    -Q931 Facility;

    SNEQ    4   1   0   0   ;
    SKIP    2;
    DLNG    0   6   b0  c2  Content Length:;
    TNXT    -Q931 Facility;
	TNXT    -Q931 Info Elem;


void Q931 Information Request;*Q.932 Ch 8
    BBIT    8   1   b0  c2  Octet Value:;
    CBIT    7   1   0   d4  1... .... Extension Bit: On;
    CLSE    7   1   0   d4  0... .... Extension Bit: Off;
    CBIT    6   1   0   d4  .1.. .... Information Request Indicator: Prompt For Additional Info;
    CLSE    0   0   0   d4  .0.. .... Information Request Indicator: Completed;
    ANDG    3f  1;
    CEQU    0   1   0   d4  ..00 0000 Type Of Information: Undefined;
    CEQU    1   1   0   d4  ..00 0001 Type Of Information: Authorization Code;
    CEQU    2   1   0   d4  ..00 0010 Type Of Information: Address Digits;
    CEQU    3   1   0   d4  ..00 0011 Type Of Information: Terminal Identification;
    CLTE    4   1   0   d4  ..xx xxxx Type Of Information: Reserved;
	TNXT    -Q931 Info Elem;

void Q931 Feature Identifier Number;
    BBIT    1   1   5  5; //Extension Bit
    SEQU    0   1   0   0   ;*single/double octet
    SKIP    3;
    SUBG    1   6;
    DBIT    7   0   b0  c2  Feature Identifier Number:;
    TRTS;
    GBIT    7   1   0   0   ;
    INCR    1;
    MULG    80  1   0   0   ;*<<7
    GBYT    0   2   0   0   ;
    ANDG    7f  2   0   0   ;
    ORRG    2   81  0   0   ;
    DGLB    0   1   b0  c2  Feature Identifier Number:;
    INCR    1;
    SUBG    2   6;
    TRTS;

void Q931 Feature Activation;*Q.932 Ch 8
    Q931 Feature Identifier Number;
	TNXT    -Q931 Info Elem;

void Q931 Feature Indication;*Q.932 Ch 8
    Q931 Feature Identifier Number;
	TEQU    0   6   0   0   Q931 Info Elem;

    BBIT    8   1   b0  c2  Octet Value:;
    LABL    0   0   0   d4  xxxx .... Spare;
    ANDG    f   1;
    CEQU    0   1   0   d4  .... 0000 Status Indicator: Deactivated;
    CEQU    1   1   0   d4  .... 0001 Status Indicator: Activated;
    CEQU    2   1   0   d4  .... 0010 Status Indicator: Prompt;
    CEQU    3   1   0   d4  .... 0011 Status Indicator: Pending;
    CLTE    4   1   0   d4  .... xxxx Status Indicator: Reserved;
	TNXT    -Q931 Info Elem;


void Q931 Service Profile Identification;*Q.932 Ch 8
    CHR#    0   6   b0  c2  SPID;
	TNXT    -Q931 Info Elem;


void Q931 Endpoint Identifier;*Q.932 Ch 8
	BBIT    1   0   5  5; //Extension Bit
	DBIT    7   0   b0  c2  User Service Identifier:;
	SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;
	BBIT    1   0   5  5; //Extension Bit
	DBIT    2   0   b0  c2  Interpreter:;
	DBIT    5   0   b0  c2  Terminal Identifier:;
	SUBG    1   6;
	TNXT -Q931 Info Elem;


void Q931 Redirecting Number;*Q.952 Ch 4
    Q931 TON_NPID;

    SEQU    1   1   0   0   ;* extbit set
    SKIP    5;
    BBIT    1   1   5  5; //Extension Bit
	DBIT    2   2   b0  c2  Presentation Indicator:;
    BBIT    5   0   b0  c2  Spare:;
	SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;

    BBIT    8   1   b0  c2  Octet Value:;
    CBIT    7   1   0   d4  1... .... Extension Bit: On;
    CLSE    7   1   0   d4  0... .... Extension Bit: Off;
    LABL    0   0   0   d4  .xxx .... Spare;
    ANDG    f   1;
    CEQU    0   1   0   d4  .... 0000 Reason For Diversion: Unknown;
    CEQU    1   1   0   d4  .... 0001 Reason For Diversion: Call Forwarding Busy;
    CEQU    2   1   0   d4  .... 0010 Reason For Diversion: Call Forwarding No Reply;
    CEQU    3   1   0   d4  .... 0011 Reason For Diversion: Reserved;
    CEQU    4   1   0   d4  .... 0100 Reason For Diversion: Reserved;
    CEQU    5   1   0   d4  .... 0101 Reason For Diversion: Reserved;
    CEQU    6   1   0   d4  .... 0110 Reason For Diversion: Reserved;
    CEQU    7   1   0   d4  .... 0111 Reason For Diversion: Reserved;
    CEQU    8   1   0   d4  .... 1000 Reason For Diversion: Reserved;
    CEQU    9   1   0   d4  .... 1001 Reason For Diversion: Reserved;
    CEQU    a   1   0   d4  .... 1010 Reason For Diversion: Called DTE (Circuit-Mode and Packet-Mode);
    CEQU    b   1   0   d4  .... 1011 Reason For Diversion: Reserved;
    CEQU    c   1   0   d4  .... 1100 Reason For Diversion: Reserved;
    CEQU    d   1   0   d4  .... 1101 Reason For Diversion: Reserved;
    CEQU    e   1   0   d4  .... 1110 Reason For Diversion: Reserved;
    CEQU    f   1   0   d4  .... 1111 Reason For Diversion: Call Forwarding Unconditional;
    
    SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;

	CHR#    0   6   b0  c2 Number Digits:;
	TNXT    -Q931 Info Elem;


void Q931 Redirection Number;*Q.952 Ch 4
    Q931 TON_NPID;

    SEQU    1   1   0   0   ;*extbit set
    SKIP    5;
    BBIT    1   1   5  5; //Extension Bit
	DBIT    2   2   b0  c2  Presentation Indicator:;
    BBIT    5   0   b0  c2  Spare:;
	SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;

	CHR#    0   6   b0  c2 Number Digits:;
	TNXT    -Q931 Info Elem;


void Q931 TON_NPID;*Type Of Number + Numbering Plan ID;go=g1(extbit)
    GBIT    1   1;
    BBIT    8   2   b0  c2  Octet Value:;
    CBIT    7   2   0   d4  1... .... Extension Bit: On;
    CLSE    7   2   0   d4  0... .... Extension Bit: Off;
    MOVE    2   83;
    DIVG    10  3;
    ANDG    7   3;
    CEQU    0   3   0   d4  .000 .... Type of Number: Unknown;
    CEQU    1   3   0   d4  .001 .... Type of Number: International;
    CEQU    2   3   0   d4  .010 .... Type of Number: National;
    CEQU    3   3   0   d4  .011 .... Type of Number: Network Specific;
    CEQU    4   3   0   d4  .100 .... Type of Number: Subscriber;
    CEQU    5   3   0   d4  .101 .... Type of Number: Reserved;
    CEQU    6   3   0   d4  .110 .... Type of Number: Abbreviated;
    CEQU    7   3   0   d4  .111 .... Type of Number: Reserved for Extension;
    MOVE    2   83;
    ANDG    f   3;
    CEQU    0   3   0   d4  .... 0000 Numbering Plan ID: Unknown;
    CEQU    1   3   0   d4  .... 0001 Numbering Plan ID: ISDN/Telephony (E.164);
    CEQU    2   3   0   d4  .... 0010 Numbering Plan ID: Reserved;
    CEQU    3   3   0   d4  .... 0011 Numbering Plan ID: Data (X.121);
    CEQU    4   3   0   d4  .... 0100 Numbering Plan ID: Telex (F.69);
    CEQU    5   3   0   d4  .... 0101 Numbering Plan ID: Reserved;
    CEQU    6   3   0   d4  .... 0110 Numbering Plan ID: Reserved;
    CEQU    7   3   0   d4  .... 0111 Numbering Plan ID: Reserved;
    CEQU    8   3   0   d4  .... 1000 Numbering Plan ID: National Standard;
    CEQU    9   3   0   d4  .... 1001 Numbering Plan ID: Private;
    CEQU    a   3   0   d4  .... 1010 Numbering Plan ID: Reserved;
    CEQU    b   3   0   d4  .... 1011 Numbering Plan ID: Reserved;
    CEQU    c   3   0   d4  .... 1100 Numbering Plan ID: Reserved;
    CEQU    d   3   0   d4  .... 1101 Numbering Plan ID: Reserved;
    CEQU    e   3   0   d4  .... 1110 Numbering Plan ID: Reserved;
    CEQU    f   3   0   d4  .... 1111 Numbering Plan ID: Reserved for Extension;

	SUBG    1   6;
	TEQU    0   6   0   0   Q931 Info Elem;
    TRTS;

str# Q931 Reason For Diversion;
    Unknown;
    Call Forwarding Busy;
    Call Forwarding No Reply;
    ;
    ;
    ;
    ;
    ;
    ;
    ;
    Called DTE (Circuit-Mode and Packet-Mode);
    ;
    ;
    ;
    ;
    Call Forwarding Unconditional;

str# Q931 Status Indicator;
    Deactivated;
    Activated;
    Prompt;
    Pending;

str# Q931 Type Of Information;
    Undefined;
    Authorization Code;
    Address Digits;
    Terminal Identification;


str# T35 Country Code;        * Added 2007 June
      0	|	Japan	;
      1	|	Albania	;
      2	|	Algeria	;
      3	|	American Samoa	;
      4	|	Germany (Federal Republic of)	;
      5	|	Anguilla;
      6	|	Antigua and Barbuda	;
      7	|	Argentina;
      8	|	Ascension (see S. Helena);
      9	|	Australia;
      10	|	Austria	;
      11	|	Bahamas	;
      12	|	Bahrain	;
      13	|	Bangladesh	;
      14	|	Barbados	;
      15	|	Belgium	;
      16	|	Belize	;
      17	|	Benin (Republic of)	;
      18	|	Bermudas;
      19	|	Bhutan (Kingdom of)	;
      20	|	Bolivia	;
      21	|	Botswana;
      22	|	Brazil;
      23	|	British Antarctic Territory	;
      24	|	British Indian Ocean Territory	;
      25	|	British Virgin Islands	;
      26	|	Brunei Darussalam	;
      27	|	Bulgaria;
      28	|	Myanmar (Union of)	;
      29	|	Burundi	;
      30	|	Byelorussia	;
      31	|	Cameroon	;
      32	|	Canada	;
      33	|	Cape Verde	;
      34	|	Cayman Islands	;
      35	|	Central African Republic	;
      36	|	Chad	;
      37	|	Chile	;
      38	|	China	;
      39	|	Colombia	;
      40	|	Comoros	;
      41	|	Congo	;
      42	|	Cook Islands	;
      43	|	Costa Rica	;
      44	|	Cuba	;
      45	|	Cyprus	;
      46	|	Czech and Slovak Federal Republic	;
      47	|	Cambodia	;
      48	|	Democratic People's Republic of Korea	;
      49	|	Denmark	;
      50	|	Djibouti	;
      51	|	Dominican Republic	;
      52	|	Dominica	;
      53	|	Ecuador	;
      54	|	Egypt	;
      55	|	El Salvador	;
      56	|	Equatorial Guinea	;
      57	|	Ethiopia	;
      58	|	Falkland Islands	;
      59	|	Fiji	;
      60	|	Finland	;
      61	|	France	;
      62	|	French Polynesia	;
      63	|	French Southern and Antarctic Lands	;
      64	|	Gabon	;
      65	|	Gambia	;
      66	|	Germany (Federal Republic of)	;
      67	|	Angola	;
      68	|	Ghana	;
      69	|	Gibraltar	;
      70	|	Greece	;
      71	|	Grenada	;
      72	|	Guam	;
      73	|	Guatemala	;
      74	|	Guernsey	;
      75	|	Guinea	;
      76	|	Guinea-Bissau	;
      77	|	Guayana	;
      78	|	Haiti	;
      79	|	Honduras	;
      80	|	Hongkong	;
      81	|	Hungary (Republic of)	;
      82	|	Iceland	;
      83	|	India	;
      84	|	Indonesia	;
      85	|	Iran (Islamic Republic of)	;
      86	|	Iraq	;
      87	|	Ireland	;
      88	|	Israel	;
      89	|	Italy	;
      90	|	C?te d'Ivoire	;
      91	|	Jamaica	;
      92	|	Afghanistan	;
      93	|	Jersey	;
      94	|	Jordan	;
      95	|	Kenya	;
      96	|	Kiribati	;
      97	|	Korea (Republic of)	;
      98	|	Kuwait	;
      99	|	Lao (People's Democratic Republic)	;
      100	|	Lebanon	;
      101	|	Lesotho	;
      102	|	Liberia	;
      103	|	Libya	;
      104	|	Liechtenstein	;
      105	|	Luxembourg	;
      106	|	Macau	;
      107	|	Madagascar	;
      108	|	Malaysia	;
      109	|	Malawi	;
      110	|	Maldives	;
      111	|	Mali	;
      112	|	Malta	;
      113	|	Mauritania	;
      114	|	Mauritius	;
      115	|	Mexico	;
      116	|	Monaco	;
      117	|	Mongolia	;
      118	|	Montserrat	;
      119	|	Morocco	;
      120	|	Mozambique	;
      121	|	Nauru	;
      122	|	Nepal	;
      123	|	Netherlands	;
      124	|	Netherlands Antilles	;
      125	|	New Caledonia	;
      126	|	New Zealand	;
      127	|	Nicaragua	;
      128	|	Niger	;
      129	|	Nigeria	;
      130	|	Norway	;
      131	|	Oman	;
      132	|	Pakistan	;
      133	|	Panama	;
      134	|	Papua New Guinea	;
      135	|	Paraguay	;
      136	|	Peru	;
      137	|	Philippines	;
      138	|	Poland (Republic of)	;
      139	|	Portugal	;
      140	|	Puerto Rico	;
      141	|	Qatar	;
      142	|	Romania	;
      143	|	Rwanda	;
      144	|	Saint Kitts and Nevis	;
      145	|	Saint Croix	;
      146	|	Saint Helena and Ascension	;
      147	|	Saint Lucia	;
      148	|	San Marino	;
      149	|	Saint Thomas	;
      150	|	Sao Tom and Principe	;
      151	|	Saint Vincent and the Grenadines	;
      152	|	Saudi Arabia	;
      153	|	Senegal	;
      154	|	Seychelles	;
      155	|	Sierra Leone	;
      156	|	Singapore	;
      157	|	Solomon Islands	;
      158	|	Somalia	;
      159	|	South Africa	;
      160	|	Spain	;
      161	|	Sri Lanka	;
      162	|	Sudan	;
      163	|	Suriname	;
      164	|	Swaziland	;
      165	|	Sweden	;
      166	|	Switzerland	;
      167	|	Syria	;
      168	|	Tanzania	;
      169	|	Thailand	;
      170	|	Togo	;
      171	|	Tonga	;
      172	|	Trinidad and Tobago	;
      173	|	Tunisia	;
      174	|	Turkey	;
      175	|	Turks and Caicos Islands	;
      176	|	Tuvalu	;
      177	|	Uganda	;
      178	|	Ukraine	;
      179	|	United Arab Emirates	;
      180	|	United Kingdom	;
      181	|	United States	;
      182	|	Burkina Faso	;
      183	|	Uruguay	;
      184	|	U.S.S.R.	;
      185	|	Vanuatu	;
      186	|	Vatican City State	;
      187	|	Venezuela	;
      188	|	Viet Nam	;
      189	|	Wallis and Futuna	;
      190	|	Western Samoa	;
      191	|	Yemen (Republic of)	;
      192	|	Yemen (Republic of)	;
      193	|	Yugoslavia	;
      194	|	Zaire	;
      195	|	Zambia	;
      196	|	Zimbabwe	;
